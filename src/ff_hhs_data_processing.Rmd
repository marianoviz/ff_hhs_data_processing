---
title: "Fish Forever HHS Data Processing (2019-2025)"
author: "Mariano Viz"
date: "2025-05-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,  # suppress all warnings
  message = FALSE   # optionally suppress package loading messages
)
library(tidyverse)
library(here)
library(janitor)
library(effsize)
library(jsonlite)
library(readxl)
library(data.world)
library(lmtest)
library(sandwich)
library(broom)
library(rstatix)
library(gridExtra)
library(stringr)

```



# Getting merged_hhs

```{r}
# Getting merged_hhs dataset: Basic Script + Correction for kobo_4 col names in Bahasa


# Load Required Libraries
library(httr)
library(readxl)
library(readr)
library(dplyr)
library(purrr)
library(here)

# Step 1: Define Helper Functions

## Function to download and read Excel files
download_and_read_excel <- function(url) {
  temp_file <- tempfile(fileext = ".xlsx")
  GET(url, write_disk(temp_file, overwrite = TRUE))
  data <- read_excel(temp_file)
  unlink(temp_file)
  return(data)
}

## Function to process datasets using metadata
process_dataset <- function(dataset, metadata) {
  column_map <- metadata %>%
    tidyr::separate_rows(`Original Column Name`, sep = "; ") %>%
    select(`Original Column Name`, `Standardized Column Name`) %>%
    distinct() %>%
    group_by(`Original Column Name`) %>%
    slice(1) %>%
    ungroup() %>%
    filter(`Original Column Name` %in% names(dataset))
  
  new_colnames <- names(dataset) %>%
    purrr::map_chr(~ {
      if (.x %in% column_map$`Original Column Name`) {
        column_map$`Standardized Column Name`[column_map$`Original Column Name` == .x]
      } else {
        NA_character_
      }
    })
  
  names(dataset) <- new_colnames
  dataset <- dataset %>%
    select(any_of(metadata$`Standardized Column Name`))
  return(dataset)
}

## Function to remove note columns (starting with "g99")
remove_g99_columns <- function(dataset) {
  dataset %>% select(-starts_with("g99"))
}

## Function to standardize column types across datasets
standardize_column_types <- function(datasets) {
  all_columns <- datasets %>%
    purrr::map(names) %>%
    purrr::reduce(union)
  
  datasets <- datasets %>%
    purrr::map(~ {
      dataset <- .x
      missing_columns <- setdiff(all_columns, names(dataset))
      dataset[missing_columns] <- NA
      dataset <- dataset %>%
        mutate(across(everything(), as.character))
      return(dataset)
    })
  return(datasets)
}

# Step 2: Define URLs for Data Sources
urls <- list(
  fastfield = "https://query.data.world/s/w67hchmwgk4xyshbmb4xkxitsamtag?dws=00000",
  kobo_1 = "https://query.data.world/s/2ltshiqf5ablwa6pw4uijvzgm6j37j?dws=00000",
  kobo_2 = "https://query.data.world/s/hczi25yxfpweveumkatcfobp4qbik5?dws=00000",
  kobo_3 = "https://query.data.world/s/hgss74tml5z4f3gdi4h2ztkw4wfcx2?dws=00000",
  kobo_4 = "https://query.data.world/s/v7amp6zyj7rxyoflfstnwpuvgse3mr?dws=00000",
  kobo_5 = "https://query.data.world/s/wejaidwccqs2wqtg7n5ksnxmfirwhn?dws=00000"
)

metadata_url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQc0btEwxARDVBC0Ny6ZCRlzoIjQ7txvbFoU-xlQOI97CP2tGNr4hPOskVGhr74dhCYQkBmxSm9zFkn/pub?output=csv"


#Addressing problem with kobo_4 having col names in bahasa
# Read both the downloaded and local versions of kobo_4
kobo_4_downloaded <- download_and_read_excel(urls$kobo_4)
kobo_4_local <- read_excel(here("data", "kobo", "hhs_kobo_mod_4.xlsx"))
# Replace downloaded data's column names with those from the local file
names(kobo_4_downloaded) <- names(kobo_4_local)



# Step 3: Download Data
datasets <- list(
  fastfield = read.csv(urls$fastfield, header = TRUE, stringsAsFactors = FALSE, check.names = FALSE),
  kobo_1 = download_and_read_excel(urls$kobo_1),
  kobo_2 = download_and_read_excel(urls$kobo_2),
  kobo_3 = download_and_read_excel(urls$kobo_3),
  kobo_4 = kobo_4_downloaded,
  kobo_5 = download_and_read_excel(urls$kobo_5)
)

metadata <- read_csv(metadata_url)

# Step 4: Process and Clean Datasets
processed_datasets <- purrr::map(datasets, process_dataset, metadata = metadata)
cleaned_datasets <- purrr::map(processed_datasets, remove_g99_columns)
standardized_datasets <- standardize_column_types(cleaned_datasets)

# Step 5: Merge All Datasets
merged_hhs <- purrr::reduce(standardized_datasets, full_join, by = NULL)

# Clear all objects except merged_hhs
rm(list = setdiff(ls(), "merged_hhs"))

# The merged_hhs dataset is now ready for use.
```


# Standardisation

```{r}
# Adding year

# Load required libraries
library(dplyr)
library(lubridate)

# Assuming the merged dataset is stored in a variable called merged_hhs
# Update the 'year' column using 'g0_year' and 'g0_submission_time'
merged_hhs <- merged_hhs %>%
  mutate(
    year = ifelse(is.na(g0_year), 
                  year(ymd_hms(g0_submission_time)), 
                  g0_year)
  )


#unique(merged_hhs$year)



# Merging location information (Province, Municipality, and Community)

# Load required libraries
library(dplyr)
library(readr)
library(here)

# Read metadata for location IDs
level_1 <- read_csv(here("data", "location_ids", "level1.csv")) # Province
level_2 <- read_csv(here("data", "location_ids", "level2.csv")) # Municipality
level_4 <- read_csv(here("data", "location_ids", "level4.csv")) # Community

# Replace coded entries with corresponding labels
# Province
merged_hhs$g1_province <- as.character(merged_hhs$g1_province)
merged_hhs$g1_province <- ifelse(
  merged_hhs$g1_province %in% level_1$name, 
  level_1$label[match(merged_hhs$g1_province, level_1$name)], 
  merged_hhs$g1_province
)

# Municipality
merged_hhs$g1_municipality <- as.character(merged_hhs$g1_municipality)
merged_hhs$g1_municipality <- ifelse(
  merged_hhs$g1_municipality %in% level_2$name, 
  level_2$label[match(merged_hhs$g1_municipality, level_2$name)], 
  merged_hhs$g1_municipality
)

# Community
merged_hhs$g1_community <- as.character(merged_hhs$g1_community)
merged_hhs$g1_community <- ifelse(
  merged_hhs$g1_community %in% level_4$name, 
  level_4$label[match(merged_hhs$g1_community, level_4$name)], 
  merged_hhs$g1_community
)

# Generate final columns for merged dataset
merged_hhs <- merged_hhs %>%
  mutate(
    merged_hhs_community = g1_community,
    merged_hhs_province = ifelse(is.na(g1_province), g1_subnational, g1_province),
    merged_hhs_municipality = ifelse(is.na(g1_municipality), g1_local, g1_municipality)
  )


# Count number of NA values
sum(is.na(merged_hhs$g1_country))

# Unique values
unique(merged_hhs$g1_country)

# Standardize
merged_hhs <- merged_hhs %>%
  mutate(g1_country_std = case_when(
    g1_country %in% c("FSM", "HND", "BRA", "IDN", "PLW", "GTM", "MOZ", "PHL") ~ g1_country,
    g1_country == "Indonesia" ~ "IDN",
    is.na(g1_country) ~ NA_character_,
    TRUE ~ NA_character_
  ))


# Unique values
unique(merged_hhs$g1_country_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g1_country_std)) %>%
  count(g1_country) %>%
  arrange(desc(n))


# Count number of NA values
sum(is.na(merged_hhs$g1_hh_status))

# Unique values
unique(merged_hhs$g1_hh_status)

# Standardize
merged_hhs <- merged_hhs %>%
  mutate(g1_hh_status_std = case_when(
    str_detect(tolower(g1_hh_status), "parent_other") ~ "Other parent",
    str_detect(tolower(g1_hh_status), "kepala rumah tangga|head") ~ "Household head",  # <- fixed line
    str_detect(tolower(g1_hh_status), "spouse|pasangan") ~ "Spouse of household head",
    str_detect(tolower(g1_hh_status), "father|mother|ayah|ibu\\b|\\bayah|\\bibu|parent") ~ "Father/ mother of household head",
    str_detect(tolower(g1_hh_status), "brother|sister|kakak|adik|sibling") ~ "Brother/ sister of household head",
    str_detect(tolower(g1_hh_status), "child|putra|putri") ~ "Son/ daughter of household head",
    str_detect(tolower(g1_hh_status), "grandchild") ~ "Grandson/ granddaughter of household head",
    str_detect(tolower(g1_hh_status), "other parent") ~ "Other parent",
    str_detect(tolower(g1_hh_status), "domestic") ~ "Domestic help",
    str_detect(tolower(g1_hh_status), "acquaintance") ~ "Family acquaintance",
    str_detect(tolower(g1_hh_status), "other") ~ "Other No",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g1_hh_status_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g1_hh_status_std)) %>%
  count(g1_hh_status) %>%
  arrange(desc(n))


# Count number of NA values 
sum(is.na(merged_hhs$g2_gender))

# Unique values
unique(merged_hhs$g2_gender)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g2_gender_std = case_when(
    str_detect(tolower(g2_gender), "^(a\\.\\s*)?laki-laki$") ~ "Male",
    str_detect(tolower(g2_gender), "^(b\\.\\s*)?perempuan$") ~ "Female",
    str_detect(tolower(g2_gender), "^m$") ~ "Male",
    str_detect(tolower(g2_gender), "^f$") ~ "Female",
    str_detect(tolower(g2_gender), "^nb$") ~ "Non-Binary",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g2_gender_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g2_gender_std)) %>%
  count(g2_gender) %>%
  arrange(desc(n))


# Count number of NA values 
sum(is.na(merged_hhs$g2_region_protection_important))

# Unique values
unique(merged_hhs$g2_region_protection_important)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g2_region_protection_important_std = case_when(
    str_detect(tolower(g2_region_protection_important), "^yes$") ~ "Yes",
    str_detect(tolower(g2_region_protection_important), "^no$") ~ "No",
    str_detect(tolower(g2_region_protection_important), "^neutral$") ~ "Neutral",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g2_region_protection_important_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g2_region_protection_important_std)) %>%
  count(g2_region_protection_important) %>%
  arrange(desc(n))


# Count number of NA values 
sum(is.na(merged_hhs$g2_religion))

# Unique values
unique(merged_hhs$g2_religion)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g2_religion_std = case_when(
    str_detect(tolower(g2_religion), "^catholic$") ~ "Catholic",
    str_detect(tolower(g2_religion), "^christian$|^evangelical$") ~ "Christian, but not Catholic",
    str_detect(tolower(g2_religion), "^muslim$") ~ "Muslim",
    str_detect(tolower(g2_religion), "^hindu$") ~ "Hindu",
    str_detect(tolower(g2_religion), "^buddhist$") ~ "Buddhist",
    str_detect(tolower(g2_religion), "^jewish$") ~ "Jewish",
    str_detect(tolower(g2_religion), "^traditional") ~ "Traditional beliefs",
    str_detect(tolower(g2_religion), "^atheist$") ~ "Atheist",
    str_detect(tolower(g2_religion), "^other$|candombl|spiritual") ~ "Other [specify]",
    TRUE ~ NA_character_
  ))

# NOTE: "Spiritual" and "Candomblé" -->	"Other [specify]" THESE WILL NOT HAVE ENTRIES IN THE COLUMN g2_religion_other!!
# NOTE: "Evangelical" --> "Christian, but not Catholic"

# Unique values
unique(merged_hhs$g2_religion_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g2_religion_std)) %>%
  count(g2_religion) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_catch_current_vs_past))

# Unique values
unique(merged_hhs$g5_catch_current_vs_past)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_catch_current_vs_past_std = case_when(
    str_detect(tolower(g5_catch_current_vs_past), "declined a lot|declined_alot|sangat menurun|a\\. sangat menurun") ~ "Declined a lot",
    str_detect(tolower(g5_catch_current_vs_past), "declined slightly|declined_slightly|sedikit menurun|b\\. sedikit menurun") ~ "Declined slightly",
    str_detect(tolower(g5_catch_current_vs_past), "stayed the same|stayed_the_same|tetap sama|c\\. tetap sama") ~ "Stayed the same",
    str_detect(tolower(g5_catch_current_vs_past), "improved slightly|improved_slightly|sedikit meningkat|d\\. sedikit meningkat") ~ "Improved slightly",
    str_detect(tolower(g5_catch_current_vs_past), "improved heavily|improved_heavily|sangat meningkat|e\\. sangat meningkat") ~ "Improved heavily",
    str_detect(tolower(g5_catch_current_vs_past), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_catch_current_vs_past_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_catch_current_vs_past_std)) %>%
  count(g5_catch_current_vs_past) %>%
  arrange(desc(n))


# Count number of NA values 
sum(is.na(merged_hhs$g5_catch_future_vs_current))

# Unique values
unique(merged_hhs$g5_catch_future_vs_current)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_catch_future_vs_current_std = case_when(
    str_detect(tolower(g5_catch_future_vs_current), "declines a lot|declines_alot|akan sangat menurun|a\\. akan sangat menurun") ~ "Declines a lot",
    str_detect(tolower(g5_catch_future_vs_current), "declines slightly|declines_slightly|akan sedikit menurun|b\\. akan sedikit menurun") ~ "Declines slightly",
    str_detect(tolower(g5_catch_future_vs_current), "stays the same|stays_the_same|tetap sama|c\\. tetap sama") ~ "Stays the same",
    str_detect(tolower(g5_catch_future_vs_current), "improves slightly|improves_slightly|akan sedikit meningkat|d\\. akan sedikit meningkat") ~ "Improves slightly",
    str_detect(tolower(g5_catch_future_vs_current), "improves heavily|improves_heavily|akan sangat meningkat|e\\. akan sangat meningkat") ~ "Improves heavily",
    str_detect(tolower(g5_catch_future_vs_current), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_catch_future_vs_current_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_catch_future_vs_current_std)) %>%
  count(g5_catch_future_vs_current) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_freq_fishing_high_profit))

# Unique values
unique(merged_hhs$g5_freq_fishing_high_profit)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_freq_fishing_high_profit_std = case_when(
    str_detect(tolower(g5_freq_fishing_high_profit), "once or never|once_or_never|sekali atau tidak sama sekali|a\\. sekali atau tidak sama sekali") ~ "Once or never",
    str_detect(tolower(g5_freq_fishing_high_profit), "^a few times$|few_times_season|beberapa kali per musim|b\\. beberapa kali per musim") ~ "A few times",
    str_detect(tolower(g5_freq_fishing_high_profit), "few times per month|few times_month|beberapa kali dalam sebulan|c\\. beberapa kali dalam sebulan") ~ "A few times per month",
    str_detect(tolower(g5_freq_fishing_high_profit), "1-2 per week|one_two_per_week|1-2 kali seminggu|d\\. 1-2 kali seminggu") ~ "1-2 per week",
    str_detect(tolower(g5_freq_fishing_high_profit), "more than 1-2 times per week|more_than_one_two_week|3-4 per week|5-6 per week|7 per week|3-4 times per week|6 times per week|7 times per week|lebih dari 1-2 kali seminggu|e\\. lebih dari 1-2 kali seminggu") ~ "More than 1-2 times per week",
    str_detect(tolower(g5_freq_fishing_high_profit), "not answered|not a fisher") | is.na(g5_freq_fishing_high_profit) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_freq_fishing_high_profit_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_freq_fishing_high_profit_std)) %>%
  count(g5_freq_fishing_high_profit) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_freq_fishing_low_profit))

# Unique values
unique(merged_hhs$g5_freq_fishing_low_profit)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_freq_fishing_low_profit_std = case_when(
    str_detect(tolower(g5_freq_fishing_low_profit), "once or never|once_or_never|sekali atau tidak sama sekali|a\\. sekali atau tidak sama sekali") ~ "Once or never",
    str_detect(tolower(g5_freq_fishing_low_profit), "^a few times$|^few times$|few_times_season|beberapa kali per musim|b\\. beberapa kali per musim") ~ "A few times",
    str_detect(tolower(g5_freq_fishing_low_profit), "few times per month|few times_month|beberapa kali dalam sebulan|c\\. beberapa kali dalam sebulan") ~ "A few times per month",
    str_detect(tolower(g5_freq_fishing_low_profit), "1-2 per week|one_two_per_week|1-2 kali seminggu|d\\. 1-2 kali seminggu") ~ "1-2 per week",
    str_detect(tolower(g5_freq_fishing_low_profit), "more than 1-2 times per week|more_than_one_two_week|lebih dari 1-2 kali seminggu|e\\. lebih dari 1-2 kali seminggu|3-4 per week|5-6 per week|7 per week") ~ "More than 1-2 times per week",
    str_detect(tolower(g5_freq_fishing_low_profit), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_freq_fishing_low_profit_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_freq_fishing_low_profit_std)) %>%
  count(g5_freq_fishing_low_profit) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_explosives))

# Unique values
unique(merged_hhs$g5_gear_explosives)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_explosives_std = case_when(
    str_detect(tolower(g5_gear_explosives), "^yes$|^yes_not_own$|ya, tapi bukan milik sendiri|a\\. ya, milik sendiri|b\\. ya, tapi bukan milik sendiri") ~ "Yes",
    str_detect(tolower(g5_gear_explosives), "^no$|^tidak$|c\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_explosives), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_explosives_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_explosives_std)) %>%
  count(g5_gear_explosives) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_no_fishing_12_months))

# Unique values
unique(merged_hhs$g5_gear_no_fishing_12_months)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_no_fishing_12_months_std = case_when(
    str_detect(tolower(g5_gear_no_fishing_12_months), "^yes$|yes_own|yes_not_own|ya, milik sendiri|ya, tapi bukan milik sendiri|a\\. ya, milik sendiri|b\\. ya, tapi bukan milik sendiri") ~ "Yes",
    str_detect(tolower(g5_gear_no_fishing_12_months), "^no$|tidak|c\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_no_fishing_12_months), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_no_fishing_12_months_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_no_fishing_12_months_std)) %>%
  count(g5_gear_no_fishing_12_months) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_hand))

# Unique values
unique(merged_hhs$g5_gear_hand)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_hand_std = case_when(
    str_detect(tolower(g5_gear_hand), "^yes$|yes_own|yes_not_own|ya, milik sendiri|ya, tapi bukan milik sendiri|a\\. ya, milik sendiri|b\\. ya, tapi bukan milik sendiri") ~ "Yes",
    str_detect(tolower(g5_gear_hand), "^no$|tidak|c\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_hand), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_hand_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_hand_std)) %>%
  count(g5_gear_hand) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_mobile_line))

# Unique values
unique(merged_hhs$g5_gear_mobile_line)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_mobile_line_std = case_when(
    str_detect(tolower(g5_gear_mobile_line), "^yes$|yes_own|yes_not_own|ya, milik sendiri|ya, tapi bukan milik sendiri|a\\. ya, milik sendiri|b\\. ya, tapi bukan milik sendiri") ~ "Yes",
    str_detect(tolower(g5_gear_mobile_line), "^no$|tidak|c\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_mobile_line), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_mobile_line_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_mobile_line_std)) %>%
  count(g5_gear_mobile_line) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_mobile_net))

# Unique values
unique(merged_hhs$g5_gear_mobile_net)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_mobile_net_std = case_when(
    str_detect(tolower(g5_gear_mobile_net), "^yes$|yes_own|yes_not_own|ya, milik sendiri|ya, tapi bukan milik sendiri|a\\. ya, milik sendiri|b\\. ya, tapi bukan milik sendiri") ~ "Yes",
    str_detect(tolower(g5_gear_mobile_net), "^no$|tidak|c\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_mobile_net), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_mobile_net_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_mobile_net_std)) %>%
  count(g5_gear_mobile_net) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_other))

# Unique values
unique(merged_hhs$g5_gear_other)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_other_std = case_when(
    str_detect(tolower(g5_gear_other), "^yes$|a\\. ya") ~ "Yes",
    str_detect(tolower(g5_gear_other), "^no$|tidak|b\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_other), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_other_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_other_std)) %>%
  count(g5_gear_other) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_stationary_line))

# Unique values
unique(merged_hhs$g5_gear_stationary_line)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_stationary_line_std = case_when(
    str_detect(tolower(g5_gear_stationary_line), "^yes$") ~ "Yes",
    str_detect(tolower(g5_gear_stationary_line), "^no$") ~ "No",
    str_detect(tolower(g5_gear_stationary_line), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_stationary_line_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_stationary_line_std)) %>%
  count(g5_gear_stationary_line) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_stationary_net))

# Unique values
unique(merged_hhs$g5_gear_stationary_net)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_stationary_net_std = case_when(
    str_detect(tolower(g5_gear_stationary_net), "^yes$|yes_own|yes_not_own|ya, milik sendiri|ya, tapi bukan milik sendiri|a\\. ya, milik sendiri|b\\. ya, tapi bukan milik sendiri") ~ "Yes",
    str_detect(tolower(g5_gear_stationary_net), "^no$|tidak|c\\. tidak") ~ "No",
    str_detect(tolower(g5_gear_stationary_net), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_gear_stationary_net_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_stationary_net_std)) %>%
  count(g5_gear_stationary_net) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_fisher_job_secure))

# Unique values
unique(merged_hhs$g5_fisher_job_secure)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_fisher_job_secure_std = case_when(
    str_detect(tolower(g5_fisher_job_secure), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g5_fisher_job_secure), "^no$|^tidak$|b\\. tidak") ~ "No",
    str_detect(tolower(g5_fisher_job_secure), "not answered|not a fisher") ~ NA_character_,
    is.na(g5_fisher_job_secure) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_fisher_job_secure_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_fisher_job_secure_std)) %>%
  count(g5_fisher_job_secure) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_hh_fisher_main))

# Unique values
unique(merged_hhs$g5_hh_fisher_main)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_hh_fisher_main_std = case_when(
    str_detect(tolower(g5_hh_fisher_main), "independently|a\\. secara mandiri|secara mandiri") ~
      "Independently or with other family or community members (i.e. not as a salaried laborer)",

    str_detect(tolower(g5_hh_fisher_main), "enterprise owner|enterprise_owner|b\\. sebagai pemilik|pemilik perusahaan") ~
      "As the owner of an enterprise, with hired laborers",

    str_detect(tolower(g5_hh_fisher_main), "salaried laborer|salaried_laborer|c\\. sebagai pekerja bergaji|pekerja bergaji") ~
      "As a salaried laborer working for an enterprise",

    str_detect(tolower(g5_hh_fisher_main), "cooperative member|cooperative_member|d\\. sebagai anggota|anggota kelompok|koperasi") ~
      "As a member of a (producer) group or cooperative, non-salaried",

    str_detect(tolower(g5_hh_fisher_main), "other|lainnya|e\\. lainnya") ~
      "Other [specify]",

    str_detect(tolower(g5_hh_fisher_main), "not answered|not a fisher|^na$|^f\\. na$|^na$") ~
      NA_character_,

    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g5_hh_fisher_main_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_hh_fisher_main_std)) %>%
  count(g5_hh_fisher_main) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_affordable_insurance))

# Unique values
unique(merged_hhs$g7_affordable_insurance)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_affordable_insurance_std = case_when(
    str_detect(tolower(g7_affordable_insurance), "yes|tersedia gratis|tersedia dengan harga terjangkau|yes_free|yes_affordable") ~ "Yes",
    str_detect(tolower(g7_affordable_insurance), "no|not_affordable|tidak, terlalu mahal|c\\. tidak, terlalu mahal") ~ "No",
    str_detect(tolower(g7_affordable_insurance), "idk|tidak tahu|d\\. tidak tahu") ~ "I don't know",
    str_detect(tolower(g7_affordable_insurance), "^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_affordable_insurance_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_affordable_insurance_std)) %>%
  count(g7_affordable_insurance) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_affordable_insurance_beneficial))

# Unique values
unique(merged_hhs$g7_affordable_insurance_beneficial)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_affordable_insurance_beneficial_std = case_when(
    str_detect(tolower(g7_affordable_insurance_beneficial), "^yes$|ya, bermanfaat|a\\. ya, bermanfaat") ~ "Yes",
    str_detect(tolower(g7_affordable_insurance_beneficial), "^no$|tidak bermanfaat|b\\. tidak bermanfaat") ~ "No",
    str_detect(tolower(g7_affordable_insurance_beneficial), "^idk$|tidak tahu|c\\. tidak tahu") ~ "I don't know",
    str_detect(tolower(g7_affordable_insurance_beneficial), "^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_affordable_insurance_beneficial_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_affordable_insurance_beneficial_std)) %>%
  count(g7_affordable_insurance_beneficial) %>%
  arrange(desc(n))


# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_buyers_traders))

# Unique values
unique(merged_hhs$g7_emergency_buyers_traders)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_buyers_traders_std = case_when(
    str_detect(tolower(g7_emergency_buyers_traders), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_buyers_traders), "^no$") ~ "No",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_buyers_traders_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_buyers_traders_std)) %>%
  count(g7_emergency_buyers_traders) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_commercial_group))

# Unique values
unique(merged_hhs$g7_emergency_commercial_group)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_commercial_group_std = case_when(
    str_detect(tolower(g7_emergency_commercial_group), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_commercial_group), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_commercial_group), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_commercial_group_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_commercial_group_std)) %>%
  count(g7_emergency_commercial_group) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_commercial_ind))

# Unique values
unique(merged_hhs$g7_emergency_commercial_ind)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_commercial_ind_std = case_when(
    str_detect(tolower(g7_emergency_commercial_ind), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_commercial_ind), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_commercial_ind), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_commercial_ind_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_commercial_ind_std)) %>%
  count(g7_emergency_commercial_ind) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_entrepreneur))

# Unique values
unique(merged_hhs$g7_emergency_entrepreneur)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_entrepreneur_std = case_when(
    str_detect(tolower(g7_emergency_entrepreneur), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_entrepreneur), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_entrepreneur), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_entrepreneur_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_entrepreneur_std)) %>%
  count(g7_emergency_entrepreneur) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_family))

# Unique values
unique(merged_hhs$g7_emergency_family)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_family_std = case_when(
    str_detect(tolower(g7_emergency_family), "^yes$|loan|grant|hibah|pinjaman|a\\. hibah|b\\. pinjaman") ~ "Yes",
    str_detect(tolower(g7_emergency_family), "^no$|no_1|no_2|tidak ada|c\\. tidak ada") ~ "No",
    str_detect(tolower(g7_emergency_family), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_family_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_family_std)) %>%
  count(g7_emergency_family) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_friend))

# Unique values
unique(merged_hhs$g7_emergency_friend)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_friend_std = case_when(
    str_detect(tolower(g7_emergency_friend), "^yes$|loan|grant|hibah|pinjaman|a\\. hibah|b\\. pinjaman") ~ "Yes",
    str_detect(tolower(g7_emergency_friend), "^no$|no_1|no_2|tidak ada|c\\. tidak ada") ~ "No",
    str_detect(tolower(g7_emergency_friend), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_friend_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_friend_std)) %>%
  count(g7_emergency_friend) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g1_ma_r_important))

# Unique values
unique(merged_hhs$g1_ma_r_important)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g1_ma_r_important_std = case_when(
    str_detect(tolower(g1_ma_r_important), "^yes$|^a\\. ya$|^ya$|^ya\\.$") ~ "Yes",
    str_detect(tolower(g1_ma_r_important), "^no$|^b\\. tidak$|^tidak$") ~ "No",
    str_detect(tolower(g1_ma_r_important), "tidak tahu|c\\. tidak tahu|don’t know") ~ "Don’t know",
    str_detect(tolower(g1_ma_r_important), "^na$|not answered|not a fisher|^$") | is.na(g1_ma_r_important) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g1_ma_r_important_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g1_ma_r_important_std)) %>%
  count(g1_ma_r_important) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_insurance))

# Unique values
unique(merged_hhs$g7_emergency_insurance)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_insurance_std = case_when(
    str_detect(tolower(g7_emergency_insurance), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_insurance), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_insurance), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_insurance_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_insurance_std)) %>%
  count(g7_emergency_insurance_std) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_lender))

# Unique values
unique(merged_hhs$g7_emergency_lender)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_lender_std = case_when(
    str_detect(tolower(g7_emergency_lender), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_lender), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_lender), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_lender_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_lender_std)) %>%
  count(g7_emergency_lender) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_microfinance_group))

# Unique values
unique(merged_hhs$g7_emergency_microfinance_group)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_microfinance_group_std = case_when(
    str_detect(tolower(g7_emergency_microfinance_group), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_microfinance_group), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_microfinance_group), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_microfinance_group_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_microfinance_group_std)) %>%
  count(g7_emergency_microfinance_group) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_microfinance_ind))

# Unique values
unique(merged_hhs$g7_emergency_microfinance_ind)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_microfinance_ind_std = case_when(
    str_detect(tolower(g7_emergency_microfinance_ind), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_microfinance_ind), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_microfinance_ind), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_microfinance_ind_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_microfinance_ind_std)) %>%
  count(g7_emergency_microfinance_ind) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_ngo_group))

# Unique values
unique(merged_hhs$g7_emergency_ngo_group)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_ngo_group_std = case_when(
    str_detect(tolower(g7_emergency_ngo_group), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_ngo_group), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_ngo_group), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_ngo_group_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_ngo_group_std)) %>%
  count(g7_emergency_ngo_group) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_ngo_ind))

# Unique values
unique(merged_hhs$g7_emergency_ngo_ind)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_ngo_ind_std = case_when(
    str_detect(tolower(g7_emergency_ngo_ind), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_ngo_ind), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_ngo_ind), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_ngo_ind_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_ngo_ind_std)) %>%
  count(g7_emergency_ngo_ind) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_other))

# Unique values
unique(merged_hhs$g7_emergency_other)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_other_std = case_when(
    str_detect(tolower(g7_emergency_other), "^yes$|loan|grant|savings|simpanan|asuransi|insurance|dana sosial|a\\. simpanan|b\\. asuransi") ~ "Yes",
    str_detect(tolower(g7_emergency_other), "^no$|social_fund no|insurance no|tidak ada|d\\. tidak ada|^no_\\d$") ~ "No",
    str_detect(tolower(g7_emergency_other), "not applicable") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_other_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_other_std)) %>%
  count(g7_emergency_other) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_personal))

# Unique values
unique(merged_hhs$g7_emergency_personal)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_personal_std = case_when(
    str_detect(tolower(g7_emergency_personal), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_personal), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_personal), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_personal_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_personal_std)) %>%
  count(g7_emergency_personal) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_emergency_savings_club))

# Unique values
unique(merged_hhs$g7_emergency_savings_club)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_emergency_savings_club_std = case_when(
    str_detect(tolower(g7_emergency_savings_club), "^yes$") ~ "Yes",
    str_detect(tolower(g7_emergency_savings_club), "^no$") ~ "No",
    str_detect(tolower(g7_emergency_savings_club), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_emergency_savings_club_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_emergency_savings_club_std)) %>%
  count(g7_emergency_savings_club) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_loan_bank))

# Unique values
unique(merged_hhs$g7_loan_bank)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_loan_bank_std = case_when(
    str_detect(tolower(g7_loan_bank), "^yes$") ~ "Yes",
    str_detect(tolower(g7_loan_bank), "^no$") ~ "No",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_loan_bank_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_loan_bank_std)) %>%
  count(g7_loan_bank) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_loan_buyer))

# Unique values
unique(merged_hhs$g7_loan_buyer)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_loan_buyer_std = case_when(
    str_detect(tolower(g7_loan_buyer), "^yes$") ~ "Yes",
    str_detect(tolower(g7_loan_buyer), "^no$") ~ "No",
    str_trim(g7_loan_buyer) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_loan_buyer_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_loan_buyer_std)) %>%
  count(g7_loan_buyer) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_loan_other_nonbank))

# Unique values
unique(merged_hhs$g7_loan_other_nonbank)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_loan_other_nonbank_std = case_when(
    str_detect(tolower(g7_loan_other_nonbank), "^yes$") ~ "Yes",
    str_detect(tolower(g7_loan_other_nonbank), "^no$") ~ "No",
    str_trim(g7_loan_other_nonbank) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_loan_other_nonbank_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_loan_other_nonbank_std)) %>%
  count(g7_loan_other_nonbank) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_save_monthly_income))

# Unique values
unique(merged_hhs$g7_save_monthly_income)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_save_monthly_income_std = case_when(
    str_detect(tolower(g7_save_monthly_income), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g7_save_monthly_income), "^no$|^tidak$|b\\. tidak") ~ "No",
    str_trim(g7_save_monthly_income) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_save_monthly_income_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_save_monthly_income_std)) %>%
  count(g7_save_monthly_income) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_savings_club_member))

# Unique values
unique(merged_hhs$g7_savings_club_member)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_savings_club_member_std = case_when(
    str_detect(tolower(g7_savings_club_member), "^yes$") ~ "Yes",
    str_detect(tolower(g7_savings_club_member), "^no$") ~ "No",
    TRUE ~ NA_character_
  ))
# Unique values
unique(merged_hhs$g7_savings_club_member_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_savings_club_member_std)) %>%
  count(g7_savings_club_member) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g7_small_business))

# Unique values
unique(merged_hhs$g7_small_business)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g7_small_business_std = case_when(
    str_detect(tolower(g7_small_business), "yes_registered|usahanya terdaftar|a\\. ya") ~ "Yes, the business is registered",
    str_detect(tolower(g7_small_business), "yes_not_registered|tidak terdaftar|b\\. ya") ~ "Yes, the business is not registered",
    str_detect(tolower(g7_small_business), "^no$|^tidak$|c\\. tidak") ~ "No",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g7_small_business_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g7_small_business_std)) %>%
  count(g7_small_business) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_fishery_benefit_equal))

# Unique values
unique(merged_hhs$g8_fishery_benefit_equal)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_fishery_benefit_equal_std = case_when(
    str_detect(tolower(g8_fishery_benefit_equal), "^yes$|a\\. ya|^ya$") ~ "Yes",
    str_detect(tolower(g8_fishery_benefit_equal), "^no$|b\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g8_fishery_benefit_equal), "no_dependence") ~ "I don’t depend on or benefit from the fishery",
    str_detect(tolower(g8_fishery_benefit_equal), "not answered|^na$|tidak tahu|c\\. tidak tahu") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_fishery_benefit_equal_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_fishery_benefit_equal_std)) %>%
  count(g8_fishery_benefit_equal_std) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_my_community_ability))

# Unique values
unique(merged_hhs$g8_my_community_ability)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_my_community_ability_std = case_when(
    str_detect(tolower(g8_my_community_ability), "^strongly disagree$|a\\. sangat tidak setuju|strongly_disagree") ~ "Strongly disagree",
    str_detect(tolower(g8_my_community_ability), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_my_community_ability), "^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_my_community_ability), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g8_my_community_ability), "^strongly agree$|sangat setuju|e\\. sangat setuju|strongly_agree") ~ "Strongly agree",
    str_detect(tolower(g8_my_community_ability), "not answered|no dependance") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_my_community_ability_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_my_community_ability_std)) %>%
  count(g8_my_community_ability) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_trust_community))

# Unique values
unique(merged_hhs$g8_trust_community)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_trust_community_std = case_when(
    str_detect(tolower(g8_trust_community), "^strongly disagree$|strongly_disagree|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g8_trust_community), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_trust_community), "^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_trust_community), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g8_trust_community), "^strongly agree$|strongly_agree|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g8_trust_community), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_trust_community_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_trust_community_std)) %>%
  count(g8_trust_community) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_trust_community_emergency))

# Unique values
unique(merged_hhs$g8_trust_community_emergency)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_trust_community_emergency_std = case_when(
    str_detect(tolower(g8_trust_community_emergency), "^strongly disagree$|strongly_disagree|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g8_trust_community_emergency), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_trust_community_emergency), "^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_trust_community_emergency), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g8_trust_community_emergency), "^strongly agree$|strongly_agree|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_trust_community_emergency_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_trust_community_emergency_std)) %>%
  count(g8_trust_community_emergency) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_trust_community_neighbors))

# Unique values
unique(merged_hhs$g8_trust_community_neighbors)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_trust_community_neighbors_std = case_when(
    str_detect(tolower(g8_trust_community_neighbors), "^strongly disagree$|strongly_disagree|a\\. sangat tidak setuju|sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g8_trust_community_neighbors), "^disagree$|b\\. tidak setuju|tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_trust_community_neighbors), "^neither$|neither agree nor disagree|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_trust_community_neighbors), "^agree$|d\\. setuju|setuju") ~ "Agree",
    str_detect(tolower(g8_trust_community_neighbors), "^strongly agree$|strongly_agree|e\\. sangat setuju|sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g8_trust_community_neighbors), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))


# Unique values
unique(merged_hhs$g8_trust_community_neighbors_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_trust_community_neighbors_std)) %>%
  count(g8_trust_community_neighbors) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_trust_community_rebuilt))

# Unique values
unique(merged_hhs$g8_trust_community_rebuilt)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_trust_community_rebuilt_std = case_when(
    str_detect(tolower(g8_trust_community_rebuilt), "^strongly disagree$|strongly_disagree|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g8_trust_community_rebuilt), "^disagree$|b\\. tidak setuju|tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_trust_community_rebuilt), "^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_trust_community_rebuilt), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g8_trust_community_rebuilt), "^strongly agree$|strongly_agree|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_trust_community_rebuilt_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_trust_community_rebuilt_std)) %>%
  count(g8_trust_community_rebuilt) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_trust_local_decision))

# Unique values
unique(merged_hhs$g8_trust_local_decision)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_trust_local_decision_std = case_when(
    str_detect(tolower(g8_trust_local_decision), "^strongly disagree$|strongly_disagree|a\\. sangat tidak setuju|sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g8_trust_local_decision), "^disagree$|b\\. tidak setuju|tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_trust_local_decision), "^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_trust_local_decision), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g8_trust_local_decision), "^strongly agree$|strongly_agree|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g8_trust_local_decision), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_trust_local_decision_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_trust_local_decision_std)) %>%
  count(g8_trust_local_decision) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g8_trust_regional_decision))

# Unique values
unique(merged_hhs$g8_trust_regional_decision)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g8_trust_regional_decision_std = case_when(
    str_detect(tolower(g8_trust_regional_decision), "^strongly disagree$|strongly_disagree|a\\. sangat tidak setuju|sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g8_trust_regional_decision), "^disagree$|b\\. tidak setuju|tidak setuju") ~ "Disagree",
    str_detect(tolower(g8_trust_regional_decision), "^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g8_trust_regional_decision), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g8_trust_regional_decision), "^strongly agree$|strongly_agree|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g8_trust_regional_decision), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g8_trust_regional_decision_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g8_trust_regional_decision_std)) %>%
  count(g8_trust_regional_decision) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_benefits))

# Unique values
unique(merged_hhs$g9_ma_benefits)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_benefits_std = case_when(
    str_detect(tolower(g9_ma_benefits), "^yes$|a\\. ya") ~ "Yes",
    str_detect(tolower(g9_ma_benefits), "^no$|b\\. tidak") ~ "No",
    str_detect(tolower(g9_ma_benefits), "not answered|tidak tahu|c\\. tidak tahu|^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_ma_benefits_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_benefits_std)) %>%
  count(g9_ma_benefits) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_familiar))

# Unique values
unique(merged_hhs$g9_ma_familiar)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_familiar_std = case_when(
    str_detect(tolower(g9_ma_familiar), "^yes$|a\\. ya|^ya$") ~ "Yes",
    str_detect(tolower(g9_ma_familiar), "^no$|b\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g9_ma_familiar), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g9_ma_familiar_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_familiar_std)) %>%
  count(g9_ma_familiar) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_fishers_allowed))

# Unique values
unique(merged_hhs$g9_ma_fishers_allowed)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_fishers_allowed_std = case_when(
    str_detect(tolower(g9_ma_fishers_allowed), "community only|community_only|a\\. hanya anggota masyarakat|hanya anggota masyarakat") ~
      "Community members only",
    str_detect(tolower(g9_ma_fishers_allowed), "with authorization|with_authorization|b\\. anggota masyarakat.*izin") ~
      "Community members and members from neighboring community with authorization/permit",
    str_detect(tolower(g9_ma_fishers_allowed), "without authorization|without_authorization|c\\. anggota masyarakat.*tidak memiliki izin") ~
      "Community members and members from neighboring community without authorization/permit",
    str_detect(tolower(g9_ma_fishers_allowed), "no restrictions|no_restrictions") ~
      "There are no access restrictions",
    str_detect(tolower(g9_ma_fishers_allowed), "don't know|idk|tidak tahu|f\\. tidak tahu") ~
      "Do not know",
    str_detect(tolower(g9_ma_fishers_allowed), "no managed access|no_managed_area|e\\. masyarakat tidak memiliki kawasan") ~
      "Community does not have a managed area",
    str_detect(tolower(g9_ma_fishers_allowed), "not answered|^na$") ~
      NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_ma_fishers_allowed_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_fishers_allowed_std)) %>%
  count(g9_ma_fishers_allowed) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_restrictions_ma_gear))

# Unique values
unique(merged_hhs$g9_restrictions_ma_gear)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_restrictions_ma_gear_std = case_when(
    str_detect(tolower(g9_restrictions_ma_gear), "^no$|b\\. tidak") ~ "No",
    str_detect(tolower(g9_restrictions_ma_gear), "^yes$|a\\. ya|^ya$") ~ "Yes",
    str_detect(tolower(g9_restrictions_ma_gear), "tidak tahu|c\\. tidak tahu") ~ "Don’t know",
    str_detect(tolower(g9_restrictions_ma_gear), "not answered|not a fisher|^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g9_restrictions_ma_gear_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_restrictions_ma_gear_std)) %>%
  count(g9_restrictions_ma_gear) %>%
  arrange(desc(n))

# List of column names to inspect
gear_cols <- c(
  "g9_ma_gear_barrier",
  "g9_ma_gear_braceamento",
  "g9_ma_gear_cast_net",
  "g9_ma_gear_corral",
  "g9_ma_gear_dynamite",
  "g9_ma_gear_estacada",
  "g9_ma_gear_gamboa",
  "g9_ma_gear_gancho",
  "g9_ma_gear_gillnet",
  "g9_ma_gear_gleaning",
  "g9_ma_gear_handline",
  "g9_ma_gear_harpoon",
  "g9_ma_gear_hookline",
  "g9_ma_gear_liftnet",
  "g9_ma_gear_longline",
  "g9_ma_gear_loop",
  "g9_ma_gear_matapi",
  "g9_ma_gear_mesh",
  "g9_ma_gear_mosquito",
  "g9_ma_gear_multiple_pole_and_lines",
  "g9_ma_gear_nets",
  "g9_ma_gear_other",
  "g9_ma_gear_poison",
  "g9_ma_gear_pot",
  "g9_ma_gear_purse_seine",
  "g9_ma_gear_quinia",
  "g9_ma_gear_rag",
  "g9_ma_gear_seine",
  "g9_ma_gear_siru",
  "g9_ma_gear_speargun",
  "g9_ma_gear_surround",
  "g9_ma_gear_trap",
  "g9_ma_gear_trawl"
)


# Check unique values for each column
lapply(setNames(gear_cols, gear_cols), function(col) unique(merged_hhs[[col]]))

# Standardization function
standardize_gear_response <- function(x) {
  x_lower <- tolower(trimws(x))
  
  case_when(
    x_lower %in% c("permitted", "diizinkan", "a. diizinkan", "yes", "ya", "a. ya", "ya.") ~ "Permitted",
    x_lower %in% c("not permitted", "not_permitted", "tidak diizinkan", "b. tidak diizinkan", "b. tidak", "no", "tidak") ~ "Not permitted",
    x_lower %in% c("don’t know", "c. tidak tahu", "tidak tahu", "unknown") ~ "Don’t know",
    x_lower %in% c("", "na", "not answered", "not a fisher") | is.na(x) ~ NA_character_,
    TRUE ~ NA_character_  # fallback for unexpected inputs
  )
}

# Apply across gear columns
merged_hhs <- merged_hhs %>%
  mutate(across(all_of(gear_cols), standardize_gear_response))


# NOTE: "Not a fisher" --> NA


# unique(merged_hhs$g9_ma_gear_other_specify)

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_gear_seine))

# Unique values
unique(merged_hhs$g9_ma_gear_seine)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_gear_seine_std = case_when(
    str_detect(tolower(g9_ma_gear_seine), "^permitted$|a\\. diizinkan|^diizinkan$") ~ "Permitted",
    str_detect(tolower(g9_ma_gear_seine), "^not_permitted$|b\\. tidak diizinkan") ~ "Not permitted",
    str_detect(tolower(g9_ma_gear_seine), "^unknown$|c\\. tidak tahu|tidak tahu") ~ "Don’t know",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_ma_gear_seine_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_gear_seine_std)) %>%
  count(g9_ma_gear_seine) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_gear_surround))

# Unique values
unique(merged_hhs$g9_ma_gear_surround)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_gear_surround_std = case_when(
    str_detect(tolower(g9_ma_gear_surround), "^permitted$|a\\. diizinkan|^diizinkan$") ~ "Permitted",
    str_detect(tolower(g9_ma_gear_surround), "^not_permitted$|b\\. tidak diizinkan") ~ "Not permitted",
    str_detect(tolower(g9_ma_gear_surround), "^unknown$|c\\. tidak tahu|tidak tahu") ~ "Don’t know",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_ma_gear_surround_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_gear_surround_std)) %>%
  count(g9_ma_gear_surround) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_gear_trap))

# Unique values
unique(merged_hhs$g9_ma_gear_trap)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_gear_trap_std = case_when(
    str_detect(tolower(g9_ma_gear_trap), "^permitted$") ~ "Permitted",
    str_detect(tolower(g9_ma_gear_trap), "^not permitted$|^not_permitted$") ~ "Not permitted",
    str_detect(tolower(g9_ma_gear_trap), "^unknown$") ~ "Don’t know",
    str_trim(g9_ma_gear_trap) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_ma_gear_trap_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_gear_trap_std)) %>%
  count(g9_ma_gear_trap) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_gear_trawl))

# Unique values
unique(merged_hhs$g9_ma_gear_trawl)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_gear_trawl_std = case_when(
    str_detect(tolower(g9_ma_gear_trawl), "^permitted$|a\\. diizinkan|^diizinkan$") ~ "Permitted",
    str_detect(tolower(g9_ma_gear_trawl), "^not permitted$|^not_permitted$|b\\. tidak diizinkan") ~ "Not permitted",
    str_detect(tolower(g9_ma_gear_trawl), "^unknown$|c\\. tidak tahu|tidak tahu") ~ "Don’t know",
    str_detect(tolower(g9_ma_gear_trawl), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g9_ma_gear_trawl_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_gear_trawl_std)) %>%
  count(g9_ma_gear_trawl) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_reserve_boundry_knowledge))

# Unique values
unique(merged_hhs$g9_reserve_boundry_knowledge)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_reserve_boundry_knowledge_std = case_when(
    str_detect(tolower(g9_reserve_boundry_knowledge), "^yes$|a\\. ya|^ya$") ~ "Yes",
    str_detect(tolower(g9_reserve_boundry_knowledge), "^no$|b\\. tidak") ~ "No",
    str_detect(tolower(g9_reserve_boundry_knowledge), "^no_reserves$|masyarakat tidak memiliki kawasan larang ambil") ~
      "Community does not have reserves",
    str_detect(tolower(g9_reserve_boundry_knowledge), "not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_reserve_boundry_knowledge_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_reserve_boundry_knowledge_std)) %>%
  count(g9_reserve_boundry_knowledge) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_reserve_fishing_allowed))

# Unique values
unique(merged_hhs$g9_reserve_fishing_allowed)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_reserve_fishing_allowed_std = case_when(
    str_detect(tolower(g9_reserve_fishing_allowed), "^yes$|a\\. ya|^ya$") ~ "Yes",
    str_detect(tolower(g9_reserve_fishing_allowed), "^no$|b\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g9_reserve_fishing_allowed), "^no_reserves$|masyarakat tidak memiliki kawasan larang ambil") ~ 
      "Community does not have reserves",
    str_detect(tolower(g9_reserve_fishing_allowed), "not answered|not a fisher") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# NOTE: "Not a fisher" --> NA

# Unique values
unique(merged_hhs$g9_reserve_fishing_allowed_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_reserve_fishing_allowed_std)) %>%
  count(g9_reserve_fishing_allowed) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_restrictions_ability_max_size))

# Unique values
unique(merged_hhs$g9_restrictions_ability_max_size)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_restrictions_ability_max_size_std = case_when(
    str_detect(tolower(g9_restrictions_ability_max_size), "^yes$") ~ "Yes",
    str_detect(tolower(g9_restrictions_ability_max_size), "^no$") ~ "No",
    str_detect(tolower(g9_restrictions_ability_max_size), "not answered|^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_restrictions_ability_max_size_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_restrictions_ability_max_size_std)) %>%
  count(g9_restrictions_ability_max_size) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_restrictions_ability_min_size))

# Unique values
unique(merged_hhs$g9_restrictions_ability_min_size)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_restrictions_ability_min_size_std = case_when(
    str_detect(tolower(g9_restrictions_ability_min_size), "^yes$") ~ "Yes",
    str_detect(tolower(g9_restrictions_ability_min_size), "^no$") ~ "No",
    str_detect(tolower(g9_restrictions_ability_min_size), "not answered|^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_restrictions_ability_min_size_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_restrictions_ability_min_size_std)) %>%
  count(g9_restrictions_ability_min_size) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_attend_meeting_female))

# Unique values
unique(merged_hhs$g10_attend_meeting_female)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_attend_meeting_female_std = case_when(
    str_detect(tolower(g10_attend_meeting_female), "^never$|a\\. tidak pernah|tidak pernah") ~ "Never",
    str_detect(tolower(g10_attend_meeting_female), "^rarely$|b\\. jarang|jarang") ~ "Rarely",
    str_detect(tolower(g10_attend_meeting_female), "^sometimes$|c\\. kadang|kadang-kadang") ~ "Sometimes",
    str_detect(tolower(g10_attend_meeting_female), "^regularly$|d\\. rutin|rutin") ~ "Regularly",
    str_detect(tolower(g10_attend_meeting_female), "^always$|e\\. selalu|selalu") ~ "Always",
    str_detect(tolower(g10_attend_meeting_female), "tidak berlaku|^na$|not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_attend_meeting_female_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_attend_meeting_female_std)) %>%
  count(g10_attend_meeting_female) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_attend_meeting_male))

# Unique values
unique(merged_hhs$g10_attend_meeting_male)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_attend_meeting_male_std = case_when(
    str_detect(tolower(g10_attend_meeting_male), "^never$|^a\\. tidak pernah|tidak pernah") ~ "Never",
    str_detect(tolower(g10_attend_meeting_male), "^rarely$|^b\\. jarang|jarang") ~ "Rarely",
    str_detect(tolower(g10_attend_meeting_male), "^sometimes$|^c\\. kadang|kadang-kadang") ~ "Sometimes",
    str_detect(tolower(g10_attend_meeting_male), "^regularly$|^d\\. rutin|rutin") ~ "Regularly",
    str_detect(tolower(g10_attend_meeting_male), "^always$|^e\\. selalu|selalu") ~ "Always",
    str_detect(tolower(g10_attend_meeting_male), "tidak berlaku|^na$|not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_attend_meeting_male_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_attend_meeting_male_std)) %>%
  count(g10_attend_meeting_male) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_attend_meeting_nonbinary))

# Unique values
unique(merged_hhs$g10_attend_meeting_nonbinary)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_attend_meeting_nonbinary_std = case_when(
    str_detect(tolower(g10_attend_meeting_nonbinary), "^never$") ~ "Never",
    str_detect(tolower(g10_attend_meeting_nonbinary), "^rarely$") ~ "Rarely",
    str_detect(tolower(g10_attend_meeting_nonbinary), "^sometimes$") ~ "Sometimes",
    str_detect(tolower(g10_attend_meeting_nonbinary), "^regularly$") ~ "Regularly",
    str_detect(tolower(g10_attend_meeting_nonbinary), "^always$") ~ "Always",
    str_detect(tolower(g10_attend_meeting_nonbinary), "^na$|not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_attend_meeting_nonbinary_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_attend_meeting_nonbinary_std)) %>%
  count(g10_attend_meeting_nonbinary) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_agreement_fishing_permission))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_fishing_permission)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_agreement_fishing_permission_std = case_when(
    str_detect(tolower(g10_benefits_comply_agreement_fishing_permission), "^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g10_benefits_comply_agreement_fishing_permission), "^disagree$") ~ "Disagree",
    str_detect(tolower(g10_benefits_comply_agreement_fishing_permission), "^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_benefits_comply_agreement_fishing_permission), "^agree$") ~ "Agree",
    str_detect(tolower(g10_benefits_comply_agreement_fishing_permission), "^strongly_agree$") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_fishing_permission_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_agreement_fishing_permission_std)) %>%
  count(g10_benefits_comply_agreement_fishing_permission) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_agreement_gear))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_gear)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_agreement_gear_std = case_when(
    str_detect(tolower(g10_benefits_comply_agreement_gear), "^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g10_benefits_comply_agreement_gear), "^disagree$") ~ "Disagree",
    str_detect(tolower(g10_benefits_comply_agreement_gear), "^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_benefits_comply_agreement_gear), "^agree$") ~ "Agree",
    str_detect(tolower(g10_benefits_comply_agreement_gear), "^strongly_agree$") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_gear_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_agreement_gear_std)) %>%
  count(g10_benefits_comply_agreement_gear) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_agreement_licensing))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_licensing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_agreement_licensing_std = case_when(
    str_detect(tolower(g10_benefits_comply_agreement_licensing), "^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g10_benefits_comply_agreement_licensing), "^disagree$") ~ "Disagree",
    str_detect(tolower(g10_benefits_comply_agreement_licensing), "^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_benefits_comply_agreement_licensing), "^agree$") ~ "Agree",
    str_detect(tolower(g10_benefits_comply_agreement_licensing), "^strongly_agree$") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_licensing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_agreement_licensing_std)) %>%
  count(g10_benefits_comply_agreement_licensing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_agreement_min_fish_size))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_min_fish_size)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_agreement_min_fish_size_std = case_when(
    str_detect(tolower(g10_benefits_comply_agreement_min_fish_size), "^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g10_benefits_comply_agreement_min_fish_size), "^disagree$") ~ "Disagree",
    str_detect(tolower(g10_benefits_comply_agreement_min_fish_size), "^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_benefits_comply_agreement_min_fish_size), "^agree$") ~ "Agree",
    str_detect(tolower(g10_benefits_comply_agreement_min_fish_size), "^strongly_agree$") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_min_fish_size_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_agreement_min_fish_size_std)) %>%
  count(g10_benefits_comply_agreement_min_fish_size) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_agreement_no_fishing))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_no_fishing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_agreement_no_fishing_std = case_when(
    str_detect(tolower(g10_benefits_comply_agreement_no_fishing), "^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g10_benefits_comply_agreement_no_fishing), "^disagree$") ~ "Disagree",
    str_detect(tolower(g10_benefits_comply_agreement_no_fishing), "^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_benefits_comply_agreement_no_fishing), "^agree$") ~ "Agree",
    str_detect(tolower(g10_benefits_comply_agreement_no_fishing), "^strongly_agree$") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_no_fishing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_agreement_no_fishing_std)) %>%
  count(g10_benefits_comply_agreement_no_fishing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_agreement_other))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_other)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_agreement_other_std = case_when(
    str_detect(tolower(g10_benefits_comply_agreement_other), "^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g10_benefits_comply_agreement_other), "^disagree$") ~ "Disagree",
    str_detect(tolower(g10_benefits_comply_agreement_other), "^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_benefits_comply_agreement_other), "^agree$") ~ "Agree",
    str_detect(tolower(g10_benefits_comply_agreement_other), "^strongly_agree$") ~ "Strongly agree",
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_agreement_other_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_agreement_other_std)) %>%
  count(g10_benefits_comply_agreement_other) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_comply_rules_fishing_permission))

# Unique values
unique(merged_hhs$g10_comply_rules_fishing_permission)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_comply_rules_fishing_permission_std = case_when(
    str_detect(tolower(g10_comply_rules_fishing_permission), "^very_easy$|^sangat mudah$|a\\. sangat mudah") ~ "Very easy",
    str_detect(tolower(g10_comply_rules_fishing_permission), "^easy$|^mudah$|b\\. mudah") ~ "Easy",
    str_detect(tolower(g10_comply_rules_fishing_permission), "^neutral$|^netral$|c\\. netral") ~ "Neutral",
    str_detect(tolower(g10_comply_rules_fishing_permission), "^difficult$|^sulit$|d\\. sulit") ~ "Difficult",
    str_detect(tolower(g10_comply_rules_fishing_permission), "^very_difficult$|^sangat sulit$|e\\. sangat sulit") ~ "Very difficult",
    str_detect(tolower(g10_comply_rules_fishing_permission), "na$|not answered|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_comply_rules_fishing_permission_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_comply_rules_fishing_permission_std)) %>%
  count(g10_comply_rules_fishing_permission) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_comply_rules_gear))

# Unique values
unique(merged_hhs$g10_comply_rules_gear)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_comply_rules_gear_std = case_when(
    str_detect(tolower(g10_comply_rules_gear), "^very_easy$|^sangat mudah$|a\\. sangat mudah") ~ "Very easy",
    str_detect(tolower(g10_comply_rules_gear), "^easy$|^mudah$|b\\. mudah") ~ "Easy",
    str_detect(tolower(g10_comply_rules_gear), "^neutral$|^netral$|c\\. netral") ~ "Neutral",
    str_detect(tolower(g10_comply_rules_gear), "^difficult$|^dfficult$|^sulit$|d\\. sulit") ~ "Difficult",
    str_detect(tolower(g10_comply_rules_gear), "^very_difficult$|^sangat sulit$|e\\. sangat sulit") ~ "Very difficult",
    str_detect(tolower(g10_comply_rules_gear), "na$|not answered|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_comply_rules_gear_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_comply_rules_gear_std)) %>%
  count(g10_comply_rules_gear) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_comply_rules_licensing))

# Unique values
unique(merged_hhs$g10_comply_rules_licensing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_comply_rules_licensing_std = case_when(
    str_detect(tolower(g10_comply_rules_licensing), "^very_easy$|sangat mudah|a\\. sangat mudah") ~ "Very easy",
    str_detect(tolower(g10_comply_rules_licensing), "^easy$|mudah|b\\. mudah") ~ "Easy",
    str_detect(tolower(g10_comply_rules_licensing), "^neutral$|netral|c\\. netral") ~ "Neutral",
    str_detect(tolower(g10_comply_rules_licensing), "^difficult$|sulit|d\\. sulit") ~ "Difficult",
    str_detect(tolower(g10_comply_rules_licensing), "^very_difficult$|sangat sulit|e\\. sangat sulit") ~ "Very difficult",
    str_detect(tolower(g10_comply_rules_licensing), "na$|not answered|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_comply_rules_licensing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_comply_rules_licensing_std)) %>%
  count(g10_comply_rules_licensing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_comply_rules_min_fish))

# Unique values
unique(merged_hhs$g10_comply_rules_min_fish)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_comply_rules_min_fish_std = case_when(
    str_detect(tolower(g10_comply_rules_min_fish), "^very_easy$") ~ "Very easy",
    str_detect(tolower(g10_comply_rules_min_fish), "^easy$") ~ "Easy",
    str_detect(tolower(g10_comply_rules_min_fish), "^neutral$") ~ "Neutral",
    str_detect(tolower(g10_comply_rules_min_fish), "^difficult$") ~ "Difficult",
    str_detect(tolower(g10_comply_rules_min_fish), "^very_difficult$") ~ "Very difficult",
    str_detect(tolower(g10_comply_rules_min_fish), "^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_comply_rules_min_fish_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_comply_rules_min_fish_std)) %>%
  count(g10_comply_rules_min_fish) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_comply_rules_other))

# Unique values
unique(merged_hhs$g10_comply_rules_other)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_comply_rules_other_std = case_when(
    str_detect(tolower(g10_comply_rules_other), "^very_easy$|a\\. sangat mudah|sangat mudah") ~ "Very easy",
    str_detect(tolower(g10_comply_rules_other), "^easy$|b\\. mudah|mudah") ~ "Easy",
    str_detect(tolower(g10_comply_rules_other), "^neutral$|c\\. netral|netral") ~ "Neutral",
    str_detect(tolower(g10_comply_rules_other), "^difficult$|d\\. sulit|sulit") ~ "Difficult",
    str_detect(tolower(g10_comply_rules_other), "^very_difficult$|e\\. sangat sulit|sangat sulit") ~ "Very difficult",
    str_detect(tolower(g10_comply_rules_other), "na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_comply_rules_other_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_comply_rules_other_std)) %>%
  count(g10_comply_rules_other) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_comply_rules_reserve_restrict))

# Unique values
unique(merged_hhs$g10_comply_rules_reserve_restrict)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_comply_rules_reserve_restrict_std = case_when(
    str_detect(tolower(g10_comply_rules_reserve_restrict), "^very_easy$|a\\. sangat mudah|sangat mudah") ~ "Very easy",
    str_detect(tolower(g10_comply_rules_reserve_restrict), "^easy$|b\\. mudah|mudah") ~ "Easy",
    str_detect(tolower(g10_comply_rules_reserve_restrict), "^neutral$|c\\. netral|netral") ~ "Neutral",
    str_detect(tolower(g10_comply_rules_reserve_restrict), "^difficult$|d\\. sulit|sulit") ~ "Difficult",
    str_detect(tolower(g10_comply_rules_reserve_restrict), "^very_difficult$|e\\. sangat sulit|sangat sulit") ~ "Very difficult",
    str_detect(tolower(g10_comply_rules_reserve_restrict), "na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_comply_rules_reserve_restrict_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_comply_rules_reserve_restrict_std)) %>%
  count(g10_comply_rules_reserve_restrict) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_encourage_regulations))

# Unique values
unique(merged_hhs$g10_encourage_regulations)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_encourage_regulations_std = case_when(
    str_detect(tolower(g10_encourage_regulations), "^very_often$|^a\\. sangat sering$|^sangat sering$|^very often$") ~ "Very often",
    str_detect(tolower(g10_encourage_regulations), "^often$|^b\\. sering$|^sering$") ~ "Often",
    str_detect(tolower(g10_encourage_regulations), "^sometimes$|^c\\. kadang-kadang$|^kadang-kadang$") ~ "Sometimes",
    str_detect(tolower(g10_encourage_regulations), "^rarely$|^d\\. jarang$|^jarang$") ~ "Rarely",
    str_detect(tolower(g10_encourage_regulations), "^never$|^e\\. tidak pernah$|^tidak pernah$") ~ "Never",
    str_detect(tolower(g10_encourage_regulations), "^no_regulations$|^no regulations$|masyarakat tidak memiliki aturan penangkapan ikan") ~
      "Community does not have fishing regulations",
    str_detect(tolower(g10_encourage_regulations), "^not answered$|^not applicable$|^na$|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_encourage_regulations_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_encourage_regulations_std)) %>%
  count(g10_encourage_regulations) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_caught))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_caught)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_caught_std = case_when(
    g10_enforcement_regulation_fishers_caught %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_caught,
    g10_enforcement_regulation_fishers_caught == "Not Answered" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_caught_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_caught_std)) %>%
  count(g10_enforcement_regulation_fishers_caught) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_gear_not_permitted))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_gear_not_permitted)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_gear_not_permitted_std = case_when(
    g10_enforcement_regulation_fishers_gear_not_permitted %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_gear_not_permitted,
    g10_enforcement_regulation_fishers_gear_not_permitted %in% c("Not Answered", "na", "Tidak tahu") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_gear_not_permitted_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_gear_not_permitted_std)) %>%
  count(g10_enforcement_regulation_fishers_gear_not_permitted) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_ma_area))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_ma_area)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_ma_area_std = case_when(
    g10_enforcement_regulation_fishers_ma_area %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_ma_area,
    g10_enforcement_regulation_fishers_ma_area %in% c("Not Answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_ma_area_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_ma_area_std)) %>%
  count(g10_enforcement_regulation_fishers_ma_area) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_reserves))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_reserves)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_reserves_std = case_when(
    g10_enforcement_regulation_fishers_reserves %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_reserves,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_reserves_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_reserves_std)) %>%
  count(g10_enforcement_regulation_fishers_reserves) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_violate_fish_size))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_violate_fish_size)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_violate_fish_size_std = case_when(
    g10_enforcement_regulation_fishers_violate_fish_size %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_violate_fish_size,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_violate_fish_size_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_violate_fish_size_std)) %>%
  count(g10_enforcement_regulation_fishers_violate_fish_size) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_ma_benefit_5yrs))

# Unique values
unique(merged_hhs$g10_ma_benefit_5yrs)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_ma_benefit_5yrs_std = case_when(
    str_detect(tolower(g10_ma_benefit_5yrs), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_ma_benefit_5yrs), "^unsure$|not_sure|tidak yakin|b\\. tidak yakin") ~ "Unsure",
    str_detect(tolower(g10_ma_benefit_5yrs), "^no$|c\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g10_ma_benefit_5yrs), "no management|no_mgmt|masyarakat belum memiliki sistem pengelolaan perikanan|d\\. masyarakat belum memiliki sistem pengelolaan perikanan") ~
      "Community does not have a fisheries management system",
    str_detect(tolower(g10_ma_benefit_5yrs), "^na$|not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_ma_benefit_5yrs_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_ma_benefit_5yrs_std)) %>%
  count(g10_ma_benefit_5yrs) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_ma_punishment))

# Unique values
unique(merged_hhs$g10_ma_punishment)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_ma_punishment_std = case_when(
    str_detect(tolower(g10_ma_punishment), "^no punishment$|no_punishment|a\\. tidak ada sanksi|tidak ada sanksi") ~ "No punishment",
    str_detect(tolower(g10_ma_punishment), "^minor$|b\\. sanksi ringan|sanksi ringan") ~ "Minor punishment",
    str_detect(tolower(g10_ma_punishment), "^moderate$|c\\. sanksi sedang|sanksi sedang") ~ "Moderate punishment",
    str_detect(tolower(g10_ma_punishment), "^major$|d\\. sanksi berat|sanksi berat") ~ "Major punishment",
    str_detect(tolower(g10_ma_punishment), "^extreme$|e\\. sanksi sangat berat|sanksi sangat berat") ~ "Extreme punishment",
    str_detect(tolower(g10_ma_punishment), "^no regulations$|no_regs|tidak ada aturan penangkapan ikan|f\\. tidak ada aturan penangkapan ikan") ~ "There are no regulations",
    str_detect(tolower(g10_ma_punishment), "not answered|na") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_ma_punishment_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_ma_punishment_std)) %>%
  count(g10_ma_punishment) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_opinions_considered))

# Unique values
unique(merged_hhs$g10_opinions_considered)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_opinions_considered_std = case_when(
    str_detect(tolower(g10_opinions_considered), "^very_low$|a\\. sangat tidak yakin|sangat tidak yakin") ~ "Very low",
    str_detect(tolower(g10_opinions_considered), "^low$|b\\. tidak yakin|tidak yakin") ~ "Low",
    str_detect(tolower(g10_opinions_considered), "^neither|c\\. ragu-ragu|ragu-ragu") ~ "Neither strong or low",
    str_detect(tolower(g10_opinions_considered), "^strong$|d\\. yakin|yakin") ~ "Strong",
    str_detect(tolower(g10_opinions_considered), "^very_strong$|e\\. sangat yakin|sangat yakin") ~ "Very strong",
    str_detect(tolower(g10_opinions_considered), "^no management body$|no_mgmt|tidak ada kelompok pengelolaan akses area perikanan|f\\. tidak ada kelompok pengelolaan akses area perikanan") ~ "No management body",
    str_detect(tolower(g10_opinions_considered), "^tidak tahu|not answered|^$|na") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_opinions_considered_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_opinions_considered_std)) %>%
  count(g10_opinions_considered) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_represent_role))

# Unique values
unique(merged_hhs$g10_represent_role)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_represent_role_std = case_when(
    str_detect(tolower(g10_represent_role), "^disagree$|b\\. tidak setuju|tidak setuju") ~ "Disagree",
    str_detect(tolower(g10_represent_role), "^neither$|c\\. netral|netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g10_represent_role), "^agree$|a\\. setuju|setuju") ~ "Agree",
    str_detect(tolower(g10_represent_role), "^no management body$|no_mgmt") ~ "No management body",
    str_detect(tolower(g10_represent_role), "^$|na|tidak tahu / tidak ikut kelompok pengelolaan akses area perikanan") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_represent_role_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_represent_role_std)) %>%
  count(g10_represent_role) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_knowledge_fishing_permission))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_fishing_permission)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_knowledge_fishing_permission_std = case_when(
    str_detect(tolower(g10_benefits_comply_knowledge_fishing_permission), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_benefits_comply_knowledge_fishing_permission), "^no$|b\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g10_benefits_comply_knowledge_fishing_permission), "^$") | is.na(g10_benefits_comply_knowledge_fishing_permission) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_fishing_permission_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_knowledge_fishing_permission_std)) %>%
  count(g10_benefits_comply_knowledge_fishing_permission) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_knowledge_gear))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_gear)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_knowledge_gear_std = case_when(
    str_detect(tolower(g10_benefits_comply_knowledge_gear), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_benefits_comply_knowledge_gear), "^no$|b\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g10_benefits_comply_knowledge_gear), "^$") | is.na(g10_benefits_comply_knowledge_gear) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_gear_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_knowledge_gear_std)) %>%
  count(g10_benefits_comply_knowledge_gear) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_knowledge_licensing))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_licensing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_knowledge_licensing_std = case_when(
    str_detect(tolower(g10_benefits_comply_knowledge_licensing), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_benefits_comply_knowledge_licensing), "^no$|b\\. tidak|^tidak$") ~ "No",
    str_detect(tolower(g10_benefits_comply_knowledge_licensing), "^$") | is.na(g10_benefits_comply_knowledge_licensing) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_licensing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_knowledge_licensing_std)) %>%
  count(g10_benefits_comply_knowledge_licensing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_knowledge_min_fish_size))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_min_fish_size)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_knowledge_min_fish_size_std = case_when(
    str_detect(tolower(g10_benefits_comply_knowledge_min_fish_size), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_benefits_comply_knowledge_min_fish_size), "^no$|^tidak$|b\\. tidak") ~ "No",
    str_detect(tolower(g10_benefits_comply_knowledge_min_fish_size), "^$") | is.na(g10_benefits_comply_knowledge_min_fish_size) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_min_fish_size_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_knowledge_min_fish_size_std)) %>%
  count(g10_benefits_comply_knowledge_min_fish_size_std) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_knowledge_other))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_other)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_knowledge_other_std = case_when(
    str_detect(tolower(g10_benefits_comply_knowledge_other), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_benefits_comply_knowledge_other), "^no$|^tidak$|b\\. tidak") ~ "No",
    is.na(g10_benefits_comply_knowledge_other) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_other_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_knowledge_other_std)) %>%
  count(g10_benefits_comply_knowledge_other) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_benefits_comply_knowledge_reserve_restrict))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_reserve_restrict)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_benefits_comply_knowledge_reserve_restrict_std = case_when(
    str_detect(tolower(g10_benefits_comply_knowledge_reserve_restrict), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_benefits_comply_knowledge_reserve_restrict), "^no$|^tidak$|b\\. tidak") ~ "No",
    is.na(g10_benefits_comply_knowledge_reserve_restrict) | str_trim(g10_benefits_comply_knowledge_reserve_restrict) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_benefits_comply_knowledge_reserve_restrict_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_benefits_comply_knowledge_reserve_restrict_std)) %>%
  count(g10_benefits_comply_knowledge_reserve_restrict) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_share_opinion))

# Unique values
unique(merged_hhs$g10_share_opinion)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_share_opinion_std = case_when(
    str_detect(tolower(g10_share_opinion), "^never$|a\\. tidak pernah|tidak pernah") ~ "Never",
    str_detect(tolower(g10_share_opinion), "^rarely$|b\\. jarang|jarang") ~ "Rarely",
    str_detect(tolower(g10_share_opinion), "^sometimes$|c\\. kadang-kadang|kadang-kadang") ~ "Sometimes",
    str_detect(tolower(g10_share_opinion), "^regularly$|d\\. sering|sering") ~ "Regularly",
    str_detect(tolower(g10_share_opinion), "^always$|e\\. selalu") ~ "Always",
    str_detect(tolower(g10_share_opinion), "^no_meetings$|tidak ada pertemuan") ~ "No management body meetings",
    str_detect(tolower(g10_share_opinion), "na|tidak tahu") | 
      is.na(g10_share_opinion) | 
      str_trim(g10_share_opinion) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_share_opinion_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_share_opinion_std)) %>%
  count(g10_share_opinion) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_time_place_female))

# Unique values
unique(merged_hhs$g10_time_place_female)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_time_place_female_std = case_when(
    str_detect(tolower(g10_time_place_female), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_time_place_female), "^no$|^tidak$|b\\. tidak") ~ "No",
    str_detect(tolower(g10_time_place_female), "tidak tahu|na") | 
      is.na(g10_time_place_female) | 
      str_trim(g10_time_place_female) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_time_place_female_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_time_place_female_std)) %>%
  count(g10_time_place_female) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_time_place_male))

# Unique values
unique(merged_hhs$g10_time_place_male)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_time_place_male_std = case_when(
    str_detect(tolower(g10_time_place_male), "^yes$|^ya$|a\\. ya") ~ "Yes",
    str_detect(tolower(g10_time_place_male), "^no$|^tidak$|b\\. tidak") ~ "No",
    str_detect(tolower(g10_time_place_male), "tidak tahu|na") | 
      is.na(g10_time_place_male) | 
      str_trim(g10_time_place_male) == "" ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_time_place_male_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_time_place_male_std)) %>%
  count(g10_time_place_male) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_time_place_nonbinary))

# Unique values
unique(merged_hhs$g10_time_place_nonbinary)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_time_place_nonbinary_std = case_when(
    str_detect(tolower(g10_time_place_nonbinary), "^yes$") ~ "Yes",
    str_detect(tolower(g10_time_place_nonbinary), "^no$") ~ "No",
    str_detect(tolower(g10_time_place_nonbinary), "^na$") | is.na(g10_time_place_nonbinary) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_time_place_nonbinary_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_time_place_nonbinary_std)) %>%
  count(g10_time_place_nonbinary) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_understand_info))

# Unique values
unique(merged_hhs$g10_understand_info)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_understand_info_std = case_when(
    str_detect(tolower(g10_understand_info), "^none$|^a\\. tidak ada$|tidak ada") ~ "None",
    str_detect(tolower(g10_understand_info), "^little$|^b\\. sedikit$|sedikit") ~ "A little",
    str_detect(tolower(g10_understand_info), "^some$|^c\\. sebagian$|sebagian") ~ "Some",
    str_detect(tolower(g10_understand_info), "^most$|^d\\. banyak$|banyak") ~ "Most",
    str_detect(tolower(g10_understand_info), "^everything$|^e\\. semuanya$|semuanya") ~ "Everything",
    str_detect(tolower(g10_understand_info), "no_meetings|tidak ada pertemuan") ~ "No management body meetings",
    str_detect(tolower(g10_understand_info), "^na$|tidak tahu|^f\\. tidak ada pertemuan$") | 
      is.na(g10_understand_info) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_understand_info_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_understand_info_std)) %>%
  count(g10_understand_info) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g11_food_availability))

# Unique values
unique(merged_hhs$g11_food_availability)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g11_food_availability_std = case_when(
    str_detect(tolower(g11_food_availability), "^very bad$|^a\\. sangat buruk$|sangat buruk|very_bad") ~ "Very bad",
    str_detect(tolower(g11_food_availability), "^rather bad$|^b\\. agak buruk$|agak buruk|rather_bad") ~ "Rather bad",
    str_detect(tolower(g11_food_availability), "^ok$|^c\\. cukup$|cukup") ~ "OK",
    str_detect(tolower(g11_food_availability), "^good$|^d\\. bagus$|bagus") ~ "Good",
    str_detect(tolower(g11_food_availability), "^very good$|^e\\. sangat bagus$|sangat bagus|very_good") ~ "Very good",
    str_detect(tolower(g11_food_availability), "^na$|not answered") | is.na(g11_food_availability) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g11_food_availability_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g11_food_availability_std)) %>%
  count(g11_food_availability) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g11_food_fish_consumption))

# Unique values
unique(merged_hhs$g11_food_fish_consumption)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g11_food_fish_consumption_std = case_when(
    str_detect(tolower(g11_food_fish_consumption), "once or never|a\\. tidak pernah|tidak pernah|once_or_never") ~ "Once or never",
    str_detect(tolower(g11_food_fish_consumption), "few$|few_times$|jarang|b\\. jarang") ~ "A few times",
    str_detect(tolower(g11_food_fish_consumption), "few per month|few_times_per_month|setiap bulan") ~ "A few times per month",
    str_detect(tolower(g11_food_fish_consumption), "few per week|few_times_per_week|setiap minggu") ~ "A few times per week",
    str_detect(tolower(g11_food_fish_consumption), "more than few|more_than_few_times|hampir setiap hari|e\\. hampir setiap hari") ~ "More than a few times per week",
    str_detect(tolower(g11_food_fish_consumption), "not answered|na") | is.na(g11_food_fish_consumption) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g11_food_fish_consumption_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g11_food_fish_consumption_std)) %>%
  count(g11_food_fish_consumption) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g11_food_procurement))

# Unique values
unique(merged_hhs$g11_food_procurement)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g11_food_procurement_std = case_when(
    str_detect(tolower(g11_food_procurement), "^very[_\\s]?confident[_\\s]?not|e\\. sangat yakin|sangat yakin") ~ "Very confident to procure enough food",
    str_detect(tolower(g11_food_procurement), "^confident[_\\s]?not|d\\. yakin|yakin") ~ "Confident to procure enough food",
    str_detect(tolower(g11_food_procurement), "^uncertain|c\\. ragu|ragu") ~ "Uncertain",
    str_detect(tolower(g11_food_procurement), "^high[_\\s]?chance|b\\. kemungkinan besar|kemungkinan besar") ~ "High chance of having shortage",
    str_detect(tolower(g11_food_procurement), "^certain|a\\. pasti|pasti akan mengalami") ~ "Certain to have shortage",
    str_detect(tolower(g11_food_procurement), "not answered|^na$") | g11_food_procurement == "" | is.na(g11_food_procurement) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g11_food_procurement_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g11_food_procurement_std)) %>%
  count(g11_food_procurement) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g11_food_worry))

# Unique values
unique(merged_hhs$g11_food_worry)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g11_food_worry_std = case_when(
    str_detect(tolower(g11_food_worry), "^often$|a\\. sering|sering") ~ "Often",
    str_detect(tolower(g11_food_worry), "^sometimes$|b\\. kadang|kadang") ~ "Sometimes",
    str_detect(tolower(g11_food_worry), "^never$|c\\. tidak|tidak pernah") ~ "Never",
    str_detect(tolower(g11_food_worry), "^not answered$") | g11_food_worry == "" | is.na(g11_food_worry) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g11_food_worry_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g11_food_worry_std)) %>%
  count(g11_food_worry) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_catch_recording))

# Unique values
unique(merged_hhs$g12_agreement_catch_recording)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_catch_recording_std = case_when(
    str_detect(tolower(g12_agreement_catch_recording), "^strongly disagree$|^strongly_disagree$|a\\. sangat tidak setuju|sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_catch_recording), "^disagree$|b\\. tidak setuju|tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_catch_recording), "^neither agree nor disagree$|^neither$|c\\. netral|netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_catch_recording), "^agree$|d\\. setuju|setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_catch_recording), "^strongly agree$|^strongly_agree$|e\\. sangat setuju|sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_catch_recording), "not answered|na|idk|f\\. tidak tahu|tidak tahu") |
      g12_agreement_catch_recording == "" | is.na(g12_agreement_catch_recording) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_catch_recording_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_catch_recording_std)) %>%
  count(g12_agreement_catch_recording) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_change_fishing_behavior))

# Unique values
unique(merged_hhs$g12_agreement_change_fishing_behavior)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_change_fishing_behavior_std = case_when(
    str_detect(tolower(g12_agreement_change_fishing_behavior), "^strongly disagree$|^strongly_disagree$") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_change_fishing_behavior), "^disagree$") ~ "Disagree",
    str_detect(tolower(g12_agreement_change_fishing_behavior), "^neither agree nor disagree$|^neither$") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_change_fishing_behavior), "^agree$") ~ "Agree",
    str_detect(tolower(g12_agreement_change_fishing_behavior), "^strongly agree$|^strongly_agree$") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_change_fishing_behavior), "^$|not answered|^na$") |
      is.na(g12_agreement_change_fishing_behavior) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_change_fishing_behavior_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_change_fishing_behavior_std)) %>%
  count(g12_agreement_change_fishing_behavior) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_community_participation))

# Unique values
unique(merged_hhs$g12_agreement_community_participation)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_community_participation_std = case_when(
    str_detect(tolower(g12_agreement_community_participation), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_community_participation), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_community_participation), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_community_participation), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_community_participation), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_community_participation), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_community_participation) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_community_participation_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_community_participation_std)) %>%
  count(g12_agreement_community_participation) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_current_regulations))

# Unique values
unique(merged_hhs$g12_agreement_current_regulations)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_current_regulations_std = case_when(
    str_detect(tolower(g12_agreement_current_regulations), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_current_regulations), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_current_regulations), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_current_regulations), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_current_regulations), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_current_regulations), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_current_regulations) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_current_regulations_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_current_regulations_std)) %>%
  count(g12_agreement_current_regulations) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_help_neighbors))

# Unique values
unique(merged_hhs$g12_agreement_help_neighbors)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_help_neighbors_std = case_when(
    str_detect(tolower(g12_agreement_help_neighbors), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_help_neighbors), "^disagree$|tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_help_neighbors), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_help_neighbors), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_help_neighbors), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_help_neighbors), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_help_neighbors) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_help_neighbors_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_help_neighbors_std)) %>%
  count(g12_agreement_help_neighbors) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_individual_behavior))

# Unique values
unique(merged_hhs$g12_agreement_individual_behavior)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_individual_behavior_std = case_when(
    str_detect(tolower(g12_agreement_individual_behavior), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_individual_behavior), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_individual_behavior), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_individual_behavior), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_individual_behavior), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_individual_behavior), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_individual_behavior) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_individual_behavior_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_individual_behavior_std)) %>%
  count(g12_agreement_individual_behavior) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_regulations_fair))

# Unique values
unique(merged_hhs$g12_agreement_regulations_fair)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_regulations_fair_std = case_when(
    str_detect(tolower(g12_agreement_regulations_fair), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_regulations_fair), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_regulations_fair), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_regulations_fair), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_regulations_fair), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_regulations_fair), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_regulations_fair) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_regulations_fair_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_regulations_fair_std)) %>%
  count(g12_agreement_regulations_fair) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_rights_distribution_fair))

# Unique values
unique(merged_hhs$g12_agreement_rights_distribution_fair)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_rights_distribution_fair_std = case_when(
    str_detect(tolower(g12_agreement_rights_distribution_fair), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_rights_distribution_fair), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_rights_distribution_fair), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_rights_distribution_fair), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_rights_distribution_fair), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_rights_distribution_fair), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_rights_distribution_fair) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_rights_distribution_fair_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_rights_distribution_fair_std)) %>%
  count(g12_agreement_rights_distribution_fair) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_agreement_strong_enforcement))

# Unique values
unique(merged_hhs$g12_agreement_strong_enforcement)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_agreement_strong_enforcement_std = case_when(
    str_detect(tolower(g12_agreement_strong_enforcement), "^strongly disagree$|^strongly_disagree$|sangat tidak setuju|a\\. sangat tidak setuju") ~ "Strongly disagree",
    str_detect(tolower(g12_agreement_strong_enforcement), "^disagree$|tidak setuju|b\\. tidak setuju") ~ "Disagree",
    str_detect(tolower(g12_agreement_strong_enforcement), "^neither agree nor disagree$|^neither$|netral|c\\. netral") ~ "Neither agree nor disagree",
    str_detect(tolower(g12_agreement_strong_enforcement), "^agree$|setuju|d\\. setuju") ~ "Agree",
    str_detect(tolower(g12_agreement_strong_enforcement), "^strongly agree$|^strongly_agree$|sangat setuju|e\\. sangat setuju") ~ "Strongly agree",
    str_detect(tolower(g12_agreement_strong_enforcement), "^$|not answered|tidak tahu|f\\. tidak tahu|idk|na") |
      is.na(g12_agreement_strong_enforcement) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_agreement_strong_enforcement_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_agreement_strong_enforcement_std)) %>%
  count(g12_agreement_strong_enforcement) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_complies_reserve))

# Unique values
unique(merged_hhs$g12_complies_reserve)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_complies_reserve_std = case_when(
    str_detect(tolower(g12_complies_reserve), "^go down$|^catch_down$|tangkapan nelayan akan turun|a\\. tangkapan nelayan akan turun") ~ "Fishers’ catch will go down",
    str_detect(tolower(g12_complies_reserve), "^stay the same$|^catch_same$|tangkapan nelayan akan sama saja|b\\. tangkapan nelayan akan sama saja") ~ "Fishers’ catch will stay the same",
    str_detect(tolower(g12_complies_reserve), "^go up$|^catch_up$|tangkapan nelayan akan naik|c\\. tangkapan nelayan akan naik") ~ "Fishers’ catch will go up",
    str_detect(tolower(g12_complies_reserve), "don't know|idk|tidak tahu|d\\. tidak tahu") ~ "Don’t know",
    str_detect(tolower(g12_complies_reserve), "^$|na") | is.na(g12_complies_reserve) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_complies_reserve_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_complies_reserve_std)) %>%
  count(g12_complies_reserve) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_fishing_in_reserve))

# Unique values
unique(merged_hhs$g12_fishing_in_reserve)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_fishing_in_reserve_std = case_when(
    str_detect(tolower(g12_fishing_in_reserve), "^never$|a\\. tidak pernah|tidak pernah") ~ "Never",
    str_detect(tolower(g12_fishing_in_reserve), "^occasionally$|b\\. jarang|jarang") ~ "Occasionally",
    str_detect(tolower(g12_fishing_in_reserve), "^often$|c\\. kadang-kadang") ~ "Often",
    str_detect(tolower(g12_fishing_in_reserve), "^frequently$|d\\. rutin|rutin") ~ "Frequently",
    str_detect(tolower(g12_fishing_in_reserve), "^always$|e\\. selalu|selalu") ~ "Always",
    str_detect(tolower(g12_fishing_in_reserve), "^$|^\\d+$|not answered|na") ~ NA_character_,
    TRUE ~ NA_character_
  ))

#NOTE: numbers --> NA

# Unique values
unique(merged_hhs$g12_fishing_in_reserve_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_fishing_in_reserve_std)) %>%
  count(g12_fishing_in_reserve) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_how_wrong_gear))

# Unique values
unique(merged_hhs$g12_how_wrong_gear)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_how_wrong_gear_std = case_when(
    str_detect(tolower(g12_how_wrong_gear), "^not_wrong$|a\\. tidak salah|tidak salah") ~ "Not wrong at all",
    str_detect(tolower(g12_how_wrong_gear), "^slightly_wrong$|b\\. sedikit salah|sedikit salah") ~ "Slightly wrong",
    str_detect(tolower(g12_how_wrong_gear), "^moderately_wrong$|c\\. cukup salah|cukup salah") ~ "Moderately wrong",
    str_detect(tolower(g12_how_wrong_gear), "^very_wrong$|d\\. salah|salah") ~ "Very wrong",
    str_detect(tolower(g12_how_wrong_gear), "^extremely_wrong$|e\\. sangat salah|sangat salah") ~ "Extremely wrong",
    str_detect(tolower(g12_how_wrong_gear), "^$|na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_how_wrong_gear_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_how_wrong_gear_std)) %>%
  count(g12_how_wrong_gear) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_how_wrong_licensing))

# Unique values
unique(merged_hhs$g12_how_wrong_licensing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_how_wrong_licensing_std = case_when(
    str_detect(tolower(g12_how_wrong_licensing), "^not_wrong$|a\\. tidak salah|tidak salah") ~ "Not wrong at all",
    str_detect(tolower(g12_how_wrong_licensing), "^slightly_wrong$|b\\. sedikit salah|sedikit salah") ~ "Slightly wrong",
    str_detect(tolower(g12_how_wrong_licensing), "^moderately_wrong$|c\\. cukup salah|cukup salah") ~ "Moderately wrong",
    str_detect(tolower(g12_how_wrong_licensing), "^very_wrong$|d\\. salah|salah") ~ "Very wrong",
    str_detect(tolower(g12_how_wrong_licensing), "^extremely_wrong$|e\\. sangat salah|sangat salah") ~ "Extremely wrong",
    str_detect(tolower(g12_how_wrong_licensing), "^$|na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_how_wrong_licensing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_how_wrong_licensing_std)) %>%
  count(g12_how_wrong_licensing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_how_wrong_managed_area_fishing))

# Unique values
unique(merged_hhs$g12_how_wrong_managed_area_fishing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_how_wrong_managed_area_fishing_std = case_when(
    str_detect(tolower(g12_how_wrong_managed_area_fishing), "^not_wrong$|a\\. tidak salah|tidak salah") ~ "Not wrong at all",
    str_detect(tolower(g12_how_wrong_managed_area_fishing), "^slightly_wrong$|b\\. sedikit salah|sedikit salah") ~ "Slightly wrong",
    str_detect(tolower(g12_how_wrong_managed_area_fishing), "^moderately_wrong$|c\\. cukup salah|cukup salah") ~ "Moderately wrong",
    str_detect(tolower(g12_how_wrong_managed_area_fishing), "^very_wrong$|d\\. salah|salah") ~ "Very wrong",
    str_detect(tolower(g12_how_wrong_managed_area_fishing), "^extremely_wrong$|e\\. sangat salah|sangat salah") ~ "Extremely wrong",
    str_detect(tolower(g12_how_wrong_managed_area_fishing), "^$|na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_how_wrong_managed_area_fishing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_how_wrong_managed_area_fishing_std)) %>%
  count(g12_how_wrong_managed_area_fishing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_how_wrong_min_fish_size))

# Unique values
unique(merged_hhs$g12_how_wrong_min_fish_size)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_how_wrong_min_fish_size_std = case_when(
    str_detect(tolower(g12_how_wrong_min_fish_size), "^not_wrong$|a\\. tidak salah|tidak salah") ~ "Not wrong at all",
    str_detect(tolower(g12_how_wrong_min_fish_size), "^slightly_wrong$|b\\. sedikit salah|sedikit salah") ~ "Slightly wrong",
    str_detect(tolower(g12_how_wrong_min_fish_size), "^moderately_wrong$|c\\. cukup salah|cukup salah") ~ "Moderately wrong",
    str_detect(tolower(g12_how_wrong_min_fish_size), "^very_wrong$|d\\. salah|salah") ~ "Very wrong",
    str_detect(tolower(g12_how_wrong_min_fish_size), "^extremely_wrong$|e\\. sangat salah|sangat salah") ~ "Extremely wrong",
    str_detect(tolower(g12_how_wrong_min_fish_size), "^$|na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_how_wrong_min_fish_size_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_how_wrong_min_fish_size_std)) %>%
  count(g12_how_wrong_min_fish_size) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_how_wrong_other))

# Unique values
unique(merged_hhs$g12_how_wrong_other)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_how_wrong_other_std = case_when(
    str_detect(tolower(g12_how_wrong_other), "^not_wrong$|a\\. tidak salah|tidak salah") ~ "Not wrong at all",
    str_detect(tolower(g12_how_wrong_other), "^slightly_wrong$|b\\. sedikit salah|sedikit salah") ~ "Slightly wrong",
    str_detect(tolower(g12_how_wrong_other), "^moderately_wrong$|c\\. cukup salah|cukup salah") ~ "Moderately wrong",
    str_detect(tolower(g12_how_wrong_other), "^very_wrong$|d\\. salah|salah") ~ "Very wrong",
    str_detect(tolower(g12_how_wrong_other), "^extremely_wrong$|e\\. sangat salah|sangat salah") ~ "Extremely wrong",
    str_detect(tolower(g12_how_wrong_other), "^$|na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_how_wrong_other_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_how_wrong_other_std)) %>%
  count(g12_how_wrong_other) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_how_wrong_reserve_fishing))

# Unique values
unique(merged_hhs$g12_how_wrong_reserve_fishing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_how_wrong_reserve_fishing_std = case_when(
    str_detect(tolower(g12_how_wrong_reserve_fishing), "^not_wrong$|a\\. tidak salah|tidak salah") ~ "Not wrong at all",
    str_detect(tolower(g12_how_wrong_reserve_fishing), "^slightly_wrong$|b\\. sedikit salah|sedikit salah") ~ "Slightly wrong",
    str_detect(tolower(g12_how_wrong_reserve_fishing), "^moderately_wrong$|c\\. cukup salah|cukup salah") ~ "Moderately wrong",
    str_detect(tolower(g12_how_wrong_reserve_fishing), "^very_wrong$|d\\. salah|salah") ~ "Very wrong",
    str_detect(tolower(g12_how_wrong_reserve_fishing), "^extremely_wrong$|e\\. sangat salah|sangat salah") ~ "Extremely wrong",
    str_detect(tolower(g12_how_wrong_reserve_fishing), "^$|na|tidak berlaku") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_how_wrong_reserve_fishing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_how_wrong_reserve_fishing_std)) %>%
  count(g12_how_wrong_reserve_fishing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_mgmt_rules_fair))

# Unique values
unique(merged_hhs$g12_mgmt_rules_fair)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_mgmt_rules_fair_std = case_when(
    g12_mgmt_rules_fair %in% as.character(0:10) ~ g12_mgmt_rules_fair,
    str_detect(tolower(g12_mgmt_rules_fair), "^$|na|tidak tahu|-1") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_mgmt_rules_fair_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_mgmt_rules_fair_std)) %>%
  count(g12_mgmt_rules_fair) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g12_no_wrong_fishing_reserve))

# Unique values
unique(merged_hhs$g12_no_wrong_fishing_reserve)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g12_no_wrong_fishing_reserve_std = case_when(
    g12_no_wrong_fishing_reserve %in% as.character(0:10) ~ g12_no_wrong_fishing_reserve,
    str_detect(tolower(g12_no_wrong_fishing_reserve), "^$|na|tidak tahu|not answered|-1") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g12_no_wrong_fishing_reserve_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g12_no_wrong_fishing_reserve_std)) %>%
  count(g12_no_wrong_fishing_reserve) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g13_current_economic))

# Unique values
unique(merged_hhs$g13_current_economic)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g13_current_economic_std = case_when(
    str_detect(tolower(g13_current_economic), "^much worse$|^much_worse$|a\\. jauh lebih buruk|jauh lebih buruk") ~ "Much worse",
    str_detect(tolower(g13_current_economic), "^slightly worse$|^slightly_worse$|b\\. sedikit lebih buruk|sedikit lebih buruk") ~ "Slightly worse",
    str_detect(tolower(g13_current_economic), "^neither$|c\\. sama saja|sama saja") ~ "Neither better or worse",
    str_detect(tolower(g13_current_economic), "^slightly better$|^slightly_better$|d\\. sedikit lebih baik|sedikit lebih baik") ~ "Slightly better",
    str_detect(tolower(g13_current_economic), "^much better$|^much_better$|e\\. jauh lebih baik|jauh lebih baik") ~ "Much better",
    str_detect(tolower(g13_current_economic), "^$|na|not answered") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g13_current_economic_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g13_current_economic_std)) %>%
  count(g13_current_economic) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g13_financial_decisions))

# Unique values
unique(merged_hhs$g13_financial_decisions)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g13_financial_decisions_std = case_when(
    str_detect(tolower(g13_financial_decisions), "^myself$|a\\. saya sendiri|saya sendiri") ~ "Myself",
    str_detect(tolower(g13_financial_decisions), "^my female partner$|b\\. pasangan perempuan saya|pasangan perempuan saya|my_female_partner") ~ "My female partner",
    str_detect(tolower(g13_financial_decisions), "^my male partner$|c\\. pasangan laki-laki saya|pasangan laki-laki saya|my_male_partner") ~ "My male partner",
    str_detect(tolower(g13_financial_decisions), "^my nonbinary partner$|my_nonbinary_partner") ~ "My non-binary partner",
    str_detect(tolower(g13_financial_decisions), "^both$|d\\. suami istri membuat keputusan bersama|suami istri membuat keputusan bersama") ~ "Both",
    str_detect(tolower(g13_financial_decisions), "^not answered$|^$|^na$") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g13_financial_decisions_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g13_financial_decisions_std)) %>%
  count(g13_financial_decisions) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g13_future_economic))

# Unique values
unique(merged_hhs$g13_future_economic)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g13_future_economic_std = case_when(
    str_detect(tolower(g13_future_economic), "^much worse$|much_worse|a\\. jauh lebih buruk|jauh lebih buruk") ~ "Much worse",
    str_detect(tolower(g13_future_economic), "^slightly worse$|slightly_worse|b\\. sedikit lebih buruk|sedikit lebih buruk") ~ "Slightly worse",
    str_detect(tolower(g13_future_economic), "^neither$|c\\. sama saja|sama saja") ~ "Neither better or worse",
    str_detect(tolower(g13_future_economic), "^slightly better$|slightly_better|d\\. sedikit lebih baik|sedikit lebih baik") ~ "Slightly better",
    str_detect(tolower(g13_future_economic), "^much better$|much_better|e\\. jauh lebih baik|jauh lebih baik") ~ "Much better",
    str_detect(tolower(g13_future_economic), "^not answered$|^$|na") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g13_future_economic_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g13_future_economic_std)) %>%
  count(g13_future_economic) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g13_hh_ends_meet))

# Unique values
unique(merged_hhs$g13_hh_ends_meet)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g13_hh_ends_meet_std = case_when(
    str_detect(tolower(g13_hh_ends_meet), "^with great difficulty$|with_great_difficulty|a\\. dengan sangat susah payah|dengan sangat susah payah") ~ "With great difficulty",
    str_detect(tolower(g13_hh_ends_meet), "^with difficulty$|with_difficulty|b\\. dengan susah payah|dengan susah payah") ~ "With difficulty",
    str_detect(tolower(g13_hh_ends_meet), "^fairly easy$|fairly_easy|c\\. cukup mudah|cukup mudah") ~ "Fairly easy",
    str_detect(tolower(g13_hh_ends_meet), "^easy$|d\\. mudah|mudah") ~ "Easy",
    str_detect(tolower(g13_hh_ends_meet), "^very easy$|very_easy|e\\. sangat mudah|sangat mudah") ~ "Very easy",
    str_detect(tolower(g13_hh_ends_meet), "^not answered$|^$|na") ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g13_hh_ends_meet_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g13_hh_ends_meet_std)) %>%
  count(g13_hh_ends_meet) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_fixed_net))

# Unique values
unique(merged_hhs$g5_gear_fixed_net)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_fixed_net_std = case_when(
    str_detect(tolower(g5_gear_fixed_net), "^yes$") ~ "Yes",
    str_detect(tolower(g5_gear_fixed_net), "^no$") ~ "No",
    str_detect(tolower(g5_gear_fixed_net), "na|not answered") | is.na(g5_gear_fixed_net) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g5_gear_fixed_net_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_fixed_net_std)) %>%
  count(g5_gear_fixed_net) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g1_fmb_existing))

# Unique values
unique(merged_hhs$g1_fmb_existing)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g1_fmb_existing_std = case_when(
    str_detect(tolower(g1_fmb_existing), "^yes$|^a\\. ya$|^ya$") ~ "Yes",
    str_detect(tolower(g1_fmb_existing), "^no$|^b\\. tidak$|^tidak$") ~ "No",
    str_detect(tolower(g1_fmb_existing), "na|not answered") | is.na(g1_fmb_existing) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g1_fmb_existing_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g1_fmb_existing_std)) %>%
  count(g1_fmb_existing) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_long_line))

# Unique values
unique(merged_hhs$g5_gear_long_line)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_long_line_std = case_when(
    str_detect(tolower(g5_gear_long_line), "^yes_own$|^a\\. ya.*|^b\\. ya.*|ya,") ~ "Yes",
    str_detect(tolower(g5_gear_long_line), "^no$|^c\\. tidak$|^tidak$") ~ "No",
    str_detect(tolower(g5_gear_long_line), "na|not answered") | is.na(g5_gear_long_line) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g5_gear_long_line_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_long_line_std)) %>%
  count(g5_gear_long_line) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g5_gear_traditional))

# Unique values
unique(merged_hhs$g5_gear_traditional)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g5_gear_traditional_std = case_when(
    str_detect(tolower(g5_gear_traditional), "^yes_own$|^yes_not_own$|^a\\. ya.*|^b\\. ya.*|ya,") ~ "Yes",
    str_detect(tolower(g5_gear_traditional), "^no$|^c\\. tidak$|^tidak$") ~ "No",
    str_detect(tolower(g5_gear_traditional), "na|not answered") | is.na(g5_gear_traditional) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g5_gear_traditional_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g5_gear_traditional_std)) %>%
  count(g5_gear_traditional) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_reserves_caught))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_reserves_caught)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_reserves_caught_std = case_when(
    str_trim(tolower(g10_enforcement_regulation_fishers_reserves_caught)) %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_reserves_caught,
    str_detect(tolower(g10_enforcement_regulation_fishers_reserves_caught), "na|tidak tahu") |
      is.na(g10_enforcement_regulation_fishers_reserves_caught) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_reserves_caught_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_reserves_caught_std)) %>%
  count(g10_enforcement_regulation_fishers_reserves_caught) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g10_enforcement_regulation_fishers_violate_fishing_rules))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_violate_fishing_rules)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g10_enforcement_regulation_fishers_violate_fishing_rules_std = case_when(
    str_trim(tolower(g10_enforcement_regulation_fishers_violate_fishing_rules)) %in% as.character(0:10) ~ g10_enforcement_regulation_fishers_violate_fishing_rules,
    str_detect(tolower(g10_enforcement_regulation_fishers_violate_fishing_rules), "na|tidak tahu") |
      is.na(g10_enforcement_regulation_fishers_violate_fishing_rules) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g10_enforcement_regulation_fishers_violate_fishing_rules_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g10_enforcement_regulation_fishers_violate_fishing_rules_std)) %>%
  count(g10_enforcement_regulation_fishers_violate_fishing_rules) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_reserve_boundry_aware))

# Unique values
unique(merged_hhs$g9_reserve_boundry_aware)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_reserve_boundry_aware_std = case_when(
    str_trim(tolower(g9_reserve_boundry_aware)) %in% as.character(0:10) ~ g9_reserve_boundry_aware,
    str_trim(tolower(g9_reserve_boundry_aware)) == "no_ma_reserve" ~ "Community does not have reserves",
    str_detect(tolower(g9_reserve_boundry_aware), "tidak tahu|not answered") |
      is.na(g9_reserve_boundry_aware) ~ NA_character_,
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_reserve_boundry_aware_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_reserve_boundry_aware_std)) %>%
  count(g9_reserve_boundry_aware) %>%
  arrange(desc(n))

# Count number of NA values 
sum(is.na(merged_hhs$g9_ma_boundry_aware))

# Unique values
unique(merged_hhs$g9_ma_boundry_aware)

# Standardize entries
merged_hhs <- merged_hhs %>%
  mutate(g9_ma_boundry_aware_std = case_when(
    str_trim(tolower(g9_ma_boundry_aware)) %in% as.character(0:10) ~ g9_ma_boundry_aware,
    
    str_to_lower(g9_ma_boundry_aware) == "strongly disagree" ~ "0",
    str_to_lower(g9_ma_boundry_aware) == "disagree" ~ "3",
    str_to_lower(g9_ma_boundry_aware) == "neither" ~ "5",
    str_to_lower(g9_ma_boundry_aware) == "agree" ~ "7",
    str_to_lower(g9_ma_boundry_aware) == "strongly agree" ~ "10",
    
    str_to_lower(g9_ma_boundry_aware) %in% c("no reserve", "no managed access", "no_ma_reserve") ~ 
      "Community does not have a managed area",
    
    str_detect(str_to_lower(g9_ma_boundry_aware), "na|not answered|tidak tahu") |
      is.na(g9_ma_boundry_aware) ~ NA_character_,
    
    TRUE ~ NA_character_
  ))

# Unique values
unique(merged_hhs$g9_ma_boundry_aware_std)

# Check entries re-classified as NA
merged_hhs %>%
  filter(is.na(g9_ma_boundry_aware_std)) %>%
  count(g9_ma_boundry_aware) %>%
  arrange(desc(n))
```




```{r}
#Keep one column version (remove _std columns)

# Step 1: Identify all "_std" columns
std_cols <- grep("_std$", colnames(merged_hhs), value = TRUE)

# Step 2: For each "_std" column:
for (std_col in std_cols) {
  base_col <- sub("_std$", "", std_col)
  
  # Replace the base column with the _std version (if it exists)
  if (base_col %in% colnames(merged_hhs)) {
    merged_hhs[[base_col]] <- merged_hhs[[std_col]]
  } else {
    # If the base column doesn't exist, just rename the std_col to base_col
    merged_hhs[[base_col]] <- merged_hhs[[std_col]]
  }
  
  # Remove the original "_std" column
  merged_hhs[[std_col]] <- NULL
}
```








```{r}
# Re-classify g10_enforcement_responsible
unique(merged_hhs$g10_enforcement_responsible)

unique(merged_hhs$g10_enforcement_responsible_community_surveilance)
unique(merged_hhs$g10_enforcement_responsible_fmb)
unique(merged_hhs$g10_enforcement_responsible_myself)
unique(merged_hhs$g10_enforcement_responsible_national)
unique(merged_hhs$g10_enforcement_responsible_no_enforcement)
unique(merged_hhs$g10_enforcement_responsible_other)
unique(merged_hhs$g10_enforcement_responsible_subnational)



sum(is.na(merged_hhs$g10_enforcement_responsible_fmb))


merged_hhs <- merged_hhs %>%
  mutate(
    g10_enf_resp_lower = tolower(trimws(g10_enforcement_responsible)),

    g10_enforcement_responsible_community_surveilance = case_when(
      !is.na(g10_enforcement_responsible_community_surveilance) ~ g10_enforcement_responsible_community_surveilance,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "\\bpokmaswas\\b") ~ "1",
      TRUE ~ "0"
    ),

    g10_enforcement_responsible_fmb = case_when(
      !is.na(g10_enforcement_responsible_fmb) ~ g10_enforcement_responsible_fmb,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "\\bfmb\\b") ~ "1",
      TRUE ~ "0"
    ),

    g10_enforcement_responsible_myself = case_when(
      !is.na(g10_enforcement_responsible_myself) ~ g10_enforcement_responsible_myself,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "\\bmyself\\b") ~ "1",
      TRUE ~ "0"
    ),

    g10_enforcement_responsible_national = case_when(
      !is.na(g10_enforcement_responsible_national) ~ g10_enforcement_responsible_national,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "\\bpemerintah pusat\\b|\\bnational\\b") ~ "1",
      TRUE ~ "0"
    ),

    g10_enforcement_responsible_subnational = case_when(
      !is.na(g10_enforcement_responsible_subnational) ~ g10_enforcement_responsible_subnational,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "\\bpemerintah daerah\\b|\\bsubnational\\b|local_gov") ~ "1",
      TRUE ~ "0"
    ),

    g10_enforcement_responsible_no_enforcement = case_when(
      !is.na(g10_enforcement_responsible_no_enforcement) ~ g10_enforcement_responsible_no_enforcement,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "tidak tahu|no_enforcement") ~ "1",
      TRUE ~ "0"
    ),

    g10_enforcement_responsible_other = case_when(
      !is.na(g10_enforcement_responsible_other) ~ g10_enforcement_responsible_other,
      is.na(g10_enf_resp_lower) | g10_enf_resp_lower == "na" ~ NA_character_,
      str_detect(g10_enf_resp_lower, "\\blainnya\\b|\\bother\\b") ~ "1",
      TRUE ~ "0"
    )
  ) %>%
  select(
    -g10_enf_resp_lower,
    -g10_enforcement_responsible
  )





# Re-classify g10_fisheries_management_leader
unique(merged_hhs$g10_fisheries_management_leader)

unique(merged_hhs$g10_fisheries_management_leader_no_mgmt)
unique(merged_hhs$g10_fisheries_management_leader_yes_female)
unique(merged_hhs$g10_fisheries_management_leader_yes_male)
unique(merged_hhs$g10_fisheries_management_leader_yes_nonbinary)


sum(is.na(merged_hhs$g10_fisheries_management_leader_yes_female))

merged_hhs <- merged_hhs %>%
  mutate(
    g10_leader_resp_lower = tolower(trimws(g10_fisheries_management_leader)),

    g10_fisheries_management_leader_yes_female = case_when(
      !is.na(g10_fisheries_management_leader_yes_female) ~ g10_fisheries_management_leader_yes_female,
      is.na(g10_leader_resp_lower) | g10_leader_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap",
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_leader_resp_lower, "yes_female|c. ya \\(perempuan\\)|ya \\(perempuan\\)|yes_both|yes_male yes_female|a. ya \\(laki-laki den perempuan\\)") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_leader_yes_male = case_when(
      !is.na(g10_fisheries_management_leader_yes_male) ~ g10_fisheries_management_leader_yes_male,
      is.na(g10_leader_resp_lower) | g10_leader_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap",
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_leader_resp_lower, "yes_male|b. ya \\(laki-laki\\)|ya \\(laki-laki\\)|yes_both|yes_male yes_female|a. ya \\(laki-laki den perempuan\\)|yes_nonbinary yes_male") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_leader_yes_nonbinary = case_when(
      !is.na(g10_fisheries_management_leader_yes_nonbinary) ~ g10_fisheries_management_leader_yes_nonbinary,
      is.na(g10_leader_resp_lower) | g10_leader_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap",
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_leader_resp_lower, "yes_nonbinary") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_leader_no_mgmt = case_when(
      !is.na(g10_fisheries_management_leader_no_mgmt) ~ g10_fisheries_management_leader_no_mgmt,
      is.na(g10_leader_resp_lower) | g10_leader_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap",
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      g10_leader_resp_lower %in% c("no") ~ "1",
      str_detect(g10_leader_resp_lower, "no_mgmt") ~ "1",
      g10_leader_resp_lower %in% c("yes_female no", "yes_male no", "yes_nonbinary no") ~ "1",
      TRUE ~ "0"
    )
  ) %>%
  select(-g10_leader_resp_lower, -g10_fisheries_management_leader)






# Re-classify g10_fisheries_management_meeting
unique(merged_hhs$g10_fisheries_management_meeting)

unique(merged_hhs$g10_fisheries_management_meeting_no_meetings)
unique(merged_hhs$g10_fisheries_management_meeting_no_mgmt)
unique(merged_hhs$g10_fisheries_management_meeting_yes_both_gender)
unique(merged_hhs$g10_fisheries_management_meeting_yes_female)
unique(merged_hhs$g10_fisheries_management_meeting_yes_male)
unique(merged_hhs$g10_fisheries_management_meeting_yes_nonbinary)

sum(is.na(merged_hhs$g10_fisheries_management_meeting_no_mgmt))
       
merged_hhs <- merged_hhs %>%
  mutate(
    g10_meeting_resp_lower = tolower(trimws(g10_fisheries_management_meeting)),

    g10_fisheries_management_meeting_yes_female = case_when(
      !is.na(g10_fisheries_management_meeting_yes_female) ~ g10_fisheries_management_meeting_yes_female,
      is.na(g10_meeting_resp_lower) | g10_meeting_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap", 
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_meeting_resp_lower, "yes_female|ya \\(perempuan\\)|c. ya \\(perempuan\\)") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_meeting_yes_male = case_when(
      !is.na(g10_fisheries_management_meeting_yes_male) ~ g10_fisheries_management_meeting_yes_male,
      is.na(g10_meeting_resp_lower) | g10_meeting_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap", 
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_meeting_resp_lower, "yes_male|ya \\(laki-laki\\)|b. ya \\(laki-laki\\)") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_meeting_yes_nonbinary = case_when(
      !is.na(g10_fisheries_management_meeting_yes_nonbinary) ~ g10_fisheries_management_meeting_yes_nonbinary,
      is.na(g10_meeting_resp_lower) | g10_meeting_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap", 
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_meeting_resp_lower, "yes_nonbinary") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_meeting_yes_both_gender = case_when(
      !is.na(g10_fisheries_management_meeting_yes_both_gender) ~ g10_fisheries_management_meeting_yes_both_gender,
      is.na(g10_meeting_resp_lower) | g10_meeting_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap", 
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_meeting_resp_lower, "yes_both_gender|yes_both|a. ya \\(laki-laki den perempuan\\)|laki-laki den perempuan") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_meeting_no_mgmt = case_when(
      !is.na(g10_fisheries_management_meeting_no_mgmt) ~ g10_fisheries_management_meeting_no_mgmt,
      is.na(g10_meeting_resp_lower) | g10_meeting_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap", 
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_meeting_resp_lower, "no_mgmt|\\bno\\b") ~ "1",
      TRUE ~ "0"
    ),

    g10_fisheries_management_meeting_no_meetings = case_when(
      !is.na(g10_fisheries_management_meeting_no_meetings) ~ g10_fisheries_management_meeting_no_meetings,
      is.na(g10_meeting_resp_lower) | g10_meeting_resp_lower %in% c(
        "na", "tidak", "d. tidak", "e. tidak tahu / tidak ikut kelompok paap", 
        "tidak tahu / tidak ikut kelompok paap"
      ) ~ NA_character_,
      str_detect(g10_meeting_resp_lower, "no_meetings") ~ "1",
      TRUE ~ "0"
    )
  ) %>%
  select(-g10_meeting_resp_lower, -g10_fisheries_management_meeting)







# Re-classify g1_ma_r_mb
unique(merged_hhs$g1_ma_r_mb)

unique(merged_hhs$g1_ma_r_mb_customary_area)
unique(merged_hhs$g1_ma_r_mb_management_area)
unique(merged_hhs$g1_ma_r_mb_management_body)
unique(merged_hhs$g1_ma_r_mb_marine_reserve)
unique(merged_hhs$g1_ma_r_mb_none)


sum(is.na(merged_hhs$g1_ma_r_mb_marine_reserve))

merged_hhs <- merged_hhs %>%
  mutate(
    g1_ma_r_mb_lower = tolower(trimws(g1_ma_r_mb)),

    g1_ma_r_mb_customary_area = case_when(
      !is.na(g1_ma_r_mb_customary_area) ~ g1_ma_r_mb_customary_area,
      is.na(g1_ma_r_mb_lower) | g1_ma_r_mb_lower %in% c("", "na") ~ NA_character_,
      str_detect(g1_ma_r_mb_lower, "customary_area|hukum adat") ~ "1",
      TRUE ~ "0"
    ),

    g1_ma_r_mb_management_area = case_when(
      !is.na(g1_ma_r_mb_management_area) ~ g1_ma_r_mb_management_area,
      is.na(g1_ma_r_mb_lower) | g1_ma_r_mb_lower %in% c("", "na") ~ NA_character_,
      str_detect(g1_ma_r_mb_lower, "management_area|kawasan pengelolaan|kkpd|taman nasional|paap") ~ "1",
      TRUE ~ "0"
    ),

    g1_ma_r_mb_management_body = case_when(
      !is.na(g1_ma_r_mb_management_body) ~ g1_ma_r_mb_management_body,
      is.na(g1_ma_r_mb_lower) | g1_ma_r_mb_lower %in% c("", "na") ~ NA_character_,
      str_detect(g1_ma_r_mb_lower, "management_body") ~ "1",
      TRUE ~ "0"
    ),

    g1_ma_r_mb_marine_reserve = case_when(
      !is.na(g1_ma_r_mb_marine_reserve) ~ g1_ma_r_mb_marine_reserve,
      is.na(g1_ma_r_mb_lower) | g1_ma_r_mb_lower %in% c("", "na") ~ NA_character_,
      str_detect(g1_ma_r_mb_lower, "marine_reserve|daerah perlindungan laut|kla|zona inti|blok perlindungan") ~ "1",
      TRUE ~ "0"
    ),

    g1_ma_r_mb_none = case_when(
      !is.na(g1_ma_r_mb_none) ~ g1_ma_r_mb_none,
      is.na(g1_ma_r_mb_lower) | g1_ma_r_mb_lower %in% c("", "na") ~ NA_character_,
      str_detect(g1_ma_r_mb_lower, "none|tidak ada") ~ "1",
      TRUE ~ "0"
    )
  ) %>%
  select(-g1_ma_r_mb_lower, -g1_ma_r_mb)





# Write CSV as backup
# write_csv(merged_hhs, "merged_hhs_cleaned.csv")


```




# Exploratory Analysis



```{r}
# Plotting Function
plot_response_distribution <- function(data, question_col, title, color_mapping) {
  
  col_sym <- ensym(question_col)
  
  # Ensure levels are ordered as in color_mapping
  response_levels <- names(color_mapping)
  
  # --- Plot 1: Response Distribution ---
 df_likert <- data %>%
  mutate(temp_response = as.character(!!col_sym)) %>%
  filter(!is.na(temp_response), temp_response %in% response_levels) %>%
  count(response = temp_response) %>%
  mutate(
    prop = n / sum(n),
    response = factor(response, levels = response_levels)
  )
  
  p1 <- ggplot(df_likert, aes(x = "", y = prop, fill = response)) +
    geom_col(position = "fill") +
    geom_text(aes(label = scales::percent(prop, accuracy = 1)), 
          position = position_fill(vjust = 0.5),
          color = "black") +
    scale_fill_manual(values = color_mapping) +
    coord_flip() +
    labs(
      title = "Distribution of Responses",
      x = NULL,
      y = "Proportion",
      fill = "Response"
    ) +
    theme_minimal()
  
  # --- Plot 2: Missing vs Answered ---
  df_missing <- data %>%
    mutate(response_status = ifelse(is.na(!!col_sym), "Missing", "Answered")) %>%
    count(response_status) %>%
    mutate(p = n / sum(n))
  
  p2 <- ggplot(df_missing, aes(x = "", y = n, fill = response_status)) +
    geom_col(width = 0.5) +
    geom_text(aes(label = paste0(n, " (", scales::percent(p, accuracy = 1), ")")),
          position = position_stack(vjust = 0.5)) +
    scale_fill_manual(values = c(
      "Answered" = "#1f78b4",
      "Missing" = "#d9d9d9"
    )) +
    labs(
      title = "Response Status",
      x = NULL,
      y = "Count",
      fill = NULL
    ) +
    theme_minimal() +
    coord_flip()
  
  # --- Combine and return ---
  (p2 / p1) +
    plot_layout(heights = c(1, 1)) +
    plot_annotation(
      title = title,
      theme = theme(
        plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
      )
    )
}


```



```{r}
#Plots

# Location
# unique(merged_hhs$g1_country) #Country

# --- Plot 1: Missing vs Answered for g1_country ---
df_missing <- merged_hhs %>%
  mutate(response_status = ifelse(is.na(g1_country), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_missing, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Plot 2: Country Distribution (excluding NAs) ---
df_country <- merged_hhs %>%
  filter(!is.na(g1_country)) %>%
  count(g1_country) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    g1_country = fct_reorder(g1_country, -n)  # order by count descending
  )

p2 <- ggplot(df_country, aes(x = g1_country, y = n, fill = g1_country)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Country",
    y = "Count"
  ) +
  theme_minimal()

# --- Combine the two plots ---
plot1 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Country",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )


# unique(merged_hhs$merged_hhs_province) #Level 1: Province
# unique(merged_hhs$merged_hhs_municipality) #Level 2: Municipality
# unique(merged_hhs$merged_hhs_community) #Level 4: Community






 
##############################################################



# Year
# unique(merged_hhs$year)

# --- Top plot: Missing vs Answered in year field ---
df_missing_year <- merged_hhs %>%
  mutate(response_status = ifelse(is.na(year), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_missing_year, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Distribution of Answered Years ---
df_years <- merged_hhs %>%
  filter(!is.na(year)) %>%
  count(year = as.character(year)) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    year = factor(year, levels = c("2019", "2020", "2021", "2022", "2023", "2024", "2025"))
  )

p2 <- ggplot(df_years, aes(x = year, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Year",
    y = "Count"
  ) +
  theme_minimal()

# --- Combine both plots ---
plot2 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Year",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )






 
##############################################################

#Does your community have a Fisheries & Coastal Management Group?
# unique(merged_hhs$g1_fmb_existing)


plot3 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g1_fmb_existing,
  title = "Does your community have a Fisheries & Coastal Management Group?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)




 
##############################################################



#Is it important to you that the area is managed and protected?
# unique(merged_hhs$g1_ma_r_important)

plot4 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g1_ma_r_important,
  title = "Is it important to you that the area is managed and protected?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a",
    "Don’t know" = "#d9d9d9"
  )
)






 
##############################################################




#Select which of the following are associated with your community
# unique(merged_hhs$g1_ma_r_mb_customary_area) #Select which of the following are associated with your community - Customary Area
# unique(merged_hhs$g1_ma_r_mb_management_area) #Select which of the following are associated with your community - Management Area
# unique(merged_hhs$g1_ma_r_mb_management_body) #Select which of the following are associated with your community - Management Body
# unique(merged_hhs$g1_ma_r_mb_marine_reserve) #Select which of the following are associated with your community - Marine Reserve
# unique(merged_hhs$g1_ma_r_mb_none) #Select which of the following are associated with your community - None

# --- Define columns of interest ---
columns <- c(
  `Customary Area` = "g1_ma_r_mb_customary_area",
  `Management Area` = "g1_ma_r_mb_management_area",
  `Management Body` = "g1_ma_r_mb_management_body",
  `Marine Reserve` = "g1_ma_r_mb_marine_reserve",
  `None` = "g1_ma_r_mb_none"
)

# --- Subset & rename ---
df_mb <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- Top plot: Answered vs Missing (none of the 5 answered) ---
df_status <- df_mb %>%
  mutate(
    response_status = if_else(
      rowSums(!is.na(.)) > 0, "Answered", "Missing"
    )
  ) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Selected vs Not selected (exclude missing) ---
df_long <- df_mb %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "value") %>%
  filter(!is.na(value)) %>%  # <--- remove true NAs at cell level
  mutate(response = if_else(value == "1", "Selected", "Not selected")) %>%
  count(Category, response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()

p2 <- ggplot(df_long, aes(x = Category, y = n, fill = response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = c(
    "Selected" = "#6baed6",
    "Not selected" = "#fb6a4a"
  )) +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion",
    fill = "Response"
  ) +
  coord_flip() +
  theme_minimal() 

# --- Combine both ---
plot5 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Which of the following are associated with your community?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )






 
##############################################################


#Interviewee status
# unique(merged_hhs$g1_hh_status)


# --- Top plot: Missing vs Answered in g1_hh_status ---
df_missing_status <- merged_hhs %>%
  mutate(response_status = ifelse(is.na(g1_hh_status), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_missing_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Distribution of g1_hh_status (Answered only) ---
df_status <- merged_hhs %>%
  filter(!is.na(g1_hh_status)) %>%
  count(status = g1_hh_status) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    status = fct_reorder(status, -n)
  )

p2 <- ggplot(df_status, aes(x = status, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Household Status",
    y = "Count"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# --- Combine both plots ---
plot6 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "What is your relationship to the household head?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )





 
##############################################################


#Gender
# unique(merged_hhs$g2_gender)


plot7 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g2_gender,
  title = "Gender",
  color_mapping = c(
    "Male" = "#6baed6",
    "Female" = "#fb6a4a",
    "Non-Binary" = "#d9d9d9"
  )
)






 
##############################################################


#Religion
# unique(merged_hhs$g2_religion)
# unique(merged_hhs$g2_religion_other) #Specify

# --- Top plot: Missing vs Answered in g2_religion ---
df_missing_religion <- merged_hhs %>%
  mutate(response_status = ifelse(is.na(g2_religion), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_missing_religion, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Distribution of g2_religion (Answered only) ---
df_religion <- merged_hhs %>%
  filter(!is.na(g2_religion)) %>%
  count(religion = g2_religion) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    religion = fct_reorder(religion, -n)
  )

p2 <- ggplot(df_religion, aes(x = religion, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Religion",
    y = "Count"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# --- Combine both plots ---
plot8 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "What is your religion?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )






 
##############################################################


#Is it important to you that the region is managed and protected?
# unique(merged_hhs$g2_region_protection_important)

plot9 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g2_region_protection_important,
  title = "Is it important to you that the region is managed and protected?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a",
    "Neutral" = "#d9d9d9"
  )
)





 
##############################################################



# #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage
# #What percentage of your income comes from this activity? --> ONLY USE THIS FOR ANALYSIS!
# #unique(merged_hhs$g4_hh_average_income_source_a_farming_yes_no) # Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - a) Agriculture (farming and/or livestock raising)
# unique(merged_hhs$g4_hh_average_income_source_a_income_farming) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_b_harvesting_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - b) Utilization of forest products (wood, charcoal, non-wood forest products)
# unique(merged_hhs$g4_hh_average_income_source_b_income_harvesting) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_c_artisanal_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - c) Traditional fishing methods (catching fish, shrimp, crabs and their relatives, and other marine products for sale or consumption)
# unique(merged_hhs$g4_hh_average_income_source_c_income_fishing_artisanal) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_d_aquaculture_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - d) Cultivation (fish, shrimp, seaweed, etc.: including making floating net cages/maintaining fish caught when small to be sold when they are larger)
# unique(merged_hhs$g4_hh_average_income_source_d_income_fishing_aquaculture) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_e_fishbuying_trading_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - e) Purchase or sale of fish (not the family/husband's catch)
# unique(merged_hhs$g4_hh_average_income_source_e_income_buying_trading) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_f_processing_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - f) Processing fish (cleaning, drying, etc.)
# unique(merged_hhs$g4_hh_average_income_source_f_income_processing) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_g_extraction_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - g) Utilization of non-renewable marine resources (including coral reef mining, sand mining, harvesting live coral reefs, etc.)
# unique(merged_hhs$g4_hh_average_income_source_g_income_extraction) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_h_tourism_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - h) Marine tourism (including diving, surface diving, glass bottom boats, sailing, water skiing, water scooters, etc.)
# unique(merged_hhs$g4_hh_average_income_source_h_income_tourism) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_i_other_wage_labor_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - i) Other wage earners (both permanent and part-time) for example ship crew/ABK, teachers, medical staff, professional craftsmen, workers in forest or mining concessions, laborers, craftsmen, motorcycle taxi drivers)
# unique(merged_hhs$g4_hh_average_income_source_i_income_other_wage) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_j_industrial_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - j) Fishing industry (catching fish, shrimp, crabs and other seafood for sale or consumption)
# unique(merged_hhs$g4_hh_average_income_source_j_income_industrial) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_k_other_yes_no) #Please indicate from the following list all sources of household income this year, and estimate their contribution to overall household income as a percentage - k) Others
# unique(merged_hhs$g4_hh_average_income_source_k_income_other) # What percentage of your income comes from this activity?
# #unique(merged_hhs$g4_hh_average_income_source_k_other_source) #Specify

# Define your 11 income % columns (a–k)
income_cols <- c(
  "g4_hh_average_income_source_a_income_farming",
  "g4_hh_average_income_source_b_income_harvesting",
  "g4_hh_average_income_source_c_income_fishing_artisanal",
  "g4_hh_average_income_source_d_income_fishing_aquaculture",
  "g4_hh_average_income_source_e_income_buying_trading",
  "g4_hh_average_income_source_f_income_processing",
  "g4_hh_average_income_source_g_income_extraction",
  "g4_hh_average_income_source_h_income_tourism",
  "g4_hh_average_income_source_i_income_other_wage",
  "g4_hh_average_income_source_j_income_industrial",
  "g4_hh_average_income_source_k_income_other"
)

income_labels <- c(
  "Farming", "Forest Harvesting", "Artisanal Fishing", "Aquaculture", "Fish Trading",
  "Fish Processing", "Non-renewable Extraction", "Marine Tourism", "Other Wage Labor",
  "Industrial Fishing", "Other"
)

# -- Top Plot: Any Response or All Missing --
df_response_status <- merged_hhs %>%
  mutate(income_data_present = if_any(all_of(income_cols), ~ !is.na(.))) %>%
  mutate(response_status = ifelse(income_data_present, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_response_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# -- Bottom Plot: Total Contribution by Source (stacked) --
df_income_long <- merged_hhs %>%
  select(all_of(income_cols)) %>%
  mutate(across(everything(), as.numeric)) %>%
  filter(if_any(everything(), ~ !is.na(.))) %>%  # keep rows with at least one value
  pivot_longer(everything(), names_to = "source", values_to = "income_pct") %>%
  mutate(source = recode(source, !!!setNames(income_labels, income_cols))) %>%
  group_by(source) %>%
  summarise(total_pct = sum(income_pct, na.rm = TRUE)) %>%
  mutate(prop = total_pct / sum(total_pct))
# Reorder source factor by descending proportion
df_income_long <- df_income_long %>%
  arrange(desc(prop)) %>%
  mutate(
    source = factor(source, levels = source),
    label = paste0(source, " (", percent(prop, accuracy = 1), ")")
  )

# Define named vector for color matching to keep consistent colors
source_colors <- setNames(RColorBrewer::brewer.pal(n = nrow(df_income_long), name = "Paired"), df_income_long$source)

# Create vertical bar plot with sorted bars and legend
p2 <- ggplot(df_income_long, aes(x = source, y = prop, fill = source)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            vjust = -0.3, size = 3.5, color = "black") +
  scale_y_continuous(labels = percent_format(), expand = expansion(mult = c(0, 0.1))) +
  scale_fill_manual(
    values = source_colors,
    labels = df_income_long$label
  ) +
  labs(
    title = "Total Income Share by Source",
    x = "Source",
    y = "Proportion of Reported Income Sources",
    fill = "Income Source"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


# -- Combine Both Plots --
plot10 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Household Income Sources",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )







 
##############################################################



#Compared to five years ago, the current fish catch has ...
# unique(merged_hhs$g5_catch_current_vs_past)

plot11 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g5_catch_current_vs_past,
  title = "Compared to five years ago, the current fish catch has...",
  color_mapping = c(
    "Improved heavily" = "#6baed6",
    "Improved slightly" = "#9ecae1",
    "Stayed the same" = "#d9d9d9",
    "Declined slightly" = "#fcae91",
    "Declined a lot" = "#fb6a4a"
  )
)





 
##############################################################



#In the next five years, how do you think fish catches will compare to today?
# unique(merged_hhs$g5_catch_future_vs_current)

plot12 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g5_catch_future_vs_current,
  title = "In the next five years, how do you think fish catches will compare to today?",
  color_mapping = c(
    "Improves heavily" = "#6baed6",
    "Improves slightly" = "#9ecae1",
    "Stays the same" = "#d9d9d9",
    "Declines slightly" = "#fcae91",
    "Declines a lot" = "#fb6a4a"
  )
)







 
##############################################################




#Are you sure that your job as a fisherman is safe in the future?
# unique(merged_hhs$g5_fisher_job_secure)

plot13 <-plot_response_distribution(
  data = merged_hhs,
  question_col = g5_fisher_job_secure,
  title = "Are you sure that your job as a fisherman is safe in the future?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)





 
##############################################################




# #How many members of the household regularly go fishing?
# unique(merged_hhs$g5_fishing_children) #How many members of the household regularly go fishing? - c) Children (<17 years, male and female)
# unique(merged_hhs$g5_fishing_men) #How many members of the household regularly go fishing? - a) Adult male
# unique(merged_hhs$g5_fishing_women) #How many members of the household regularly go fishing? - b) Adult female

# --- Identify true NA rows ---
merged_hhs <- merged_hhs %>%
  mutate(
    fishing_response_status = case_when(
      is.na(g5_fishing_children) & is.na(g5_fishing_men) & is.na(g5_fishing_women) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Top plot: Answered vs Missing ---
merged_hhs <- merged_hhs %>%
  mutate(
    fishing_response_status = case_when(
      is.na(g5_fishing_children) & is.na(g5_fishing_men) & is.na(g5_fishing_women) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

df_top <- merged_hhs %>%
  count(fishing_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = fishing_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Total number of fishers per group (and their proportions) ---
df_total <- merged_hhs %>%
  mutate(across(c(g5_fishing_children, g5_fishing_men, g5_fishing_women), as.numeric)) %>%
  filter(!(is.na(g5_fishing_children) & is.na(g5_fishing_men) & is.na(g5_fishing_women))) %>%
  summarise(
    `Adult Male` = sum(g5_fishing_men, na.rm = TRUE),
    `Adult Female` = sum(g5_fishing_women, na.rm = TRUE),
    Children = sum(g5_fishing_children, na.rm = TRUE)
  ) %>%
  pivot_longer(everything(), names_to = "Group", values_to = "Count") %>%
  mutate(Percent = Count / sum(Count))

# Custom color mapping
group_colors <- c(
  "Adult Male" = "#6baed6",
  "Adult Female" = "#fb6a4a",
  "Children" = "#74c476"
)

# Bottom plot with custom colors
p2 <- ggplot(df_total, aes(x = fct_reorder(Group, Count), y = Count, fill = Group)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  geom_text(aes(label = paste0(Count, " (", percent(Percent, accuracy = 1), ")")),
            hjust = -0.1, size = 4.5) +
  scale_fill_manual(values = group_colors) +
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Total Number of Household Members Who Regularly Go Fishing",
    x = "",
    y = "Total Count"
  ) +
  theme_minimal()

# --- Combine ---
plot14 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "How many members of the household regularly go fishing?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )






 
##############################################################



#How often do the main fishermen go out to sea in good seasons (both weather and fish) to catch fish?
# unique(merged_hhs$g5_freq_fishing_high_profit)

plot15 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g5_freq_fishing_high_profit,
  title = "How often do the main fishermen go out to sea in good seasons (both weather and fish) to catch fish?",
  color_mapping = c(
    "More than 1-2 times per week" = "#6baed6",
    "1-2 per week" = "#9ecae1",
    "A few times per month" = "#d9d9d9",
    "A few times" = "#fcae91",
    "Once or never" = "#fb6a4a"
  )
)








 
##############################################################




#How often do the main fishermen go out to sea during bad seasons (both weather and fish) to catch fish?
# unique(merged_hhs$g5_freq_fishing_low_profit)

plot16 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g5_freq_fishing_low_profit,
  title = "How often do the main fishermen go out to sea during bad seasons (both weather and fish) to catch fish?",
  color_mapping = c(
    "More than 1-2 times per week" = "#6baed6",
    "1-2 per week" = "#9ecae1",
    "A few times per month" = "#d9d9d9",
    "A few times" = "#fcae91",
    "Once or never" = "#fb6a4a"
  )
)






 
##############################################################



# # In the last 12 months, what fishing gears were used by the household?
# unique(merged_hhs$g5_gear_explosives) # In the last 12 months, what fishing gears were used by the household? - g) Explosives or chemicals (e.g. bombs, cyanide, poison)
# unique(merged_hhs$g5_gear_fixed_net) # In the last 12 months, what fishing gears were used by the household? - b) Fixed net fishing (e.g. traps, gill nets, trammel nets)
# unique(merged_hhs$g5_gear_hand) # In the last 12 months, what fishing gears were used by the household? - b) Fishing by hand or handheld gear (e.g. gleaning, hand line, spear gun)
# unique(merged_hhs$g5_gear_long_line) # In the last 12 months, what fishing gears were used by the household? - e) Bottom fishing (e.g. longline)
# unique(merged_hhs$g5_gear_mobile_line) # In the last 12 months, what fishing gears were used by the household? - f) Moving fishing rods (e.g. trolling rods)
# unique(merged_hhs$g5_gear_mobile_net) # In the last 12 months, what fishing gears were used by the household? - d) Movable fishing gear (e.g. trawls, purse seines, beach trawls, huhate)
# unique(merged_hhs$g5_gear_other) # In the last 12 months, what fishing gears were used by the household? - h) Others
# unique(merged_hhs$g5_gear_stationary_line) # In the last 12 months, what fishing gears were used by the household? - d) Fishing with stationary line (e.g. long line)
# unique(merged_hhs$g5_gear_stationary_net) # In the last 12 months, what fishing gears were used by the household? - c) Non-moving/stationary fishing gear (e.g. traps, gill nets, multi-layer gill nets)
# unique(merged_hhs$g5_gear_traditional) # In the last 12 months, what fishing gears were used by the household? - a) Local traditional fishing tools (for example: coconut leaves)
# unique(merged_hhs$g5_gear_no_fishing_12_months)  # In the last 12 months, what fishing gears were used by the household? - h) No fishing in the last 12 months
# #unique(merged_hhs$g5_gear_other_specify) #Specify # In the last 12 months, what fishing gears were used by the household? - h) Other (please specify)


# Gear columns
gear_cols <- c(
  "g5_gear_explosives",
  "g5_gear_fixed_net",
  "g5_gear_hand",
  "g5_gear_long_line",
  "g5_gear_mobile_line",
  "g5_gear_mobile_net",
  "g5_gear_other",
  "g5_gear_stationary_line",
  "g5_gear_stationary_net",
  "g5_gear_traditional",
  "g5_gear_no_fishing_12_months"
)

# --- Top plot: Response status ---
merged_hhs <- merged_hhs %>%
  mutate(gear_response_status = ifelse(rowSums(!is.na(across(all_of(gear_cols)))) > 0, "Answered", "Missing"))

df_gear_status <- merged_hhs %>%
  count(gear_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_gear_status, aes(x = "", y = n, fill = gear_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Count and proportion of households that used each gear ---
df_gear_usage <- merged_hhs %>%
  filter(gear_response_status == "Answered") %>%
  summarise(across(all_of(gear_cols), ~ sum(. == "Yes", na.rm = TRUE))) %>%
  pivot_longer(everything(), names_to = "Gear", values_to = "Count") %>%
  mutate(
    Gear = str_remove(Gear, "g5_gear_"),
    Gear = str_replace_all(Gear, "_", " "),
    Gear = str_to_title(Gear),
    Proportion = Count / sum(Count),
    label = paste0(Count, " (", percent(Proportion, accuracy = 1), ")"),
    Gear = fct_reorder(Gear, Count)
  )

p2 <- ggplot(df_gear_usage, aes(x = Count, y = Gear)) +
  geom_col(fill = "#1f78b4") +
  geom_text(aes(label = label), hjust = -0.1, size = 3.5) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Fishing Gear Used in the Last 12 Months",
    x = "Households Reporting 'Yes'",
    y = NULL
  ) +
  theme_minimal()

# --- Combine ---
plot17 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "In the last 12 months, what fishing gears were used by the household?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )







 
##############################################################



#Consider the main fisher in the household. Does this person fish…?
# unique(merged_hhs$g5_hh_fisher_main)
# unique(merged_hhs$g5_hh_fisher_other) #Specify


plot18 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g5_hh_fisher_main,
  title = "Consider the main fisher in the household. Does this person fish…?",
  color_mapping = c(
    "Independently or with other family or community members" = "#6baed6",
    "As the owner of an enterprise, with hired laborers" = "#9ecae1",
    "Other [specify]" = "#d9d9d9",
    "As a member of a (producer) group or cooperative, non-salaried" = "#fcae91",
    "As a salaried laborer working for an enterprise" = "#fb6a4a"
  )
)







 
##############################################################


# # How many members of the household regularly participate in post-processing activities to prepare the fish for sale?
# unique(merged_hhs$g5_processing_children) # How many members of the household regularly participate in post-processing activities to prepare the fish for sale? - c) Children (<17 years, male and female)
# unique(merged_hhs$g5_processing_men) # How many members of the household regularly participate in post-processing activities to prepare the fish for sale? - a) Adult male
# unique(merged_hhs$g5_processing_women) # How many members of the household regularly participate in post-processing activities to prepare the fish for sale? - b) Adult female

# --- Identify true NA rows for post-processing ---
merged_hhs <- merged_hhs %>%
  mutate(
    processing_response_status = case_when(
      is.na(g5_processing_children) & is.na(g5_processing_men) & is.na(g5_processing_women) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Top plot: Answered vs Missing ---
df_top <- merged_hhs %>%
  count(processing_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = processing_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Total number of processors per group (and their proportions) ---
df_total <- merged_hhs %>%
  mutate(across(c(g5_processing_children, g5_processing_men, g5_processing_women), as.numeric)) %>%
  filter(!(is.na(g5_processing_children) & is.na(g5_processing_men) & is.na(g5_processing_women))) %>%
  summarise(
    `Adult Male` = sum(g5_processing_men, na.rm = TRUE),
    `Adult Female` = sum(g5_processing_women, na.rm = TRUE),
    Children = sum(g5_processing_children, na.rm = TRUE)
  ) %>%
  pivot_longer(everything(), names_to = "Group", values_to = "Count") %>%
  mutate(Percent = Count / sum(Count))

# Color mapping
group_colors <- c(
  "Adult Male" = "#6baed6",
  "Adult Female" = "#fb6a4a",
  "Children" = "#74c476"
)

# Bottom plot
p2 <- ggplot(df_total, aes(x = fct_reorder(Group, Count), y = Count, fill = Group)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  geom_text(aes(label = paste0(Count, " (", percent(Percent, accuracy = 1), ")")),
            hjust = -0.1, size = 4.5) +
  scale_fill_manual(values = group_colors) +
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Total Number of Household Members Who Participate in Post-processing",
    x = "",
    y = "Total Count"
  ) +
  theme_minimal()

# --- Combine ---
plot19 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "How many members of the household regularly participate in post-processing activities to prepare the fish for sale?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )







 
##############################################################



#Please indicate the number of the following items that are owned in the previous 12 months by the household. If the item is not owned, please additionally indicate whether you would consider the item of value (yes/no) - d) Phone (mobile or landline)
# unique(merged_hhs$g6_item_phone_no)







 
##############################################################



# # Is affordable insurance available to you?
# unique(merged_hhs$g7_affordable_insurance)
# unique(merged_hhs$g7_affordable_insurance_beneficial) # Is affordable insurance available to you? - If yes, do you believe the insurance policies available are beneficial?

plot20 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g7_affordable_insurance,
  title = "Is affordable insurance available to you?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a",
    "I don't know" = "#d9d9d9"
  )
)





 
##############################################################




#What is the average loan amount you have received in the last 5 years?
# unique(merged_hhs$g7_average_loan)

# --- Convert and classify ---
merged_hhs <- merged_hhs %>%
  mutate(
    g7_average_loan_num = as.numeric(g7_average_loan),
    loan_response_status = case_when(
      is.na(g7_average_loan_num) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Top plot: Response status ---
df_top <- merged_hhs %>%
  count(loan_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = loan_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Remove only 0s, keep full range (no top 1% cut) ---
loan_cleaned <- merged_hhs %>%
  filter(!is.na(g7_average_loan_num),
         g7_average_loan_num > 0,
         !is.na(year), !is.na(g1_country))

# --- Compute median and IQR ---
loan_summary <- loan_cleaned %>%
  group_by(g1_country, year) %>%
  summarise(
    median_loan = median(g7_average_loan_num, na.rm = TRUE),
    iqr_lower = quantile(g7_average_loan_num, 0.25, na.rm = TRUE),
    iqr_upper = quantile(g7_average_loan_num, 0.75, na.rm = TRUE),
    .groups = "drop"
  )

# --- Bottom plot: Median + IQR ---
p2 <- ggplot(loan_summary, aes(x = factor(year), y = median_loan, group = g1_country)) +
  geom_line(color = "#6baed6", size = 1) +
  geom_point(color = "black", size = 2) +
  geom_errorbar(
    aes(ymin = pmax(iqr_lower, 0), ymax = iqr_upper),
    width = 0.2,
    color = "black"
  ) +
  facet_wrap(~ g1_country, scales = "free_y") +
  labs(
    title = "Trend of Median Loan Amount by Year and Country (with IQR)",
    x = "Year",
    y = "Median Loan Amount"
  ) +
  scale_y_continuous(labels = comma_format(scale = 1)) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Combine plots ---
plot21 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "What is the average loan amount you have received in the last 5 years?",
    caption = "Note: Observations with loan amount = 0 were removed. Plot shows median loan per year with IQR (25th–75th percentile).",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )








 
##############################################################




#Does your household take out loans from a financial institution?
# unique(merged_hhs$g7_loan_bank) # Does your household take out loans from a financial institution? - a) Bank
# unique(merged_hhs$g7_loan_buyer) # Does your household take out loans from a financial institution? - b) Buyer
# unique(merged_hhs$g7_loan_other_nonbank) # Does your household take out loans from a financial institution? - c) Other Non-Bank


# --- Select and rename the relevant columns ---
df_loans <- merged_hhs %>%
  select(
    Bank = g7_loan_bank,
    Buyer = g7_loan_buyer,
    `Other Non-Bank` = g7_loan_other_nonbank
  )

# --- Top plot: Answered vs Missing (all 3 sources NA) ---
df_status <- df_loans %>%
  mutate(
    response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")
  ) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Yes vs No (exclude NA per cell) ---
df_long <- df_loans %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Source", values_to = "value") %>%
  filter(!is.na(value)) %>%
  mutate(
    response = if_else(value == "Yes", "Yes", "No")
  ) %>%
  count(Source, response) %>%
  group_by(Source) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()

p2 <- ggplot(df_long, aes(x = Source, y = n, fill = response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 4) +
  scale_fill_manual(values = c("Yes" = "#6baed6", "No" = "#fb6a4a")) +
  coord_flip() +
  labs(
    title = "Households Taking Loans by Source",
    x = NULL,
    y = "Proportion",
    fill = NULL
  ) +
  theme_minimal()

# --- Combine both ---
plot22 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Does your household take out loans from a financial institution?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )










 
##############################################################



# Are you currently saving part of your income?
# unique(merged_hhs$g7_save_monthly_income)

plot23 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g7_save_monthly_income,
  title = "Are you currently saving part of your income?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)






 
##############################################################



# Are you or a member of your household a member of a savings club?
# unique(merged_hhs$g7_savings_club_member)


plot24 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g7_savings_club_member,
  title = "Are you or a member of your household a member of a savings club?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)







 
##############################################################




# Do you or any member of your household run a business? (including fishing, processing, buying and selling fish, either as a side business or a full-time business)?
# unique(merged_hhs$g7_small_business)

plot25 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g7_small_business,
  title = "Do you or any member of your household run a business?",
  color_mapping = c(
    "Yes, the business is registered" = "#6baed6",
    "Yes, the business is not registered" = "#d9d9d9",
    "No" = "#fb6a4a"
  )
)







 
##############################################################



#Do you think that the benefits you get from fishery resources are the same/equivalent to those of other community members in your area (who also utilize fishery resources)?
# unique(merged_hhs$g8_fishery_benefit_equal)

 plot26 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g8_fishery_benefit_equal,
  title = "Do you think that the benefits you get from fishery resources are the same/equivalent to those of other community members in your area (who also utilize fishery resources)?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a",
    "I don’t depend on or benefit from the fishery" = "#d9d9d9"
  )
)








 
##############################################################


#How much do you agree or disagree with the following statement? “My community has the ability to manage my fishery effectively and to maximize food and profits?”
# unique(merged_hhs$g8_my_community_ability)

 plot27 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g8_my_community_ability,
  title = "How much do you agree or disagree with the following statement? 'My community has the ability to manage my fishery effectively and to maximize food and profits?'",
  color_mapping = c(
    "Strongly agree" = "#6baed6",
    "Agree" = "#9ecae1",
    "Neither agree nor disagree" = "#d9d9d9",
    "Disagree" = "#fcae91",
    "Strongly disagree" = "#fb6a4a"
  )
)







 
##############################################################




# #Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree
# unique(merged_hhs$g8_trust_local_decision) # Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree - a) Decision makers at the village/state level can be trusted to make decisions regarding coastal and fisheries management that benefit the community, and not for their own interests
# unique(merged_hhs$g8_trust_regional_decision)# Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree - b) Decision makers at district and provincial levels can be trusted to make decisions regarding coastal and fisheries management that benefit the community and not for their own interests
# unique(merged_hhs$g8_trust_community) # Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree - c) In general, most people in my area can be trusted to comply with regulations related to coastal fisheries and fisheries management
# unique(merged_hhs$g8_trust_community_neighbors) # Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree - d) In general, most communities in neighboring areas can be trusted to comply with regulations related to coastal and fisheries management
# unique(merged_hhs$g8_trust_community_emergency) # Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree - e) My local community will support me with funds and assistance in the event of a small-scale emergency (illness, disaster, including accidents or disasters that occur at sea)
# unique(merged_hhs$g8_trust_community_rebuilt) # Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree - f) With the help of community members, the village/country environment can be rebuilt after a large-scale emergency (epidemic/pandemic, natural disaster)


# Define columns in desired order
columns <- c(
  `a) Local Decision Makers` = "g8_trust_local_decision",
  `b) Regional Decision Makers` = "g8_trust_regional_decision",
  `c) Community Compliance` = "g8_trust_community",
  `d) Neighboring Communities` = "g8_trust_community_neighbors",
  `e) Emergency Support` = "g8_trust_community_emergency",
  `f) Post-Emergency Recovery` = "g8_trust_community_rebuilt"
)

# Color mapping
color_mapping <- c(
  "Strongly agree" = "#6baed6",
  "Agree" = "#9ecae1",
  "Neither agree nor disagree" = "#d9d9d9",
  "Disagree" = "#fcae91",
  "Strongly disagree" = "#fb6a4a"
)

# Prepare data
df_trust <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# Top plot: Answered vs Missing
df_status <- df_trust %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# Bottom plot: Trust distribution
df_long <- df_trust %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = names(columns)),  # Order categories
    Response = factor(Response, levels = names(color_mapping))  # Order responses
  )

df_long <- df_long %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),  # reversed here
    Response = factor(Response, levels = names(color_mapping))
  )

# Re-plot the bottom chart
p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# Combine
 plot28 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Please rate your agreement with the following statement on a scale from strongly disagree to strongly agree*",
    caption = "* a) Local Decision Makers: Decision makers at the village/state level can be trusted to make decisions regarding coastal and fisheries management that benefit the community, and not for their own interests\n" %>%
              paste(" b) Regional Decision Makers: Decision makers at district and provincial levels can be trusted to make decisions regarding coastal and fisheries management that benefit the community and not for their own interests\n") %>%
              paste(" c) Community Compliance: In general, most people in my area can be trusted to comply with regulations related to coastal fisheries and fisheries management\n") %>%
              paste(" d) Neighboring Communities: In general, most communities in neighboring areas can be trusted to comply with regulations related to coastal and fisheries management\n") %>%
              paste(" e) Emergency Support: My local community will support me with funds and assistance in the event of a small-scale emergency (illness, disaster, including accidents or disasters that occur at sea)\n") %>%
              paste(" f) Post-Emergency Recovery: With the help of community members, the village/country environment can be rebuilt after a large-scale emergency (epidemic/pandemic, natural disaster)"),
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )






 
##############################################################




# # Do you think there is any benefit to regulating fishing via a managed access area and a reserve area?
# unique(merged_hhs$g9_ma_benefits) 
# unique(merged_hhs$g9_ma_benefits_opinion) #Specify #Do you think there is any benefit to regulating fishing via a managed access area and a reserve area? - (If yes) What do you see as the single greatest benefit?

 plot29 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_ma_benefits,
  title = "Do you think there is any benefit to regulating fishing via a managed access area and a reserve area?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)



 
##############################################################




 
#Out of ten fishers in your community, how many would you guess know where the fisheries management/managed access boundary is?
# unique(merged_hhs$g9_ma_boundry_aware)

# --- Top plot: Missing vs Answered ---
df_response_status <- merged_hhs %>%
  mutate(response_status = if_else(is.na(g9_ma_boundry_aware), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_response_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Custom order with "No Managed Area" first ---
df_distribution <- merged_hhs %>%
  filter(!is.na(g9_ma_boundry_aware)) %>%
  mutate(boundary_awareness = if_else(
    g9_ma_boundry_aware == "Community does not have a managed area",
    "No Managed Area",
    g9_ma_boundry_aware
  )) %>%
  count(boundary_awareness) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    boundary_awareness = factor(boundary_awareness,
      levels = c("No Managed Area", as.character(0:10))
    )
  )

p2 <- ggplot(df_distribution, aes(x = boundary_awareness, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Guessed number of fishers aware (out of 10)",
    y = "Count"
  ) +
  theme_minimal()

# --- Combine plots ---
 plot30 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Out of ten fishers in your community, how many would you guess know where the fisheries management/managed access boundary is?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )
 
 


 
##############################################################



#Are you aware of any regulations at the local, regional and national levels regarding coastal resource conservation?
# unique(merged_hhs$g9_ma_familiar)

 plot31 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_ma_familiar,
  title = "Are you aware of any regulations at the local, regional and national levels regarding coastal resource conservation?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)
 



 
##############################################################



#Who is allowed to fish in the fisheries management/managed access area?
# unique(merged_hhs$g9_ma_fishers_allowed)


plot32 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_ma_fishers_allowed,
  title = "Who is allowed to fish in the fisheries management/managed access area?",
  color_mapping <- c(
  "Community members only" = "#6baed6",  # light blue → clearly allowed (trusted, known group)
  "Community members and members from neighboring community with authorization/permit" = "#9ecae1",  # medium blue → still controlled/authorized
  "Community members and members from neighboring community without authorization/permit" = "#fcae91",  # orange → less controlled, riskier
  "There are no access restrictions" = "#fb6a4a",  # red → fully open, potentially problematic
  "Community does not have a managed area" = "#bdbdbd",  # gray → absence of management
  "Do not know" = "#d9d9d9"  # light gray → lack of knowledge
)
)




 
##############################################################



# #Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? 
# unique(merged_hhs$g9_ma_gear_barrier) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - o) Sero (Barrier, Fences, Weirs)
# unique(merged_hhs$g9_ma_gear_braceamento) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Braceamento
# unique(merged_hhs$g9_ma_gear_cast_net) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - s) Boat Cast Net
# unique(merged_hhs$g9_ma_gear_corral) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Corral
# unique(merged_hhs$g9_ma_gear_dynamite) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - ) Bom (Dynamite)
# unique(merged_hhs$g9_ma_gear_estacada) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Estacada
# unique(merged_hhs$g9_ma_gear_gamboa) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Gamboa
# unique(merged_hhs$g9_ma_gear_gancho) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Gancho
# unique(merged_hhs$g9_ma_gear_gillnet) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - d) Gillnet
# unique(merged_hhs$g9_ma_gear_gleaning) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - r) Bameti (Gleaning)
# unique(merged_hhs$g9_ma_gear_handline) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - b) Snake Hook
# unique(merged_hhs$g9_ma_gear_harpoon) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - p) Kalawai (3-pronged spear)
# unique(merged_hhs$g9_ma_gear_hookline) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - a) Pancing (Hook & Line)
# unique(merged_hhs$g9_ma_gear_liftnet) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - e) Bagan (Lift Net)
# unique(merged_hhs$g9_ma_gear_longline) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - c) Longline
# unique(merged_hhs$g9_ma_gear_loop) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Loop
# unique(merged_hhs$g9_ma_gear_matapi) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Matapi
# unique(merged_hhs$g9_ma_gear_mesh) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Mesh
# unique(merged_hhs$g9_ma_gear_mosquito) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - ) Mosquito Wire
# unique(merged_hhs$g9_ma_gear_multiple_pole_and_lines) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - d) Huhate
# unique(merged_hhs$g9_ma_gear_nets) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Nets
# unique(merged_hhs$g9_ma_gear_poison) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - m) Poison/Anaesthesia (Cyanide/Poison)
# unique(merged_hhs$g9_ma_gear_pot) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - n) Bubu (Pot)
# unique(merged_hhs$g9_ma_gear_purse_seine) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - f) Circle Net
# unique(merged_hhs$g9_ma_gear_quinia) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Quinia
# unique(merged_hhs$g9_ma_gear_rag) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Rag
# unique(merged_hhs$g9_ma_gear_seine) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - h) Seine Net
# unique(merged_hhs$g9_ma_gear_siru) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - k) Siru-siru
# unique(merged_hhs$g9_ma_gear_speargun) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - q) Arrow (Speargun)
# unique(merged_hhs$g9_ma_gear_surround)# Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - ) Surrounding Net
# unique(merged_hhs$g9_ma_gear_trap) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Trap
# unique(merged_hhs$g9_ma_gear_trawl) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - g) Pucked Hela (Trawl/Drag Nets)
# unique(merged_hhs$g9_ma_gear_other) # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - t) Others
# #unique(merged_hhs$g9_ma_gear_other_specify) #Specify # Are there restrictions on the type of gear that may be used in the fisheries management/managed access area? - Other (please specify)


# --- Define gear columns and readable labels ---
gear_columns <- c(
  "Barrier (Sero)" = "g9_ma_gear_barrier",
  "Braceamento" = "g9_ma_gear_braceamento",
  "Boat Cast Net" = "g9_ma_gear_cast_net",
  "Corral" = "g9_ma_gear_corral",
  "Dynamite (Bom)" = "g9_ma_gear_dynamite",
  "Estacada" = "g9_ma_gear_estacada",
  "Gamboa" = "g9_ma_gear_gamboa",
  "Gancho" = "g9_ma_gear_gancho",
  "Gillnet" = "g9_ma_gear_gillnet",
  "Gleaning (Bameti)" = "g9_ma_gear_gleaning",
  "Handline (Snake Hook)" = "g9_ma_gear_handline",
  "Harpoon (Kalawai)" = "g9_ma_gear_harpoon",
  "Hook & Line (Pancing)" = "g9_ma_gear_hookline",
  "Lift Net (Bagan)" = "g9_ma_gear_liftnet",
  "Longline" = "g9_ma_gear_longline",
  "Loop" = "g9_ma_gear_loop",
  "Matapi" = "g9_ma_gear_matapi",
  "Mesh" = "g9_ma_gear_mesh",
  "Mosquito Wire" = "g9_ma_gear_mosquito",
  "Multiple Pole & Lines (Huhate)" = "g9_ma_gear_multiple_pole_and_lines",
  "Nets" = "g9_ma_gear_nets",
  "Poison (Cyanide)" = "g9_ma_gear_poison",
  "Pot (Bubu)" = "g9_ma_gear_pot",
  "Purse Seine (Circle Net)" = "g9_ma_gear_purse_seine",
  "Quinia" = "g9_ma_gear_quinia",
  "Rag" = "g9_ma_gear_rag",
  "Seine Net" = "g9_ma_gear_seine",
  "Siru-siru" = "g9_ma_gear_siru",
  "Speargun (Arrow)" = "g9_ma_gear_speargun",
  "Surrounding Net" = "g9_ma_gear_surround",
  "Trap" = "g9_ma_gear_trap",
  "Trawl (Pucked Hela)" = "g9_ma_gear_trawl",
  "Others" = "g9_ma_gear_other"
)

# --- Top plot: Answered vs Missing ---
df_status <- merged_hhs %>%
  select(all_of(gear_columns)) %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Proportions of restriction types ---
df_long <- merged_hhs %>%
  select(all_of(gear_columns)) %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  rename_with(~ names(gear_columns), everything()) %>%
  pivot_longer(cols = everything(), names_to = "Gear", values_to = "value") %>%
  filter(!is.na(value)) %>%
  count(Gear, value) %>%
  group_by(Gear) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()

color_mapping <- c(
  "Permitted" = "#6baed6",
  "Don’t know" = "#d9d9d9",
  "Not permitted" = "#fb6a4a"
)

p2 <- ggplot(df_long, aes(x = fct_reorder(Gear, -prop), y = prop, fill = value)) +
  geom_col(position = "stack", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_stack(vjust = 0.5),
            size = 3.5, color = "black") +
  scale_fill_manual(values = color_mapping) +
  coord_flip() +
  labs(
    title = "Gear Restrictions in Managed Access Areas",
    x = NULL,
    y = "Proportion",
    fill = "Response"
  ) +
  theme_minimal()

# --- Combine ---
plot33 <- (p1 / p2) +
  plot_layout(heights = c(1, 3)) +
  plot_annotation(
    title = "Are there restrictions on the type of gear used in the managed access area?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )
 
 
 

 
##############################################################



#Out of ten fishers in your community, how many would you guess know where the reserve boundary is?
# unique(merged_hhs$g9_reserve_boundry_aware)

# --- Top plot: Missing vs Answered ---
df_response_status <- merged_hhs %>%
  mutate(response_status = if_else(is.na(g9_reserve_boundry_aware), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_response_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Custom order with "No Reserve Area" first ---
df_distribution <- merged_hhs %>%
  filter(!is.na(g9_reserve_boundry_aware)) %>%
  mutate(reserve_awareness = if_else(
    g9_reserve_boundry_aware == "Community does not have reserves",
    "No Reserve Area",
    g9_reserve_boundry_aware
  )) %>%
  count(reserve_awareness) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    reserve_awareness = factor(reserve_awareness,
      levels = c("No Reserve Area", as.character(0:10))
    )
  )

p2 <- ggplot(df_distribution, aes(x = reserve_awareness, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Guessed number of fishers aware (out of 10)",
    y = "Count"
  ) +
  theme_minimal()

# --- Combine plots ---
plot34 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Out of ten fishers in your community, how many would you guess know where the reserve boundary is?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )

 
 
 

 
##############################################################



#Do you know where the boundary of the reserve is?
# unique(merged_hhs$g9_reserve_boundry_knowledge)

plot35 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_reserve_boundry_knowledge,
  title = "Do you know where the boundary of the reserve is?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "Community does not have reserves" = "#d9d9d9",
    "No" = "#fb6a4a"
  )
)
 
 

 
##############################################################


#Is fishing allowed in the reserve area?       
# unique(merged_hhs$g9_reserve_fishing_allowed)

plot36 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_reserve_fishing_allowed,
  title = "Is fishing allowed in the reserve area?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "Community does not have reserves" = "#d9d9d9",
    "No" = "#fb6a4a"
  )
)





 

 
##############################################################




# Please consider a type of fish that you catch frequently. For this type of fish, what are the size restrictions? - Ability of respondent to recite maximum size
# unique(merged_hhs$g9_restrictions_ability_max_size)

plot37 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_reserve_fishing_allowed,
  title = "Please consider a type of fish that you catch frequently. For this type of fish, what are the size restrictions? - Ability of respondent to recite maximum size",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)



 

 
##############################################################



# Please consider a type of fish that you catch frequently. For this type of fish, what are the size restrictions? - Ability of respondent to recite minimum size
# unique(merged_hhs$g9_restrictions_ability_min_size)

plot38 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g9_restrictions_ability_min_size,
  title = "Please consider a type of fish that you catch frequently. For this type of fish, what are the size restrictions? - Ability of respondent to recite minimum size",
  color_mapping = c(
    "Yes" = "#6baed6",
    "No" = "#fb6a4a"
  )
)


 

 
##############################################################


#How often did household members attend the fisheries management body meetings in the last 12 months?
# unique(merged_hhs$g10_attend_meeting_female) # How often did household members attend the fisheries management body meetings in the last 12 months? - b) Women
# unique(merged_hhs$g10_attend_meeting_male) # How often did household members attend the fisheries management body meetings in the last 12 months? - a) Male
# unique(merged_hhs$g10_attend_meeting_nonbinary) # How often did household members attend the fisheries management body meetings in the last 12 months? - c) Non-binary

# --- Define ordered columns ---
columns <- c(
  `Male` = "g10_attend_meeting_male",
  `Female` = "g10_attend_meeting_female",
  `Non-binary` = "g10_attend_meeting_nonbinary"
)

# --- Color mapping for frequency responses ---
color_mapping <- c(
  "Always" = "#6baed6",
  "Regularly" = "#9ecae1",
  "Sometimes" = "#d9d9d9",
  "Rarely" = "#fcae91",
  "Never" = "#fb6a4a"
)


# --- Prepare data ---
df_attendance <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- Top plot: Answered vs Missing ---
df_status <- df_attendance %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Attendance distribution ---
df_long <- df_attendance %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),  # reverse order for y-axis
    Response = factor(Response, levels = names(color_mapping))  # enforce order of responses
  )

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# --- Combine ---
plot39 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "How often did household members attend the fisheries management body meetings in the last 12 months?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )


 

 
##############################################################


# #Do you know how these actions affect the fishery?
# unique(merged_hhs$g10_benefits_comply_knowledge_fishing_permission) # Do you know how these actions affect the fishery? - b) Only catch in areas where fishing is permitted (Fishing Subzone/Fishing Area Access Management)
# unique(merged_hhs$g10_benefits_comply_knowledge_gear) # Do you know how these actions affect the fishery? - c) Restrictions on fishing gear
# unique(merged_hhs$g10_benefits_comply_knowledge_licensing) # Do you know how these actions affect the fishery? - a) Resource User Registration
# unique(merged_hhs$g10_benefits_comply_knowledge_min_fish_size) # Do you know how these actions affect the fishery? - e) Minimum size of fish that can be caught
# unique(merged_hhs$g10_benefits_comply_knowledge_reserve_restrict) # Do you know how these actions affect the fishery? - d) Fishing inside the reserve
# unique(merged_hhs$g10_benefits_comply_knowledge_other) # Do you know how these actions affect the fishery? - f) Others
# #unique(merged_hhs$g10_benefits_comply_knowledge_other_specify) #Specify # Do you know how these actions affect the fishery? - Other (specify)

# --- 1. Define columns and labels ---
columns <- c(
  `a) Fishing in Permitted Areas` = "g10_benefits_comply_knowledge_fishing_permission",
  `b) Gear Restrictions` = "g10_benefits_comply_knowledge_gear",
  `c) Licensing` = "g10_benefits_comply_knowledge_licensing",
  `d) Fishing in Reserve` = "g10_benefits_comply_knowledge_reserve_restrict",
  `e) Minimum Fish Size` = "g10_benefits_comply_knowledge_min_fish_size",
  `f) Other` = "g10_benefits_comply_knowledge_other"
)

# --- 2. Color mapping ---
color_mapping <- c(
  "Yes" = "#6baed6",
  "No" = "#fb6a4a"
)

# --- 3. Prepare data ---
df_knowledge <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- 4. Top plot: Answered vs Missing ---
df_status <- df_knowledge %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- 5. Bottom plot: Proportional distribution of responses ---
df_long <- df_knowledge %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),
    Response = factor(Response, levels = names(color_mapping))
  )

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# --- 6. Combine plots ---
plot40 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Do you know how these actions affect the fishery?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )


 

 
##############################################################




# # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions?
# unique(merged_hhs$g10_benefits_comply_agreement_fishing_permission) # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions? - Fishing in managed access area only with permission
# unique(merged_hhs$g10_benefits_comply_agreement_gear) # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions? - Gear restrictions
# unique(merged_hhs$g10_benefits_comply_agreement_licensing) # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions?- Registration/Licensing
# unique(merged_hhs$g10_benefits_comply_agreement_min_fish_size) # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions?- Minimum fish size
# unique(merged_hhs$g10_benefits_comply_agreement_no_fishing) # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions? - No fishing in reserves
# unique(merged_hhs$g10_benefits_comply_agreement_other) # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions?- Other
# #unique(merged_hhs$g10_benefits_comply_agreement_other_specify) #Specify # Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions? - Other (specify)



# --- 1. Define columns and labels ---
columns <- c(
  `a) Fishing in Permitted Areas` = "g10_benefits_comply_agreement_fishing_permission",
  `b) Gear Restrictions` = "g10_benefits_comply_agreement_gear",
  `c) Licensing` = "g10_benefits_comply_agreement_licensing",
  `d) No Fishing in Reserves` = "g10_benefits_comply_agreement_no_fishing",
  `e) Minimum Fish Size` = "g10_benefits_comply_agreement_min_fish_size",
  `f) Other` = "g10_benefits_comply_agreement_other"
)

# --- 2. Color mapping ---
color_mapping <- c(
  "Strongly agree" = "#6baed6",
  "Agree" = "#9ecae1",
  "Neither agree nor disagree" = "#d9d9d9",
  "Disagree" = "#fcae91",
  "Strongly disagree" = "#fb6a4a"
)

# --- 3. Prepare data ---
df_agreement <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- 4. Top plot: Answered vs Missing ---
df_status <- df_agreement %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- 5. Bottom plot: Proportional distribution of responses ---
df_long <- df_agreement %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),
    Response = factor(Response, levels = names(color_mapping))
  )

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# --- 6. Combine plots ---
plot41 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Do you agree or disagree that the benefits from complying with the following rules outweigh the restrictions?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )



 

 
##############################################################


# # How difficult is it to comply with the following rules?
# unique(merged_hhs$g10_comply_rules_fishing_permission) # How difficult is it to comply with the following rules? - b) Only catch in areas where fishing is permitted (Fishing Subzone/Fishing Area Access Management)
# unique(merged_hhs$g10_comply_rules_gear) # How difficult is it to comply with the following rules? - c) Restrictions on fishing gear
# unique(merged_hhs$g10_comply_rules_licensing) # How difficult is it to comply with the following rules? - a) Resource user registration
# unique(merged_hhs$g10_comply_rules_min_fish) # How difficult is it to comply with the following rules? - e) Minimum fish size requirements
# unique(merged_hhs$g10_comply_rules_reserve_restrict) # How difficult is it to comply with the following rules? - d) Fishing is not allowed in areas where fishing is prohibited (Core Zone/Tourism Subzone/Rehabilitation Zone/Port Zone/Sasi Zone/No Take Area)
# unique(merged_hhs$g10_comply_rules_other) # How difficult is it to comply with the following rules? - e) Others
# #unique(merged_hhs$g10_comply_rules_other_specify) #Specify # How difficult is it to comply with the following rules? - Other (please specify)

# --- 1. Define columns and labels ---
columns <- c(
  `a) Fishing in Permitted Areas` = "g10_comply_rules_fishing_permission",
  `b) Gear Restrictions` = "g10_comply_rules_gear",
  `c) Licensing` = "g10_comply_rules_licensing",
  `d) No Fishing in Reserves` = "g10_comply_rules_reserve_restrict",
  `e) Minimum Fish Size` = "g10_comply_rules_min_fish",
  `f) Other` = "g10_comply_rules_other"
)

# --- 2. Color mapping for difficulty scale ---
color_mapping <- c(
  "Very easy" = "#6baed6",
  "Easy" = "#9ecae1",
  "Neutral" = "#d9d9d9",
  "Difficult" = "#fcae91",
  "Very difficult" = "#fb6a4a"
)

# --- 3. Prepare data ---
df_difficulty <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- 4. Top plot: Answered vs Missing ---
df_status <- df_difficulty %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- 5. Bottom plot: Proportional distribution of responses ---
df_long <- df_difficulty %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),
    Response = factor(Response, levels = names(color_mapping))
  )

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# --- 6. Combine plots ---
plot42 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "How difficult is it to comply with the following rules?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )



 

 
##############################################################



#How often do you encourage others (both inside and outside their local community) to comply with fishing regulations?
# unique(merged_hhs$g10_encourage_regulations)


plot43 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_encourage_regulations,
  title = "How often do you encourage others (both inside and outside their local community) to comply with fishing regulations?",
  color_mapping = c(
    "Very often" = "#6baed6",
    "Often" = "#9ecae1",
    "Sometimes" = "#d9d9d9",
    "Rarely" = "#fcae91",
    "Never" = "#fb6a4a",
    "Community does not have fishing regulations" = "#bdbdbd"
    
  )
)


 

 
##############################################################


# # Please respond to the following questions
# unique(merged_hhs$g10_enforcement_regulation_fishers_caught) # Please respond to the following questions. - e) Out of 10 fishers who fished in the reserve, how many would you guess get caught?
# unique(merged_hhs$g10_enforcement_regulation_fishers_gear_not_permitted) # Please respond to the following questions. - a) Out of 10 fishers in your community waters, how many would you guess use gear that is not permitted?
# unique(merged_hhs$g10_enforcement_regulation_fishers_ma_area) # Please respond to the following questions. - c) Out of 10 fishers in the managed access area, how many would you guess do not have permission to fish there?
# unique(merged_hhs$g10_enforcement_regulation_fishers_reserves) # Please respond to the following questions. - b) Out of 10 fishers in your community waters, how many would you guess fished in the reserve in the last month?
# unique(merged_hhs$g10_enforcement_regulation_fishers_reserves_caught) # Please respond to the following questions. - e) Out of 10 fishers who fished in the reserve, how many would you guess get caught?
# unique(merged_hhs$g10_enforcement_regulation_fishers_violate_fish_size) # Please respond to the following questions. - Out of 10 fishers in the managed access area, how many would you guess violated the size regulations?
# unique(merged_hhs$g10_enforcement_regulation_fishers_violate_fishing_rules) # Please respond to the following questions. - Out of 10 fishers in the managed access area, how many would you guess violated the size regulations?

# --- 1. Define columns and labels ---
columns <- c(
  `a) Use of Non-Permitted Gear` = "g10_enforcement_regulation_fishers_gear_not_permitted",
  `b) Fished in Reserve Last Month` = "g10_enforcement_regulation_fishers_reserves",
  `c) Fished Without Permission in MA` = "g10_enforcement_regulation_fishers_ma_area",
  `d) Violated Size Rules` = "g10_enforcement_regulation_fishers_violate_fish_size",
  `e) Violated Fishing Rules` = "g10_enforcement_regulation_fishers_violate_fishing_rules",
  `f) Caught Fishing in Reserve` = "g10_enforcement_regulation_fishers_reserves_caught"
)

# --- 2. Prepare data ---
df_enforcement <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- 3. Response status plot ---
df_status <- df_enforcement %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- 4. Distribution plot ---
df_long <- df_enforcement %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "value") %>%
  filter(!is.na(value)) %>%
  count(Category, value) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = names(columns)),
    value = factor(value, levels = as.character(0:10)),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")")
  )

p2 <- ggplot(df_long, aes(x = value, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.2) +
  facet_wrap(~ Category, ncol = 2, scales = "free_y") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2)), labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Distribution of Responses",
    x = "Estimated Count",
    y = NULL
  ) +
  theme_minimal() +
  theme(
    strip.text = element_text(size = 10, angle = 0, hjust = 0),
    axis.text.y = element_text(size = 8, margin = margin(r = 5))
  )

# --- 5. Combine ---
plot44 <- (p1 / p2) +
  plot_layout(heights = c(1, 3)) +
  plot_annotation(
    title = "Please respond to the following questions*",
    caption = paste(
      "* a) Out of 10 fishers in your community waters, how many would you guess use gear that is not permitted?\n",
      "  b) Out of 10 fishers in your community waters, how many would you guess fished in the reserve in the last month?\n",
      "  c) Out of 10 fishers in the managed access area, how many would you guess do not have permission to fish there?\n",
      "  d) Out of 10 fishers in the managed access area, how many would you guess violated the size regulations?\n",
      "  e) Out of 10 fishers in the managed access area, how many would you guess violated fishing rules?\n",
      "  f) Out of 10 fishers who fished in the reserve, how many would you guess got caught?"
    ),
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )



 

 
##############################################################



# #Who is responsible for enforcement in your community?
# unique(merged_hhs$g10_enforcement_responsible_community_surveilance) # Who is responsible for enforcement in your community? - Community Surveilance
# unique(merged_hhs$g10_enforcement_responsible_fmb) # Who is responsible for enforcement in your community? - Fisheries Management Body
# unique(merged_hhs$g10_enforcement_responsible_myself) # Who is responsible for enforcement in your community? - Myself
# unique(merged_hhs$g10_enforcement_responsible_na) # Who is responsible for enforcement in your community? - NA
# unique(merged_hhs$g10_enforcement_responsible_national) # Who is responsible for enforcement in your community? - National
# unique(merged_hhs$g10_enforcement_responsible_no_enforcement) # Who is responsible for enforcement in your community? - No Enforcement
# unique(merged_hhs$g10_enforcement_responsible_subnational) # Who is responsible for enforcement in your community? - Subnational
# unique(merged_hhs$g10_enforcement_responsible_other) # Who is responsible for enforcement in your community? - Other
# #unique(merged_hhs$g10_enforcement_responsible_other_specify) #Specify # Who is responsible for enforcement in your community? - Other (please specify)

# --- Define columns and labels ---
columns <- c(
  `Community Surveillance` = "g10_enforcement_responsible_community_surveilance",
  `Fisheries Management Body` = "g10_enforcement_responsible_fmb",
  `Myself` = "g10_enforcement_responsible_myself",
  `Not Applicable` = "g10_enforcement_responsible_na",
  `National Government` = "g10_enforcement_responsible_national",
  `No Enforcement` = "g10_enforcement_responsible_no_enforcement",
  `Subnational Government` = "g10_enforcement_responsible_subnational",
  `Other` = "g10_enforcement_responsible_other"
)

# --- Subset and rename ---
df_enforcement_resp <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- Top plot: Response status ---
df_status <- df_enforcement_resp %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Selected vs Not selected ---
df_long <- df_enforcement_resp %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "value") %>%
  filter(!is.na(value)) %>%
  mutate(response = if_else(value == "1", "Selected", "Not selected")) %>%
  count(Category, response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()

p2 <- ggplot(df_long, aes(x = Category, y = n, fill = response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = c("Selected" = "#6baed6", "Not selected" = "#fb6a4a")) +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion",
    fill = "Response"
  ) +
  coord_flip() +
  theme_minimal()

# --- Combine ---
plot45 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Who is responsible for enforcement in your community?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )




 

 
##############################################################



# # Do you or anyone in the household hold a leadership position in the fisheries management body?
# unique(merged_hhs$g10_fisheries_management_leader_no) # Do you or anyone in the household hold a leadership position in the fisheries management body? - No
# unique(merged_hhs$g10_fisheries_management_leader_no_mgmt) # Do you or anyone in the household hold a leadership position in the fisheries management body? - No Mgmt
# unique(merged_hhs$g10_fisheries_management_leader_yes_female) # Do you or anyone in the household hold a leadership position in the fisheries management body? - Yes Female
# unique(merged_hhs$g10_fisheries_management_leader_yes_male) # Do you or anyone in the household hold a leadership position in the fisheries management body? - Yes Male
# unique(merged_hhs$g10_fisheries_management_leader_yes_nonbinary) # Do you or anyone in the household hold a leadership position in the fisheries management body? - Yes Nonbinary


# --- Define columns and labels ---
columns <- c(
  `No` = "g10_fisheries_management_leader_no",
  `No Management Body` = "g10_fisheries_management_leader_no_mgmt",
  `Yes - Female` = "g10_fisheries_management_leader_yes_female",
  `Yes - Male` = "g10_fisheries_management_leader_yes_male",
  `Yes - Nonbinary` = "g10_fisheries_management_leader_yes_nonbinary"
)

# --- Subset and rename ---
df_leadership <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- Top plot: Response Status ---
df_status <- df_leadership %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Selected vs Not selected ---
df_long <- df_leadership %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "value") %>%
  filter(!is.na(value)) %>%
  mutate(response = if_else(value == "1", "Selected", "Not selected")) %>%
  count(Category, response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()

p2 <- ggplot(df_long, aes(x = Category, y = n, fill = response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = c("Selected" = "#6baed6", "Not selected" = "#fb6a4a")) +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion",
    fill = "Response"
  ) +
  coord_flip() +
  theme_minimal()

# --- Combine ---
plot46 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Do you or anyone in the household hold a leadership position in the fisheries management body?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )


 

 
##############################################################


# # Have you or anyone in the household attended a fisheries management body meeting in the last month?
# unique(merged_hhs$g10_fisheries_management_meeting_no) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - No
# unique(merged_hhs$g10_fisheries_management_meeting_no_meetings) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - No Meetings
# unique(merged_hhs$g10_fisheries_management_meeting_no_mgmt) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - No Mgmt
# unique(merged_hhs$g10_fisheries_management_meeting_yes_both_gender) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - Yes Both Gender
# unique(merged_hhs$g10_fisheries_management_meeting_yes_female) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - Yes Female
# unique(merged_hhs$g10_fisheries_management_meeting_yes_male) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - Yes Male
# unique(merged_hhs$g10_fisheries_management_meeting_yes_nonbinary) # Have you or anyone in the household attended a fisheries management body meeting in the last month? - Yes Nonbinary

# --- Define columns and labels ---
columns <- c(
  `No` = "g10_fisheries_management_meeting_no",
  `No Meetings Held` = "g10_fisheries_management_meeting_no_meetings",
  `No Management Body` = "g10_fisheries_management_meeting_no_mgmt",
  `Yes - Male` = "g10_fisheries_management_meeting_yes_male",
  `Yes - Female` = "g10_fisheries_management_meeting_yes_female",
  `Yes - Both Genders` = "g10_fisheries_management_meeting_yes_both_gender",
  `Yes - Nonbinary` = "g10_fisheries_management_meeting_yes_nonbinary"
)

# --- Subset and rename ---
df_meeting <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- Top plot: Response Status ---
df_status <- df_meeting %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Selected vs Not Selected ---
df_long <- df_meeting %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "value") %>%
  filter(!is.na(value)) %>%
  mutate(response = if_else(value == "1", "Selected", "Not selected")) %>%
  count(Category, response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()

p2 <- ggplot(df_long, aes(x = Category, y = n, fill = response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = c("Selected" = "#6baed6", "Not selected" = "#fb6a4a")) +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion",
    fill = "Response"
  ) +
  coord_flip() +
  theme_minimal()

# --- Combine ---
plot47 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Have you or anyone in the household attended a fisheries management body meeting in the last month?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )





 
##############################################################



#Do you think the fisheries management/managed access and reserve approach will benefit the community over the next five years?
# unique(merged_hhs$g10_ma_benefit_5yrs)

plot48 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_ma_benefit_5yrs,
  title = "Do you think the fisheries management/managed access and reserve approach will benefit the community over the next five years?",
  color_mapping = c(
    "Yes" = "#6baed6",
    "Unsure" = "#d9d9d9",
    "No" = "#fb6a4a",
    "Community does not have a fisheries management system" = "#bdbdbd"
    
  )
)




 
##############################################################



#How severe is the punishment when a person gets caught violating the fishing regulations in the fisheries management/managed access area?
# unique(merged_hhs$g10_ma_punishment)

plot48 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_ma_punishment,
  title = "How severe is the punishment when a person gets caught violating the fishing regulations in the fisheries management/managed access area?",
  color_mapping = c(
    "Extreme punishment" = "#6baed6",
    "Major punishment" = "#9ecae1",
    "Moderate punishment" = "#d9d9d9",
    "Minor punishment" = "#fcae91",
    "No punishment" = "#fb6a4a",
    "There are no regulations" = "#bdbdbd"
    
  )
)



 
##############################################################




#How strong do you feel that your opinions/ concerns are considered during management body decision-making processes?
# unique(merged_hhs$g10_opinions_considered)

plot49 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_opinions_considered,
  title = "How strong do you feel that your opinions/ concerns are considered during management body decision-making processes?",
  color_mapping = c(
    "Very strong" = "#6baed6",
    "Strong" = "#9ecae1",
    "Neither strong or low" = "#d9d9d9",
    "Low" = "#fcae91",
    "Very low" = "#fb6a4a",
    "No management body" = "#bdbdbd"
    
  )
)




 
##############################################################



#Do you agree that the fisheries management body represents your role in the fishery?
# unique(merged_hhs$g10_represent_role)

plot50 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_represent_role,
  title = "Do you agree that the fisheries management body represents your role in the fishery?",
  color_mapping = c(
    "Agree" = "#6baed6",
    "Neither agree nor disagree" = "#d9d9d9",
    "Disagree" = "#fb6a4a",
    "No management body" = "#bdbdbd"
    
  )
)


 
##############################################################




#How often do you share your interest/ opinions during management body meetings?
# unique(merged_hhs$g10_share_opinion)

plot51 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_share_opinion,
  title = "How often do you share your interest/ opinions during management body meetings?",
  color_mapping = c(
    "Always" = "#6baed6",
    "Regularly" = "#9ecae1",
    "Sometimes" = "#d9d9d9",
    "Rarely" = "#fcae91",
    "Never" = "#fb6a4a",
    "No management body meetings" = "#bdbdbd"
    
  )
)




 
##############################################################



# #Are fisheries management body meetings held at a time and place that are convenient for your household members?
# unique(merged_hhs$g10_time_place_female) # Are fisheries management body meetings held at a time and place that are convenient for your household members? - b) Women
# unique(merged_hhs$g10_time_place_male) # Are fisheries management body meetings held at a time and place that are convenient for your household members? - a) Male
# unique(merged_hhs$g10_time_place_nonbinary) # Are fisheries management body meetings held at a time and place that are convenient for your household members? - c) Non-binary

# --- Define columns and labels ---
columns <- c(
  `Male` = "g10_time_place_male",
  `Female` = "g10_time_place_female",
  `Non-binary` = "g10_time_place_nonbinary"
)

# --- Subset and rename ---
df_convenience <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- Top plot: Response Status ---
df_status <- df_convenience %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Yes / No (exclude missing) ---
df_long <- df_convenience %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(Response = factor(Response, levels = c("Yes", "No")))

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = c("Yes" = "#6baed6", "No" = "#fb6a4a")) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion",
    fill = "Response"
  ) +
  theme_minimal()

# --- Combine ---
plot52 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Are fisheries management meetings held at a convenient time and place for your household members?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )





 
##############################################################



#How much of the information provided in the management body meetings do you understand?
# unique(merged_hhs$g10_understand_info)

plot53 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g10_understand_info,
  title = "How much of the information provided in the management body meetings do you understand?",
  color_mapping = c(
    "Everything" = "#6baed6",
    "Most" = "#9ecae1",
    "Some" = "#d9d9d9",
    "A little" = "#fcae91",
    "None" = "#fb6a4a",
    "No management body meetings" = "#bdbdbd"
    
  )
)





 
##############################################################



#How do you rate the last year in terms of food availability?
# unique(merged_hhs$g11_food_availability)

plot54 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g11_food_availability,
  title = "How do you rate the last year in terms of food availability?",
  color_mapping = c(
    "Very good" = "#6baed6",
    "Good" = "#9ecae1",
    "OK" = "#d9d9d9",
    "Rather bad" = "#fcae91",
    "Very bad" = "#fb6a4a"
  )
)



 



 
##############################################################




#In the past year, how often did your family eat fish?
# unique(merged_hhs$g11_food_fish_consumption)


plot55 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g11_food_fish_consumption,
  title = "In the past year, how often did your family eat fish?",
  color_mapping = c(
    "More than a few times per week" = "#6baed6",
    "A few times per week" = "#9ecae1",
    "A few times" = "#d9d9d9",
    "A few times per month" = "#fcae91",
    "Once or never" = "#fb6a4a"
  )
)



 



 
##############################################################



#How much fish (kg) do you and your family eat/consume every day?
# unique(merged_hhs$g11_food_fish_eaten_weight)

# Convert to numeric
merged_hhs <- merged_hhs %>%
  mutate(
    g11_food_fish_eaten_weight = as.numeric(g11_food_fish_eaten_weight),
    response_status = if_else(is.na(g11_food_fish_eaten_weight), "Missing", "Answered")
  )

# --- Top plot: Response Status ---
df_status <- merged_hhs %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Average kg/day by year ---
df_avg <- merged_hhs %>%
  filter(!is.na(g11_food_fish_eaten_weight), !is.na(year)) %>%
  group_by(year) %>%
  summarise(avg_kg = mean(g11_food_fish_eaten_weight)) %>%
  ungroup()

p2 <- ggplot(df_avg, aes(x = factor(year), y = avg_kg)) +
  geom_col(fill = "#1f78b4", width = 0.6) +
  geom_text(aes(label = round(avg_kg, 1)), vjust = -0.2, size = 4) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Average Daily Household Fish Consumption by Year",
    x = "Year",
    y = "Average Consumption (kg/day)"
  ) +
  theme_minimal()

# --- Combine ---
plot56 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "How much fish (kg) do you and your family eat/consume every day?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )






 
##############################################################




#Are you confident that you will be able to procure enough food for you and your family for the next 12 months?
# unique(merged_hhs$g11_food_procurement)


plot57 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g11_food_procurement,
  title = "Are you confident that you will be able to procure enough food for you and your family for the next 12 months?",
  color_mapping = c(
    "Very confident to procure enough food" = "#6baed6",
    "Confident to procure enough food" = "#9ecae1",
    "Uncertain" = "#d9d9d9",
    "High chance of having shortage" = "#fcae91",
    "Certain to have shortage" = "#fb6a4a"
  )
)






 
##############################################################




#Consider the following statement: ”I worry about not having enough food for everyone in the household”. Was that often, sometimes or never true for you in the last 12 months?
# unique(merged_hhs$g11_food_worry)

plot58 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g11_food_worry,
  title = "Consider the following statement: ”I worry about not having enough food for everyone in the household”. Was that often, sometimes or never true for you in the last 12 months?",
  color_mapping = c(
    "Never" = "#6baed6",
    "Sometimes" = "#d9d9d9",
    "Often" = "#fb6a4a"
    
  )
)





 
##############################################################


# #Please state your level of agreement with the following statements
# unique(merged_hhs$g12_agreement_catch_recording) # Please state your level of agreement with the following statements: - b) Recording fish catches will help maintain or increase fish catches.
# unique(merged_hhs$g12_agreement_change_fishing_behavior) # Please state your level of agreement with the following statements: - i) I am willing to change my fishing behavior
# unique(merged_hhs$g12_agreement_community_participation) # Please state your level of agreement with the following statements: - c) Local community participation in management will help maintain or increase fish catches.
# unique(merged_hhs$g12_agreement_current_regulations) # Please state your level of agreement with the following statements: - a) Current fishing regulations are effective in ensuring that catches remain stable or improve.
# unique(merged_hhs$g12_agreement_help_neighbors) # Please state your level of agreement with the following statements: - g) It is important to me to be able to help my neighbors in times of need.
# unique(merged_hhs$g12_agreement_individual_behavior) # Please state your level of agreement with the following statements: - f) My behavior in terms of fishing can make a significant contribution to the sustainability of the catch.
# unique(merged_hhs$g12_agreement_regulations_fair) # Please state your level of agreement with the following statements: - h) In my opinion, the existing fisheries regulations are fair.
# unique(merged_hhs$g12_agreement_rights_distribution_fair) # Please state your level of agreement with the following statements: - e) The right to access/enter the area where fishing is permitted has been granted fairly to fishermen.
# unique(merged_hhs$g12_agreement_strong_enforcement) # Please state your level of agreement with the following statements: - d) It is important to have a strong monitoring system.


# Define columns and labels
columns <- c(
  `a) Regulations Effective` = "g12_agreement_current_regulations",
  `b) Record Catches` = "g12_agreement_catch_recording",
  `c) Participation Helps` = "g12_agreement_community_participation",
  `d) Monitoring Important` = "g12_agreement_strong_enforcement",
  `e) Access Fair` = "g12_agreement_rights_distribution_fair",
  `f) My Behavior Helps` = "g12_agreement_individual_behavior",
  `g) Help Neighbors` = "g12_agreement_help_neighbors",
  `h) Regulations Fair` = "g12_agreement_regulations_fair",
  `i) Willing to Change` = "g12_agreement_change_fishing_behavior"
)



# Color mapping
color_mapping <- c(
  "Strongly agree" = "#6baed6",
  "Agree" = "#9ecae1",
  "Neither agree nor disagree" = "#d9d9d9",
  "Disagree" = "#fcae91",
  "Strongly disagree" = "#fb6a4a"
)

# Prepare data
df_agree <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# Top plot: Answered vs Missing
df_status <- df_agree %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# Bottom plot: Distribution
df_long <- df_agree %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),
    Response = factor(Response, levels = names(color_mapping))
  )

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# Combine plots
plot59 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Please state your level of agreement with the following statements*",
    caption = "* a) Current fishing regulations are effective in ensuring that catches remain stable or improve.\n" %>%
              paste("b) Recording fish catches will help maintain or increase fish catches.\n") %>%
              paste("c) Local community participation in management will help maintain or increase fish catches.\n") %>%
              paste("d) It is important to have a strong monitoring system.\n") %>%
              paste("e) The right to access/enter the area where fishing is permitted has been granted fairly to fishermen.\n") %>%
              paste("f) My behavior in terms of fishing can make a significant contribution to the sustainability of the catch.\n") %>%
              paste("g) It is important to me to be able to help my neighbors in times of need.\n") %>%
              paste("h) In my opinion, the existing fisheries regulations are fair.\n") %>%
              paste("i) I am willing to change my fishing behavior."),
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )




 
##############################################################





#What do you think will happen if everyone complies with the reserve?
# unique(merged_hhs$g12_complies_reserve)

plot60 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g12_complies_reserve,
  title = "What do you think will happen if everyone complies with the reserve?",
  color_mapping = c(
    "Fishers’ catch will go up" = "#6baed6",
    "Fishers’ catch will stay the same" = "#d9d9d9",
    "Fishers’ catch will go down" = "#fb6a4a",
    "Don’t know" = "#bdbdbd"
  )
)







 
##############################################################



# #How wrong would it be to violate the following regulations?
# unique(merged_hhs$g12_how_wrong_gear) # How wrong would it be to violate the following regulations? - c) Gear restrictions
# unique(merged_hhs$g12_how_wrong_licensing) # How wrong would it be to violate the following regulations? - a) Registration/Licensing
# unique(merged_hhs$g12_how_wrong_managed_area_fishing) # How wrong would it be to violate the following regulations? - b) Only fishing in managed area with permission
# unique(merged_hhs$g12_how_wrong_min_fish_size) # How wrong would it be to violate the following regulations? - e) Minimum fish size requirements
# unique(merged_hhs$g12_how_wrong_reserve_fishing) # How wrong would it be to violate the following regulations? - d) Reserve fishing restrictions
# unique(merged_hhs$g12_how_wrong_other) # How wrong would it be to violate the following regulations? - f) Others
# #unique(merged_hhs$g12_how_wrong_other_specify) #Specify # How wrong would it be to violate the following regulations? - f) Other (please specify)

# --- 1. Define columns and labels ---
columns <- c(
  `a) Licensing` = "g12_how_wrong_licensing",
  `b) Only Fishing in Managed Areas` = "g12_how_wrong_managed_area_fishing",
  `c) Gear Restrictions` = "g12_how_wrong_gear",
  `d) Reserve Fishing Restrictions` = "g12_how_wrong_reserve_fishing",
  `e) Minimum Fish Size` = "g12_how_wrong_min_fish_size",
  `f) Other` = "g12_how_wrong_other"
)

# --- 2. Color mapping ---
color_mapping <- c(
  "Extremely wrong" = "#6baed6",
  "Very wrong" = "#9ecae1",
  "Moderately wrong" = "#d9d9d9",
  "Slightly wrong" = "#fcae91",
  "Not wrong at all" = "#fb6a4a"
)


# --- 3. Prepare data ---
df_wrong <- merged_hhs %>%
  select(all_of(columns)) %>%
  rename_with(~ names(columns), everything())

# --- 4. Top plot: Answered vs Missing ---
df_status <- df_wrong %>%
  mutate(response_status = if_else(rowSums(!is.na(.)) > 0, "Answered", "Missing")) %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- 5. Bottom plot: Distribution ---
df_long <- df_wrong %>%
  filter(rowSums(!is.na(.)) > 0) %>%
  pivot_longer(cols = everything(), names_to = "Category", values_to = "Response") %>%
  filter(!is.na(Response)) %>%
  count(Category, Response) %>%
  group_by(Category) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup() %>%
  mutate(
    Category = factor(Category, levels = rev(names(columns))),
    Response = factor(Response, levels = names(color_mapping))
  )

p2 <- ggplot(df_long, aes(x = Category, y = prop, fill = Response)) +
  geom_col(position = "fill", width = 0.7) +
  geom_text(aes(label = percent(prop, accuracy = 1)),
            position = position_fill(vjust = 0.5),
            color = "black", size = 3.5) +
  scale_fill_manual(values = color_mapping, drop = FALSE) +
  coord_flip() +
  labs(
    title = "Distribution of Responses",
    x = NULL,
    y = "Proportion"
  ) +
  theme_minimal()

# --- 6. Combine plots ---
plot61 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "How wrong would it be to violate the following regulations?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )






 
##############################################################


#Out of 10 fishers in your community, how many think the fisheries rules created by the management body are fair?
# unique(merged_hhs$g12_mgmt_rules_fair)

# --- Top plot: Missing vs Answered ---
df_response_status <- merged_hhs %>%
  mutate(response_status = if_else(is.na(g12_mgmt_rules_fair), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_response_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Distribution of answers ---
df_distribution <- merged_hhs %>%
  filter(!is.na(g12_mgmt_rules_fair)) %>%
  mutate(fair_guess = as.character(g12_mgmt_rules_fair)) %>%
  count(fair_guess) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    fair_guess = factor(fair_guess, levels = as.character(0:10))
  )

p2 <- ggplot(df_distribution, aes(x = fair_guess, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Guessed number of fishers (out of 10)",
    y = "Count"
  ) +
  theme_minimal()

# --- Combine plots ---
plot62 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Out of ten fishers in your community, how many think the fisheries rules created by the management body are fair?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )








 
##############################################################



#Out of ten members of your community, how many would you guess believe it is wrong to violate the rules?
# unique(merged_hhs$g12_no_wrong_fishing_reserve)

# --- Top plot: Missing vs Answered ---
df_response_status <- merged_hhs %>%
  mutate(response_status = if_else(is.na(g12_no_wrong_fishing_reserve), "Missing", "Answered")) %>%
  count(response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_response_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Distribution of answers ---
df_distribution <- merged_hhs %>%
  filter(!is.na(g12_no_wrong_fishing_reserve)) %>%
  mutate(wrong_guess = as.character(g12_no_wrong_fishing_reserve)) %>%
  count(wrong_guess) %>%
  mutate(
    prop = n / sum(n),
    label = paste0(n, "\n(", percent(prop, accuracy = 1), ")"),
    wrong_guess = factor(wrong_guess, levels = as.character(0:10))
  )

p2 <- ggplot(df_distribution, aes(x = wrong_guess, y = n)) +
  geom_col(fill = "#1f78b4", width = 0.7) +
  geom_text(aes(label = label), vjust = -0.3, size = 3.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(
    title = "Distribution of Responses",
    x = "Guessed number of community members (out of 10)",
    y = "Count"
  ) +
  theme_minimal()

# --- Combine plots ---
plot63 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "Out of ten members of your community, how many would you guess believe it is wrong to violate the rules?",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20))
    )
  )







 
##############################################################


#How do you judge the value of your catch compared to two years ago?
# unique(merged_hhs$g13_current_economic)

plot64 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g13_current_economic,
  title = "How do you judge the value of your catch compared to two years ago?",
  color_mapping = c(
    "Much better" = "#6baed6",
    "Slightly better" = "#9ecae1",
    "Neither better or worse" = "#d9d9d9",
    "Slightly worse" = "#fcae91",
    "Much worse" = "#fb6a4a"
  )
)



 
##############################################################



#Who makes the financial decisions in your household?
# unique(merged_hhs$g13_financial_decisions)

plot65 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g13_financial_decisions,
  title = "Who makes the financial decisions in your household?",
  color_mapping = c(
    "My male partner" = "#6baed6",
    "Both" = "#d9d9d9",
    "My female partner" = "#fb6a4a",
    "Myself" = "#74c476",
    "My non-binary partner" = "#9e9ac8"
  )
)





 
##############################################################


#In the last 6 months, how many fish do you eat per week in comparison with the number of fish that you sell per week? - # eaten per week
# unique(merged_hhs$g13_fish_eaten)

# Convert to numeric and remove outliers above 99th percentile
merged_hhs <- merged_hhs %>%
  mutate(
    g13_fish_eaten = as.numeric(g13_fish_eaten),
    response_status = if_else(is.na(g13_fish_eaten), "Missing", "Answered")
  )

threshold <- quantile(merged_hhs$g13_fish_eaten, 0.99, na.rm = TRUE)

# --- Top plot: Response Status ---
df_status <- merged_hhs %>%
  count(response_status) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status, aes(x = "", y = n, fill = response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Average fish eaten per week by year ---
df_avg <- merged_hhs %>%
  filter(!is.na(g13_fish_eaten), g13_fish_eaten <= threshold, !is.na(year)) %>%
  group_by(year) %>%
  summarise(avg_fish = mean(g13_fish_eaten)) %>%
  ungroup()

p2 <- ggplot(df_avg, aes(x = factor(year), y = avg_fish)) +
  geom_col(fill = "#1f78b4", width = 0.6) +
  geom_text(aes(label = round(avg_fish, 1)), vjust = -0.2, size = 4) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Average Weekly Household Fish Eaten",
    x = "Year",
    y = "Average Fish Eaten (per week)"
  ) +
  theme_minimal()

# --- Combine ---
plot66 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "In the last 6 months, how many fish do you eat per week in comparison with the number of fish that you sell per week?",
    caption = "Note: Outliers (top 1% of responses) have been removed from the analysis.",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )




 
##############################################################



#In the last 6 months, how many fish do you eat per week in comparison with the number of fish that you sell per week? - # sold per week
# unique(merged_hhs$g13_fish_sold)

# Convert to numeric and tag response status
merged_hhs <- merged_hhs %>%
  mutate(
    g13_fish_sold = as.numeric(g13_fish_sold),
    response_status_sold = if_else(is.na(g13_fish_sold), "Missing", "Answered")
  )

# Calculate 99th percentile threshold to remove outliers
threshold_sold <- quantile(merged_hhs$g13_fish_sold, 0.99, na.rm = TRUE)

# --- Top plot: Response Status ---
df_status_sold <- merged_hhs %>%
  count(response_status_sold) %>%
  mutate(prop = n / sum(n))

p1 <- ggplot(df_status_sold, aes(x = "", y = n, fill = response_status_sold)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(prop, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: Average fish sold per week by year ---
df_avg_sold <- merged_hhs %>%
  filter(!is.na(g13_fish_sold), g13_fish_sold <= threshold_sold, !is.na(year)) %>%
  group_by(year) %>%
  summarise(avg_fish_sold = mean(g13_fish_sold)) %>%
  ungroup()

p2 <- ggplot(df_avg_sold, aes(x = factor(year), y = avg_fish_sold)) +
  geom_col(fill = "#1f78b4", width = 0.6) +
  geom_text(aes(label = round(avg_fish_sold, 1)), vjust = -0.2, size = 4) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Average Weekly Household Fish Sold",
    x = "Year",
    y = "Average Fish Sold (per week)"
  ) +
  theme_minimal()

# --- Combine ---
plot67 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "In the last 6 months, how many fish do you eat per week in comparison with the number of fish that you sell per week? — Fish Sold",
    caption = "Note: Outliers (top 1% of responses) have been removed from the analysis.",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 8, hjust = 0, margin = margin(t = 10))
    )
  )




 
##############################################################



#In the past month, about how much did you and your household spend on fishing costs?
# unique(merged_hhs$g13_fishing_costs)

# --- Convert to numeric and classify ---
merged_hhs <- merged_hhs %>%
  mutate(
    g13_fishing_costs_num = as.numeric(g13_fishing_costs),
    fishing_costs_response_status = case_when(
      is.na(g13_fishing_costs_num) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Remove top 1% globally as outliers ---
cost_threshold <- quantile(merged_hhs$g13_fishing_costs_num, 0.99, na.rm = TRUE)

# --- Top plot: Response status ---
df_top <- merged_hhs %>%
  count(fishing_costs_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = fishing_costs_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Prepare data: remove outliers, compute median + IQR ---
cost_summary <- merged_hhs %>%
  filter(!is.na(g13_fishing_costs_num),
         g13_fishing_costs_num <= cost_threshold,
         !is.na(year), !is.na(g1_country)) %>%
  group_by(g1_country, year) %>%
  summarise(
    median_cost = median(g13_fishing_costs_num, na.rm = TRUE),
    iqr_lower = quantile(g13_fishing_costs_num, 0.25, na.rm = TRUE),
    iqr_upper = quantile(g13_fishing_costs_num, 0.75, na.rm = TRUE),
    .groups = "drop"
  )

# --- Bottom plot: median + IQR ---
p2 <- ggplot(cost_summary, aes(x = factor(year), y = median_cost, group = g1_country)) +
  geom_line(color = "#6baed6", size = 1) +
  geom_point(color = "black", size = 2) +
  geom_errorbar(aes(ymin = pmax(iqr_lower, 0), ymax = iqr_upper),
                width = 0.2, color = "black") +
  facet_wrap(~ g1_country, scales = "free_y") +
  labs(
    title = "Trend of Median Monthly Fishing Costs by Year and Country (with IQR)",
    x = "Year",
    y = "Median Monthly Cost (local currency)"
  ) +
  scale_y_continuous(labels = scales::label_comma()) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Combine plots ---
plot68 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "In the past month, about how much did you and your household spend on fishing costs?",
    caption = "Note: Top 1% of responses removed as outliers. Bottom plot shows median monthly fishing cost per year with IQR (25th–75th percentile).",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )



 
##############################################################



#How do you expect the value of your catch to develop in the next two years?       
# unique(merged_hhs$g13_future_economic)

plot69 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g13_future_economic,
  title = "How do you expect the value of your catch to develop in the next two years?",
  color_mapping = c(
    "Much better" = "#6baed6",
    "Slightly better" = "#9ecae1",
    "Neither better or worse" = "#d9d9d9",
    "Slightly worse" = "#fcae91",
    "Much worse" = "#fb6a4a"
  )
)



 
##############################################################



#What is your household’s average monthly income from all activities, including salaried and non-salaried labor?
# unique(merged_hhs$g13_hh_average_income)


# --- Convert and classify ---
merged_hhs <- merged_hhs %>%
  mutate(
    g13_hh_average_income_num = as.numeric(g13_hh_average_income),
    income_response_status = case_when(
      is.na(g13_hh_average_income_num) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Remove top 1% as global outliers ---
income_threshold <- quantile(merged_hhs$g13_hh_average_income_num, 0.99, na.rm = TRUE)

# --- Top plot: Response status ---
df_top <- merged_hhs %>%
  count(income_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = income_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Compute median and IQR ---
income_summary <- merged_hhs %>%
  filter(!is.na(g13_hh_average_income_num),
         g13_hh_average_income_num <= income_threshold,
         !is.na(year), !is.na(g1_country)) %>%
  group_by(g1_country, year) %>%
  summarise(
    median_income = median(g13_hh_average_income_num, na.rm = TRUE),
    iqr_lower = quantile(g13_hh_average_income_num, 0.25, na.rm = TRUE),
    iqr_upper = quantile(g13_hh_average_income_num, 0.75, na.rm = TRUE),
    .groups = "drop"
  )

# --- Bottom plot: Line of median + IQR error bars ---
p2_iqr <- ggplot(income_summary, aes(x = factor(year), y = median_income, group = g1_country)) +
  geom_line(color = "#6baed6", size = 1) +
  geom_point(color = "black", size = 2) +
  geom_errorbar(
    aes(
      ymin = pmax(iqr_lower, 0),
      ymax = iqr_upper
    ),
    width = 0.2,
    color = "black"
  ) +
  facet_wrap(~ g1_country, scales = "free_y") +
  labs(
    title = "Trend of Median Monthly Household Income by Country (with IQR)",
    x = "Year",
    y = "Median Income (local currency)"
  ) +
  scale_y_continuous(labels = comma_format(scale = 1)) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Combine both plots ---
plot70 <- (p1 / p2_iqr) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "What is your household’s average monthly income from all activities?",
    caption = "Note: Top 1% of responses removed globally as outliers. Bottom plot shows median income with IQR (25th–75th percentile).",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )




 
##############################################################


#Thinking of your household’s total income, is your household able to cover your household's needs…?
# unique(merged_hhs$g13_hh_ends_meet)

plot71 <- plot_response_distribution(
  data = merged_hhs,
  question_col = g13_hh_ends_meet,
  title = "Thinking of your household’s total income, is your household able to cover your household's needs…?",
  color_mapping = c(
    "Very easy" = "#6baed6",
    "Easy" = "#9ecae1",
    "Fairly easy" = "#d9d9d9",
    "With difficulty" = "#fcae91",
    "With great difficulty" = "#fb6a4a"
  )
)






 
##############################################################

#In the past month, about how much did you and your household spend on housing costs such as rent and electricity etc.?
# unique(merged_hhs$g13_housing_costs)

# --- Convert and classify ---
merged_hhs <- merged_hhs %>%
  mutate(
    g13_housing_costs_num = as.numeric(g13_housing_costs),
    housing_response_status = case_when(
      is.na(g13_housing_costs_num) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Remove top 1% as global outliers ---
housing_threshold <- quantile(merged_hhs$g13_housing_costs_num, 0.99, na.rm = TRUE)

# --- Top plot: Response status ---
df_top <- merged_hhs %>%
  count(housing_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = housing_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Prepare data: remove outliers, compute median + IQR ---
housing_summary <- merged_hhs %>%
  filter(!is.na(g13_housing_costs_num),
         g13_housing_costs_num <= housing_threshold,
         !is.na(year), !is.na(g1_country)) %>%
  group_by(g1_country, year) %>%
  summarise(
    median_cost = median(g13_housing_costs_num, na.rm = TRUE),
    iqr_lower = quantile(g13_housing_costs_num, 0.25, na.rm = TRUE),
    iqr_upper = quantile(g13_housing_costs_num, 0.75, na.rm = TRUE),
    .groups = "drop"
  )

# --- Bottom plot: Median + IQR ---
p2 <- ggplot(housing_summary, aes(x = factor(year), y = median_cost, group = g1_country)) +
  geom_line(color = "#6baed6", size = 1) +
  geom_point(color = "black", size = 2) +
  geom_errorbar(
    aes(ymin = pmax(iqr_lower, 0), ymax = iqr_upper),
    width = 0.2,
    color = "black"
  ) +
  facet_wrap(~ g1_country, scales = "free_y") +
  labs(
    title = "Trend of Median Monthly Housing Costs by Year and Country (with IQR)",
    x = "Year",
    y = "Median Monthly Cost (local currency)"
  ) +
  scale_y_continuous(labels = comma_format(scale = 1)) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Combine plots ---
plot72 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "In the past month, about how much did you and your household spend on housing costs?",
    caption = "Note: Top 1% of responses removed as outliers. Bottom plot shows median housing cost per year with IQR (25th–75th percentile).",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )




 
##############################################################


#In the past month, about how much did you and your household spend on luxury goods and services?
# unique(merged_hhs$g13_luxury_goods)

# --- Convert and classify ---
merged_hhs <- merged_hhs %>%
  mutate(
    g13_luxury_goods_num = as.numeric(g13_luxury_goods),
    luxury_response_status = case_when(
      is.na(g13_luxury_goods_num) ~ "Missing",
      TRUE ~ "Answered"
    )
  )

# --- Remove top 1% as global outliers ---
luxury_threshold <- quantile(merged_hhs$g13_luxury_goods_num, 0.99, na.rm = TRUE)

# --- Top plot: Response status ---
df_top <- merged_hhs %>%
  count(luxury_response_status) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(df_top, aes(x = "", y = n, fill = luxury_response_status)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Prepare data: remove outliers, compute median + IQR ---
luxury_summary <- merged_hhs %>%
  filter(!is.na(g13_luxury_goods_num),
         g13_luxury_goods_num <= luxury_threshold,
         !is.na(year), !is.na(g1_country)) %>%
  group_by(g1_country, year) %>%
  summarise(
    median_luxury = median(g13_luxury_goods_num, na.rm = TRUE),
    iqr_lower = quantile(g13_luxury_goods_num, 0.25, na.rm = TRUE),
    iqr_upper = quantile(g13_luxury_goods_num, 0.75, na.rm = TRUE),
    .groups = "drop"
  )

# --- Bottom plot: Median + IQR ---
p2 <- ggplot(luxury_summary, aes(x = factor(year), y = median_luxury, group = g1_country)) +
  geom_line(color = "#6baed6", size = 1) +
  geom_point(color = "black", size = 2) +
  geom_errorbar(
    aes(ymin = pmax(iqr_lower, 0), ymax = iqr_upper),
    width = 0.2,
    color = "black"
  ) +
  facet_wrap(~ g1_country, scales = "free_y") +
  labs(
    title = "Trend of Median Monthly Spending on Luxury Goods and Services by Year and Country (with IQR)",
    x = "Year",
    y = "Median Spending (local currency)"
  ) +
  scale_y_continuous(labels = comma_format(scale = 1)) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Combine plots ---
plot73 <- (p1 / p2) +
  plot_layout(heights = c(1, 2)) +
  plot_annotation(
    title = "In the past month, about how much did you and your household spend on luxury goods and services?",
    caption = "Note: Top 1% of responses removed as outliers. Bottom plot shows median monthly spending with IQR (25th–75th percentile).",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )




 
##############################################################




# 
# #Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale?
# unique(merged_hhs$g13_post_hours_man)# Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale? - Hours per day (Male)
# unique(merged_hhs$g13_post_hours_nonbinary)# Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale? - Hours per day (Non-binary)
# unique(merged_hhs$g13_post_hours_woman)# Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale? - Hours per day (Female)
# 
# 
# 
# 
# unique(merged_hhs$g13_post_income_man) # Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale? - Total income (Rp.../day) earned (Male)
# unique(merged_hhs$g13_post_income_nonbinary) # Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale? - Total income received (Non-binary)
# unique(merged_hhs$g13_post_income_woman) # Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale? - Total income (Rp.../day) earned (Female)


# --- Convert and reshape income ---
long_income <- merged_hhs %>%
  mutate(
    man = as.numeric(g13_post_income_man),
    woman = as.numeric(g13_post_income_woman),
    nb = as.numeric(g13_post_income_nonbinary)
  ) %>%
  select(g1_country, year, man, woman, nb) %>%
  pivot_longer(cols = c(man, woman, nb),
               names_to = "gender",
               values_to = "income") %>%
  mutate(gender = recode(gender,
                         "man" = "Male",
                         "woman" = "Female",
                         "nb" = "Non-binary"))

# --- Remove top 1% per gender ---
income_clean <- long_income %>%
  group_by(gender) %>%
  mutate(threshold = quantile(income, 0.99, na.rm = TRUE)) %>%
  ungroup() %>%
  filter(!is.na(income), income <= threshold)

# --- Top plot: response status based on ALL 6 post-harvest fields ---
resp_status_all <- merged_hhs %>%
  mutate(
    all_missing = if_else(
      is.na(g13_post_income_man) & 
      is.na(g13_post_income_woman) & 
      is.na(g13_post_income_nonbinary) &
      is.na(g13_post_hours_man) & 
      is.na(g13_post_hours_woman) & 
      is.na(g13_post_hours_nonbinary),
      "Missing", "Answered"
    )
  ) %>%
  count(all_missing) %>%
  mutate(p = n / sum(n))

p1 <- ggplot(resp_status_all, aes(x = "", y = n, fill = all_missing)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(n, " (", percent(p, accuracy = 1), ")")),
            position = position_stack(vjust = 0.5), size = 4.5) +
  scale_fill_manual(values = c("Answered" = "#1f78b4", "Missing" = "#d9d9d9")) +
  coord_flip() +
  labs(
    title = "Response Status",
    x = NULL,
    y = "Count",
    fill = NULL
  ) +
  theme_minimal()

# --- Bottom plot: average income by year, country, gender ---
p2 <- income_clean %>%
  group_by(g1_country, year, gender) %>%
  summarise(avg_income = mean(income, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = factor(year), y = avg_income, fill = gender)) +
  geom_col(position = position_dodge(width = 0.8), width = 0.7) +
  facet_wrap(~ g1_country, scales = "free_y") +
  scale_fill_manual(values = c(
    "Male" = "#6baed6",
    "Female" = "#fb6a4a",
    "Non-binary" = "#74c476"
  )) +
  labs(
    title = "Average Daily Income from Fish Processing by Year, Country, and Gender",
    x = "Year",
    y = "Average Income (local currency)",
    fill = "Gender"
  ) +
  scale_y_continuous(labels = scales::comma_format(scale = 1)) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Prepare and reshape hours for all genders ---
hours_long <- merged_hhs %>%
  transmute(
    g1_country,
    year,
    male = as.numeric(g13_post_hours_man),
    female = as.numeric(g13_post_hours_woman),
    nonbinary = as.numeric(g13_post_hours_nonbinary)
  ) %>%
  pivot_longer(cols = c(male, female, nonbinary), 
               names_to = "gender", 
               values_to = "hours") %>%
  filter(!is.na(hours), !is.na(year), !is.na(g1_country)) %>%
  mutate(gender = recode(gender,
                         "male" = "Male",
                         "female" = "Female",
                         "nonbinary" = "Non-binary"))

# --- Aggregate average hours ---
avg_hours <- hours_long %>%
  group_by(g1_country, year, gender) %>%
  summarise(avg_hours = mean(hours, na.rm = TRUE), .groups = "drop")

# --- Middle plot: average hours ---
p3 <- ggplot(avg_hours, aes(x = factor(year), y = avg_hours, fill = gender)) +
  geom_col(position = "dodge") +
  facet_wrap(~ g1_country, scales = "free_y") +
  labs(
    title = "Average Daily Hours Spent on Fish Processing by Year, Country, and Gender",
    x = "Year",
    y = "Average Hours",
    fill = "Gender"
  ) +
  scale_fill_manual(values = c("Male" = "#6baed6",
                               "Female" = "#fb6a4a",
                               "Non-binary" = "#74c476")) +
  scale_y_continuous(
  breaks = scales::pretty_breaks(n = 4),
  labels = scales::comma_format()
) +
  theme_minimal() +
  theme(
    strip.text = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

# --- Combine plots ---
plot74 <- (p1 / p3 / p2) +
  plot_layout(heights = c(1, 4, 4)) +
  plot_annotation(
    title = "Over the past month, what is the average time spent (hours per day) and income earned on cleaning and processing activities to prepare the fish for sale?",
    caption = "Note: Top 1% of income responses removed as outliers.",
    theme = theme(
      plot.title = element_text(face = "bold.italic", hjust = 0.5, margin = margin(b = 20)),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )
```



```{r display-plots, fig.width=16, fig.height=9, dpi=300, results='asis'}
for (i in 1:74) {
  plot_obj <- get(paste0("plot", i))
  print(plot_obj)
}

```



```{r}
# Open a PDF device to write all plots into one file
pdf("all_plots.pdf", width = 16, height = 9)  # You can adjust size if needed

# Loop through your plots (plot1 to plot74)
for (i in 1:74) {
  plot_obj <- get(paste0("plot", i))
  print(plot_obj)
}

# Close the PDF device to finalize the file
dev.off()
```








